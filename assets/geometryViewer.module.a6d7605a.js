import{R as Ne}from"./app.28a7effe.js";function Ic(t){if(Array.isArray(t))return t}function Qc(t,e){var r=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n=[],a=!0,i=!1,s,f;try{for(r=r.call(t);!(a=(s=r.next()).done)&&(n.push(s.value),!(e&&n.length===e));a=!0);}catch(o){i=!0,f=o}finally{try{!a&&r.return!=null&&r.return()}finally{if(i)throw f}}return n}}function Ca(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Do(t,e){if(!!t){if(typeof t=="string")return Ca(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ca(t,e)}}function qc(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ye(t,e){return Ic(t)||Qc(t,e)||Do(t,e)||qc()}function mt(t){return mt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mt(t)}function K(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Zc(t){if(Array.isArray(t))return Ca(t)}function Jc(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function eg(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function re(t){return Zc(t)||Jc(t)||Do(t)||eg()}function wr(t,e){return wr=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},wr(t,e)}function tg(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Tr(t,e,r){return tg()?Tr=Reflect.construct:Tr=function(a,i,s){var f=[null];f.push.apply(f,i);var o=Function.bind.apply(a,f),u=new o;return s&&wr(u,s.prototype),u},Tr.apply(null,arguments)}var rg=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var n,a,i;if(Array.isArray(e)){if(n=e.length,n!=r.length)return!1;for(a=n;a--!==0;)if(!t(e[a],r[a]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(i=Object.keys(e),n=i.length,n!==Object.keys(r).length)return!1;for(a=n;a--!==0;)if(!Object.prototype.hasOwnProperty.call(r,i[a]))return!1;for(a=n;a--!==0;){var s=i[a];if(!t(e[s],r[s]))return!1}return!0}return e!==e&&r!==r},bi=Object.prototype.toString,bo=function(e){var r=bi.call(e),n=r==="[object Arguments]";return n||(n=r!=="[object Array]"&&e!==null&&typeof e=="object"&&typeof e.length=="number"&&e.length>=0&&bi.call(e.callee)==="[object Function]"),n},Lo;if(!Object.keys){var Hr=Object.prototype.hasOwnProperty,Li=Object.prototype.toString,ng=bo,Ri=Object.prototype.propertyIsEnumerable,ag=!Ri.call({toString:null},"toString"),ig=Ri.call(function(){},"prototype"),Pr=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],Xn=function(t){var e=t.constructor;return e&&e.prototype===t},sg={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},og=function(){if(typeof window=="undefined")return!1;for(var t in window)try{if(!sg["$"+t]&&Hr.call(window,t)&&window[t]!==null&&typeof window[t]=="object")try{Xn(window[t])}catch{return!0}}catch{return!0}return!1}(),fg=function(t){if(typeof window=="undefined"||!og)return Xn(t);try{return Xn(t)}catch{return!1}};Lo=function(e){var r=e!==null&&typeof e=="object",n=Li.call(e)==="[object Function]",a=ng(e),i=r&&Li.call(e)==="[object String]",s=[];if(!r&&!n&&!a)throw new TypeError("Object.keys called on a non-object");var f=ig&&n;if(i&&e.length>0&&!Hr.call(e,0))for(var o=0;o<e.length;++o)s.push(String(o));if(a&&e.length>0)for(var u=0;u<e.length;++u)s.push(String(u));else for(var c in e)!(f&&c==="prototype")&&Hr.call(e,c)&&s.push(String(c));if(ag)for(var g=fg(e),v=0;v<Pr.length;++v)!(g&&Pr[v]==="constructor")&&Hr.call(e,Pr[v])&&s.push(Pr[v]);return s}}var ug=Lo,cg=Array.prototype.slice,gg=bo,Vi=Object.keys,pn=Vi?function(e){return Vi(e)}:ug,ki=Object.keys;pn.shim=function(){if(Object.keys){var e=function(){var r=Object.keys(arguments);return r&&r.length===arguments.length}(1,2);e||(Object.keys=function(n){return gg(n)?ki(cg.call(n)):ki(n)})}else Object.keys=pn;return Object.keys||pn};var vg=pn,pg=Error,lg=EvalError,hg=RangeError,yg=ReferenceError,Ro=SyntaxError,Vo=TypeError,Tg=URIError,xg=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},r=Symbol("test"),n=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var a=42;e[r]=a;for(r in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var i=Object.getOwnPropertySymbols(e);if(i.length!==1||i[0]!==r||!Object.prototype.propertyIsEnumerable.call(e,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var s=Object.getOwnPropertyDescriptor(e,r);if(s.value!==a||s.enumerable!==!0)return!1}return!0},Bi=typeof Symbol!="undefined"&&Symbol,dg=xg,Og=function(){return typeof Bi!="function"||typeof Symbol!="function"||typeof Bi("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:dg()},Yn={__proto__:null,foo:{}},Sg=Object,Cg=function(){return{__proto__:Yn}.foo===Yn.foo&&!(Yn instanceof Sg)},wg="Function.prototype.bind called on incompatible ",Eg=Object.prototype.toString,Mg=Math.max,Dg="[object Function]",Ui=function(e,r){for(var n=[],a=0;a<e.length;a+=1)n[a]=e[a];for(var i=0;i<r.length;i+=1)n[i+e.length]=r[i];return n},bg=function(e,r){for(var n=[],a=r||0,i=0;a<e.length;a+=1,i+=1)n[i]=e[a];return n},Lg=function(t,e){for(var r="",n=0;n<t.length;n+=1)r+=t[n],n+1<t.length&&(r+=e);return r},Rg=function(e){var r=this;if(typeof r!="function"||Eg.apply(r)!==Dg)throw new TypeError(wg+r);for(var n=bg(arguments,1),a,i=function(){if(this instanceof a){var c=r.apply(this,Ui(n,arguments));return Object(c)===c?c:this}return r.apply(e,Ui(n,arguments))},s=Mg(0,r.length-n.length),f=[],o=0;o<s;o++)f[o]="$"+o;if(a=Function("binder","return function ("+Lg(f,",")+"){ return binder.apply(this,arguments); }")(i),r.prototype){var u=function(){};u.prototype=r.prototype,a.prototype=new u,u.prototype=null}return a},Vg=Rg,ko=Function.prototype.bind||Vg,kg=Function.prototype.call,Bg=Object.prototype.hasOwnProperty,Ug=ko,Ng=Ug.call(kg,Bg),W,Fg=pg,mg=lg,Gg=hg,_g=yg,er=Ro,Zt=Vo,Ag=Tg,Bo=Function,In=function(t){try{return Bo('"use strict"; return ('+t+").constructor;")()}catch{}},Ut=Object.getOwnPropertyDescriptor;if(Ut)try{Ut({},"")}catch{Ut=null}var Qn=function(){throw new Zt},$g=Ut?function(){try{return arguments.callee,Qn}catch{try{return Ut(arguments,"callee").get}catch{return Qn}}}():Qn,zt=Og(),Wg=Cg(),le=Object.getPrototypeOf||(Wg?function(t){return t.__proto__}:null),Xt={},zg=typeof Uint8Array=="undefined"||!le?W:le(Uint8Array),Nt={__proto__:null,"%AggregateError%":typeof AggregateError=="undefined"?W:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer=="undefined"?W:ArrayBuffer,"%ArrayIteratorPrototype%":zt&&le?le([][Symbol.iterator]()):W,"%AsyncFromSyncIteratorPrototype%":W,"%AsyncFunction%":Xt,"%AsyncGenerator%":Xt,"%AsyncGeneratorFunction%":Xt,"%AsyncIteratorPrototype%":Xt,"%Atomics%":typeof Atomics=="undefined"?W:Atomics,"%BigInt%":typeof BigInt=="undefined"?W:BigInt,"%BigInt64Array%":typeof BigInt64Array=="undefined"?W:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array=="undefined"?W:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView=="undefined"?W:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Fg,"%eval%":eval,"%EvalError%":mg,"%Float32Array%":typeof Float32Array=="undefined"?W:Float32Array,"%Float64Array%":typeof Float64Array=="undefined"?W:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry=="undefined"?W:FinalizationRegistry,"%Function%":Bo,"%GeneratorFunction%":Xt,"%Int8Array%":typeof Int8Array=="undefined"?W:Int8Array,"%Int16Array%":typeof Int16Array=="undefined"?W:Int16Array,"%Int32Array%":typeof Int32Array=="undefined"?W:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":zt&&le?le(le([][Symbol.iterator]())):W,"%JSON%":typeof JSON=="object"?JSON:W,"%Map%":typeof Map=="undefined"?W:Map,"%MapIteratorPrototype%":typeof Map=="undefined"||!zt||!le?W:le(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise=="undefined"?W:Promise,"%Proxy%":typeof Proxy=="undefined"?W:Proxy,"%RangeError%":Gg,"%ReferenceError%":_g,"%Reflect%":typeof Reflect=="undefined"?W:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set=="undefined"?W:Set,"%SetIteratorPrototype%":typeof Set=="undefined"||!zt||!le?W:le(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer=="undefined"?W:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":zt&&le?le(""[Symbol.iterator]()):W,"%Symbol%":zt?Symbol:W,"%SyntaxError%":er,"%ThrowTypeError%":$g,"%TypedArray%":zg,"%TypeError%":Zt,"%Uint8Array%":typeof Uint8Array=="undefined"?W:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray=="undefined"?W:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array=="undefined"?W:Uint16Array,"%Uint32Array%":typeof Uint32Array=="undefined"?W:Uint32Array,"%URIError%":Ag,"%WeakMap%":typeof WeakMap=="undefined"?W:WeakMap,"%WeakRef%":typeof WeakRef=="undefined"?W:WeakRef,"%WeakSet%":typeof WeakSet=="undefined"?W:WeakSet};if(le)try{null.error}catch(t){var jg=le(le(t));Nt["%Error.prototype%"]=jg}var Hg=function t(e){var r;if(e==="%AsyncFunction%")r=In("async function () {}");else if(e==="%GeneratorFunction%")r=In("function* () {}");else if(e==="%AsyncGeneratorFunction%")r=In("async function* () {}");else if(e==="%AsyncGenerator%"){var n=t("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if(e==="%AsyncIteratorPrototype%"){var a=t("%AsyncGenerator%");a&&le&&(r=le(a.prototype))}return Nt[e]=r,r},Ni={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},kr=ko,Sn=Ng,Pg=kr.call(Function.call,Array.prototype.concat),Kg=kr.call(Function.apply,Array.prototype.splice),Fi=kr.call(Function.call,String.prototype.replace),Cn=kr.call(Function.call,String.prototype.slice),Xg=kr.call(Function.call,RegExp.prototype.exec),Yg=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,Ig=/\\(\\)?/g,Qg=function(e){var r=Cn(e,0,1),n=Cn(e,-1);if(r==="%"&&n!=="%")throw new er("invalid intrinsic syntax, expected closing `%`");if(n==="%"&&r!=="%")throw new er("invalid intrinsic syntax, expected opening `%`");var a=[];return Fi(e,Yg,function(i,s,f,o){a[a.length]=f?Fi(o,Ig,"$1"):s||i}),a},qg=function(e,r){var n=e,a;if(Sn(Ni,n)&&(a=Ni[n],n="%"+a[0]+"%"),Sn(Nt,n)){var i=Nt[n];if(i===Xt&&(i=Hg(n)),typeof i=="undefined"&&!r)throw new Zt("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:a,name:n,value:i}}throw new er("intrinsic "+e+" does not exist!")},Uo=function(e,r){if(typeof e!="string"||e.length===0)throw new Zt("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof r!="boolean")throw new Zt('"allowMissing" argument must be a boolean');if(Xg(/^%?[^%]*%?$/,e)===null)throw new er("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=Qg(e),a=n.length>0?n[0]:"",i=qg("%"+a+"%",r),s=i.name,f=i.value,o=!1,u=i.alias;u&&(a=u[0],Kg(n,Pg([0,1],u)));for(var c=1,g=!0;c<n.length;c+=1){var v=n[c],p=Cn(v,0,1),l=Cn(v,-1);if((p==='"'||p==="'"||p==="`"||l==='"'||l==="'"||l==="`")&&p!==l)throw new er("property names with quotes must have matching quotes");if((v==="constructor"||!g)&&(o=!0),a+="."+v,s="%"+a+"%",Sn(Nt,s))f=Nt[s];else if(f!=null){if(!(v in f)){if(!r)throw new Zt("base intrinsic for "+e+" exists, but the property is not available.");return}if(Ut&&c+1>=n.length){var y=Ut(f,v);g=!!y,g&&"get"in y&&!("originalValue"in y.get)?f=y.get:f=f[v]}else g=Sn(f,v),f=f[v];g&&!o&&(Nt[s]=f)}}return f},Zg=Uo,ln=Zg("%Object.defineProperty%",!0)||!1;if(ln)try{ln({},"a",{value:1})}catch{ln=!1}var No=ln,Jg=Uo,hn=Jg("%Object.getOwnPropertyDescriptor%",!0);if(hn)try{hn([],"length")}catch{hn=null}var ev=hn,mi=No,tv=Ro,jt=Vo,Gi=ev,rv=function(e,r,n){if(!e||typeof e!="object"&&typeof e!="function")throw new jt("`obj` must be an object or a function`");if(typeof r!="string"&&typeof r!="symbol")throw new jt("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new jt("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new jt("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new jt("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new jt("`loose`, if provided, must be a boolean");var a=arguments.length>3?arguments[3]:null,i=arguments.length>4?arguments[4]:null,s=arguments.length>5?arguments[5]:null,f=arguments.length>6?arguments[6]:!1,o=!!Gi&&Gi(e,r);if(mi)mi(e,r,{configurable:s===null&&o?o.configurable:!s,enumerable:a===null&&o?o.enumerable:!a,value:n,writable:i===null&&o?o.writable:!i});else if(f||!a&&!i&&!s)e[r]=n;else throw new tv("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},wa=No,Fo=function(){return!!wa};Fo.hasArrayLengthDefineBug=function(){if(!wa)return null;try{return wa([],"length",{value:1}).length!==1}catch{return!0}};var nv=Fo,av=vg,iv=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",sv=Object.prototype.toString,ov=Array.prototype.concat,_i=rv,fv=function(t){return typeof t=="function"&&sv.call(t)==="[object Function]"},mo=nv(),uv=function(t,e,r,n){if(e in t){if(n===!0){if(t[e]===r)return}else if(!fv(n)||!n())return}mo?_i(t,e,r,!0):_i(t,e,r)},Go=function(t,e){var r=arguments.length>2?arguments[2]:{},n=av(e);iv&&(n=ov.call(n,Object.getOwnPropertySymbols(e)));for(var a=0;a<n.length;a+=1)uv(t,n[a],e[n[a]],r[n[a]])};Go.supportsDescriptors=!!mo;var _o=Go,xr={exports:{}};typeof self!="undefined"?xr.exports=self:typeof window!="undefined"?xr.exports=window:xr.exports=Function("return this")();var cv=xr.exports,Ao=function(){return typeof Ne!="object"||!Ne||Ne.Math!==Math||Ne.Array!==Array?cv:Ne},gv=_o,vv=Ao,pv=function(){var e=vv();if(gv.supportsDescriptors){var r=Object.getOwnPropertyDescriptor(e,"globalThis");(!r||r.configurable&&(r.enumerable||!r.writable||globalThis!==e))&&Object.defineProperty(e,"globalThis",{configurable:!0,enumerable:!1,value:e,writable:!0})}else(typeof globalThis!="object"||globalThis!==e)&&(e.globalThis=e);return e},lv=_o,hv=xr.exports,$o=Ao,yv=pv,Tv=$o(),Wo=function(){return Tv};lv(Wo,{getPolyfill:$o,implementation:hv,shim:yv});var xv=Wo;function Ai(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function dv(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ai(Object(r),!0).forEach(function(n){K(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ai(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var Ae=xv(),zo={vtkObject:function(){return null}};function ze(t){if(t==null||t.isA)return t;if(!t.vtkClass)return Ae.console&&Ae.console.error&&Ae.console.error("Invalid VTK object"),null;var e=zo[t.vtkClass];if(!e)return Ae.console&&Ae.console.error&&Ae.console.error("No vtk class found for Object of type ".concat(t.vtkClass)),null;var r=dv({},t);Object.keys(r).forEach(function(a){r[a]&&mt(r[a])==="object"&&r[a].vtkClass&&(r[a]=ze(r[a]))});var n=e(r);return n&&n.modified&&n.modified(),n}function Ov(t,e){zo[t]=e}ze.register=Ov;function Ka(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Xa(t,e,r){return e&&$i(t.prototype,e),r&&$i(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Gt(t){return Gt=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},Gt(t)}function Sv(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Gt(t),t!==null););return t}function yn(){return typeof Reflect!="undefined"&&Reflect.get?yn=Reflect.get:yn=function(e,r,n){var a=Sv(e,r);if(!!a){var i=Object.getOwnPropertyDescriptor(a,r);return i.get?i.get.call(arguments.length<3?e:n):i.value}},yn.apply(this,arguments)}function Cv(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&wr(t,e)}function wv(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ev(t,e){if(e&&(mt(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return wv(t)}function Mv(t){return Function.toString.call(t).indexOf("[native code]")!==-1}function Ea(t){var e=typeof Map=="function"?new Map:void 0;return Ea=function(n){if(n===null||!Mv(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof e!="undefined"){if(e.has(n))return e.get(n);e.set(n,a)}function a(){return Tr(n,arguments,Gt(this).constructor)}return a.prototype=Object.create(n.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),wr(a,n)},Ea(t)}function Dv(t){var e=bv();return function(){var n=Gt(t),a;if(e){var i=Gt(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return Ev(this,a)}}function bv(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var qn=function(t){Cv(r,t);var e=Dv(r);function r(){return Ka(this,r),e.apply(this,arguments)}return Xa(r,[{key:"push",value:function(){for(var a=0;a<arguments.length;a++)this.includes(arguments[a])||yn(Gt(r.prototype),"push",this).call(this,arguments[a]);return this.length}}]),r}(Ea(Array));function Wi(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function wn(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Wi(Object(r),!0).forEach(function(n){K(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Wi(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var Ma=0,Lv=Symbol("void");function Rv(){return Ma}var jo={};function Lt(){}var Vv=["log","debug","info","warn","error","time","timeEnd","group","groupEnd"];Vv.forEach(function(t){jo[t]=Lt});Ae.console=console.hasOwnProperty("log")?console:jo;var Ve={debug:Lt,error:Ae.console.error||Lt,info:Ae.console.info||Lt,log:Ae.console.log||Lt,warn:Ae.console.warn||Lt};function kv(t,e){Ve[t]&&(Ve[t]=e||Lt)}function Bv(){Ve.log.apply(Ve,arguments)}function Uv(){Ve.info.apply(Ve,arguments)}function _t(){Ve.debug.apply(Ve,arguments)}function Y(){Ve.error.apply(Ve,arguments)}function Ya(){Ve.warn.apply(Ve,arguments)}var zi={};function Nv(t){zi[t]||(Ve.error(t),zi[t]=!0)}var De=Object.create(null);De.Float32Array=Float32Array;De.Float64Array=Float64Array;De.Uint8Array=Uint8Array;De.Int8Array=Int8Array;De.Uint16Array=Uint16Array;De.Int16Array=Int16Array;De.Uint32Array=Uint32Array;De.Int32Array=Int32Array;De.Uint8ClampedArray=Uint8ClampedArray;try{De.BigInt64Array=BigInt64Array,De.BigUint64Array=BigUint64Array}catch{}function Br(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return Tr(De[t]||Float64Array,r)}function Ho(t){for(var e,r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return(e=De[t]||Float64Array).from.apply(e,n)}function Ia(t){return t.charAt(0).toUpperCase()+t.slice(1)}function ae(t){return Ia(t[0]==="_"?t.slice(1):t)}function Fv(t){return t.charAt(0).toLowerCase()+t.slice(1)}function mv(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1e3,n=["TB","GB","MB","KB"],a=Number(t),i="B";a>r;)a/=r,i=n.pop();return"".concat(a.toFixed(e)," ").concat(i)}function Gv(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ",r=[],n=t;n>1e3;)r.push("000".concat(n%1e3).slice(-3)),n=Math.floor(n/1e3);return n>0&&r.push(n),r.reverse(),r.join(e)}function Po(t){Object.keys(t).forEach(function(e){Array.isArray(t[e])&&(t[e]=[].concat(t[e]))})}function _v(t,e){if(t===e)return!0;if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;for(var r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}return!1}function Av(t,e){return Object.keys(t).find(function(r){return t[r]===e})}function Ko(t){return t&&t.isA?t.getState():t}function Xo(t){setTimeout(t,0)}function $v(t,e){var r=performance.now();t.finally(function(){var n=performance.now()-r;e(n)})}function be(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Po(e);var r=[];if(Number.isInteger(e.mtime)||(e.mtime=++Ma),!("classHierarchy"in e))e.classHierarchy=new qn("vtkObject");else if(!(e.classHierarchy instanceof qn)){for(var n=new qn,a=0;a<e.classHierarchy.length;a++)n.push(e.classHierarchy[a]);e.classHierarchy=n}function i(f){r[f]=null}function s(f){function o(){i(f)}return Object.freeze({unsubscribe:o})}return t.isDeleted=function(){return!!e.deleted},t.modified=function(f){if(e.deleted){Y("instance deleted - cannot call any method");return}f&&f<t.getMTime()||(e.mtime=++Ma,r.forEach(function(o){return o&&o(t)}))},t.onModified=function(f){if(e.deleted)return Y("instance deleted - cannot call any method"),null;var o=r.length;return r.push(f),s(o)},t.getMTime=function(){return e.mtime},t.isA=function(f){for(var o=e.classHierarchy.length;o--;)if(e.classHierarchy[o]===f)return!0;return!1},t.getClassName=function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.classHierarchy[e.classHierarchy.length-1-f]},t.set=function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,c=!1;return Object.keys(f).forEach(function(g){var v=u?null:t["set".concat(Ia(g))];v&&Array.isArray(f[g])&&v.length>1?c=v.apply(void 0,re(f[g]))||c:v?c=v(f[g])||c:(["mtime"].indexOf(g)===-1&&!o&&Ya("Warning: Set value to model directly ".concat(g,", ").concat(f[g])),c=e[g]!==f[g]||c,e[g]=f[g])}),c},t.get=function(){for(var f=arguments.length,o=new Array(f),u=0;u<f;u++)o[u]=arguments[u];if(!o.length)return e;var c={};return o.forEach(function(g){c[g]=e[g]}),c},t.getReferenceByName=function(f){return e[f]},t.delete=function(){Object.keys(e).forEach(function(f){return delete e[f]}),r.forEach(function(f,o){return i(o)}),e.deleted=!0},t.getState=function(){if(e.deleted)return null;var f=wn(wn({},e),{},{vtkClass:t.getClassName()});Object.keys(f).forEach(function(u){f[u]===null||f[u]===void 0||u[0]==="_"?delete f[u]:f[u].isA?f[u]=f[u].getState():Array.isArray(f[u])&&(f[u]=f[u].map(Ko))});var o={};return Object.keys(f).sort().forEach(function(u){o[u]=f[u]}),o.mtime&&delete o.mtime,o},t.shallowCopy=function(f){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(f.getClassName()!==t.getClassName())throw new Error("Cannot ShallowCopy ".concat(f.getClassName()," into ").concat(t.getClassName()));var u=f.get(),c=Object.keys(e).sort(),g=Object.keys(u).sort();g.forEach(function(v){var p=c.indexOf(v);p===-1?o&&_t("add ".concat(v," in shallowCopy")):c.splice(p,1),e[v]=u[v]}),c.length&&o&&_t("Untouched keys: ".concat(c.join(", "))),t.modified()},t.toJSON=function(){return t.getState()},t}var Wv={object:function(e,r,n){return function(){return wn({},r[n.name])}}};function je(t,e,r){r.forEach(function(n){if(mt(n)==="object"){var a=Wv[n.type];a?t["get".concat(ae(n.name))]=a(t,e,n):t["get".concat(ae(n.name))]=function(){return e[n.name]}}else t["get".concat(ae(n))]=function(){return e[n]}})}var zv={enum:function(e,r,n){var a="_on".concat(ae(n.name),"Changed");return function(i){if(typeof i=="string"){if(n.enum[i]!==void 0)return r[n.name]!==n.enum[i]?(r[n.name]=n.enum[i],e.modified(),!0):!1;throw Y("Set Enum with invalid argument ".concat(n,", ").concat(i)),new RangeError("Set Enum with invalid string argument")}if(typeof i=="number"){if(r[n.name]!==i){if(Object.keys(n.enum).map(function(o){return n.enum[o]}).indexOf(i)!==-1){var s,f=r[n.name];return r[n.name]=i,(s=r[a])===null||s===void 0||s.call(r,e,r,i,f),e.modified(),!0}throw Y("Set Enum outside numeric range ".concat(n,", ").concat(i)),new RangeError("Set Enum outside numeric range")}return!1}throw Y("Set Enum with invalid argument (String/Number) ".concat(n,", ").concat(i)),new TypeError("Set Enum with invalid argument (String/Number)")}},object:function(e,r,n){var a="_on".concat(ae(n.name),"Changed");return function(i){if(!rg(r[n.name],i)){var s,f=r[n.name];return r[n.name]=i,(s=r[a])===null||s===void 0||s.call(r,e,r,i,f),e.modified(),!0}return!1}}};function ji(t){if(mt(t)==="object"){var e=zv[t.type];if(e)return function(r,n){return e(r,n,t)};throw Y("No setter for field ".concat(t)),new TypeError("No setter for field")}return function(n,a){var i="_on".concat(ae(t),"Changed");return function(f){if(a.deleted)return Y("instance deleted - cannot call any method"),!1;if(a[t]!==f){var o,u=a[t.name];return a[t]=f,(o=a[i])===null||o===void 0||o.call(a,n,a,f,u),n.modified(),!0}return!1}}}function _n(t,e,r){r.forEach(function(n){mt(n)==="object"?t["set".concat(ae(n.name))]=ji(n)(t,e):t["set".concat(ae(n))]=ji(n)(t,e)})}function we(t,e,r){je(t,e,r),_n(t,e,r)}function Qa(t,e,r){r.forEach(function(n){t["get".concat(ae(n))]=function(){return e[n]?Array.from(e[n]):e[n]},t["get".concat(ae(n),"ByReference")]=function(){return e[n]}})}function Yo(t,e,r,n){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:void 0;r.forEach(function(i){if(e[i]&&n&&e[i].length!==n)throw new RangeError("Invalid initial number of values for array (".concat(i,")"));var s="_on".concat(ae(i),"Changed");t["set".concat(ae(i))]=function(){if(e.deleted)return Y("instance deleted - cannot call any method"),!1;for(var f=arguments.length,o=new Array(f),u=0;u<f;u++)o[u]=arguments[u];var c=o,g,v=!1;if(c.length===1&&(c[0]==null||c[0].length>=0)&&(c=c[0],v=!0),c==null)g=e[i]!==c;else{if(n&&c.length!==n)if(c.length<n&&a!==void 0)for(c=Array.from(c),v=!1;c.length<n;)c.push(a);else throw new RangeError("Invalid number of values for array setter (".concat(i,")"));g=e[i]==null||e[i].length!==c.length;for(var p=0;!g&&p<c.length;++p)g=e[i][p]!==c[p];g&&v&&(c=Array.from(c))}if(g){var l,y=e[i.name];e[i]=c,(l=e[s])===null||l===void 0||l.call(e,t,e,c,y),t.modified()}return g},t["set".concat(ae(i),"From")]=function(f){var o=e[i];f.forEach(function(u,c){o[c]=u})}})}function jv(t,e,r,n){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:void 0;Qa(t,e,r),Yo(t,e,r,n,a)}function qa(t,e,r){for(var n=0;n<r.length;n++){var a=r[n];e[a]!==void 0&&(e["_".concat(a)]=e[a],delete e[a])}}function Hv(t,e,r,n){e.inputData?e.inputData=e.inputData.map(ze):e.inputData=[],e.inputConnection?e.inputConnection=e.inputConnection.map(ze):e.inputConnection=[],e.output?e.output=e.output.map(ze):e.output=[],e.inputArrayToProcess?e.inputArrayToProcess=e.inputArrayToProcess.map(ze):e.inputArrayToProcess=[],e.numberOfInputs=r;function a(l){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(e.deleted){Y("instance deleted - cannot call any method");return}if(y>=e.numberOfInputs){Y("algorithm ".concat(t.getClassName()," only has ").concat(e.numberOfInputs," input ports. To add more input ports, use addInputData()"));return}(e.inputData[y]!==l||e.inputConnection[y])&&(e.inputData[y]=l,e.inputConnection[y]=null,t.modified&&t.modified())}function i(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.inputConnection[l]&&(e.inputData[l]=e.inputConnection[l]()),e.inputData[l]}function s(l){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(e.deleted){Y("instance deleted - cannot call any method");return}if(y>=e.numberOfInputs){var h="algorithm ".concat(t.getClassName()," only has ");h+="".concat(e.numberOfInputs),h+=" input ports. To add more input ports, use addInputConnection()",Y(h);return}e.inputData[y]=null,e.inputConnection[y]=l}function f(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.inputConnection[l]}function o(){for(var l=e.numberOfInputs;l&&!e.inputData[l-1]&&!e.inputConnection[l-1];)l--;return l===e.numberOfInputs&&e.numberOfInputs++,l}function u(l){if(e.deleted){Y("instance deleted - cannot call any method");return}s(l,o())}function c(l){if(e.deleted){Y("instance deleted - cannot call any method");return}a(l,o())}function g(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.deleted?(Y("instance deleted - cannot call any method"),null):(t.shouldUpdate()&&t.update(),e.output[l])}t.shouldUpdate=function(){for(var l=t.getMTime(),y=1/0,h=n;h--;){if(!e.output[h]||e.output[h].isDeleted())return!0;var T=e.output[h].getMTime();if(T<l)return!0;T<y&&(y=T)}for(h=e.numberOfInputs;h--;){var x,S;if((x=e.inputConnection[h])!==null&&x!==void 0&&x.filter.shouldUpdate()||((S=t.getInputData(h))===null||S===void 0?void 0:S.getMTime())>y)return!0}return!1};function v(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,y=function(){return g(l)};return y.filter=t,y}if(e.numberOfInputs){for(var p=e.numberOfInputs;p--;)e.inputData.push(null),e.inputConnection.push(null);t.setInputData=a,t.setInputConnection=s,t.addInputData=c,t.addInputConnection=u,t.getInputData=i,t.getInputConnection=f}n&&(t.getOutputData=g,t.getOutputPort=v),t.update=function(){var l=[];if(e.numberOfInputs)for(var y=0;y<e.numberOfInputs;)l[y]=t.getInputData(y),y++;t.shouldUpdate()&&t.requestData&&t.requestData(l,e.output)},t.getNumberOfInputPorts=function(){return e.numberOfInputs},t.getNumberOfOutputPorts=function(){return n||e.output.length},t.getInputArrayToProcess=function(l){var y=e.inputArrayToProcess[l],h=e.inputData[l];return y&&h?h["get".concat(y.fieldAssociation)]().getArray(y.arrayName):null},t.setInputArrayToProcess=function(l,y,h){for(var T=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"Scalars";e.inputArrayToProcess.length<l;)e.inputArrayToProcess.push(null);e.inputArrayToProcess[l]={arrayName:y,fieldAssociation:h,attributeType:T}}}var Io=Symbol("Event abort");function Pv(t,e,r){var n=[],a=t.delete,i=1;function s(u){for(var c=0;c<n.length;++c){var g=Ye(n[c],1),v=g[0];if(v===u){n.splice(c,1);return}}}function f(u){function c(){s(u)}return Object.freeze({unsubscribe:c})}function o(){var u=arguments;if(e.deleted){Y("instance deleted - cannot call any method");return}for(var c=n.slice(),g=function(y){var h=Ye(c[y],3),T=h[1],x=h[2];if(!T)return"continue";if(x<0)setTimeout(function(){return T.apply(t,u)},1-x);else{var S=T.apply(t,u);if(S===Io)return"break"}},v=0;v<c.length;++v){var p=g(v);if(p!=="continue"&&p==="break")break}}t["invoke".concat(ae(r))]=o,t["on".concat(ae(r))]=function(u){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(!u.apply)return console.error("Invalid callback for event ".concat(r)),null;if(e.deleted)return Y("instance deleted - cannot call any method"),null;var g=i++;return n.push([g,u,c]),n.sort(function(v,p){return p[2]-v[2]}),f(g)},t.delete=function(){a(),n.forEach(function(u){var c=Ye(u,1),g=c[0];return s(g)})}}function ne(t,e){var r=function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i={},s={};return t(s,i,a),Object.freeze(s)};return e&&ze.register(e,r),r}function Kv(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e.filter(function(s){return!!s}).map(function(s){return s.apply(void 0,a)})}}function Qo(t){return t&&t.isA&&t.isA("vtkObject")}function Da(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];if(Qo(t)){if(n.indexOf(t)>=0)return r;n.push(t);var a=e(t);a!==void 0&&r.push(a);var i=t.get();Object.keys(i).forEach(function(s){var f=i[s];Array.isArray(f)?f.forEach(function(o){Da(o,e,r,n)}):Da(f,e,r,n)})}return r}function Xv(t,e,r){var n=this,a,i=function(){for(var f=arguments.length,o=new Array(f),u=0;u<f;u++)o[u]=arguments[u];var c=n,g=function(){a=null,r||t.apply(c,o)},v=r&&!a;clearTimeout(a),a=setTimeout(g,e),v&&t.apply(c,o)};return i.cancel=function(){return clearTimeout(a)},i}function Yv(t,e){var r=!1,n=null;function a(){r=!1,n!==null&&(i.apply(void 0,re(n)),n=null)}function i(){for(var s=arguments.length,f=new Array(s),o=0;o<s;o++)f[o]=arguments[o];if(r){n=f;return}r=!0,t.apply(void 0,f),setTimeout(a,e)}return i}function qo(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};e.keystore=Object.assign(e.keystore||{},r),t.setKey=function(n,a){e.keystore[n]=a},t.getKey=function(n){return e.keystore[n]},t.getAllKeys=function(){return Object.keys(e.keystore)},t.deleteKey=function(n){return delete e.keystore[n]},t.clearKeystore=function(){return t.getAllKeys().forEach(function(n){return delete e.keystore[n]})}}var Iv=1,Kr="__root__";function Qv(t,e){qo(t,e);var r=t.delete;e.proxyId="".concat(Iv++),e.ui=JSON.parse(JSON.stringify(e.ui||[])),je(t,e,["proxyId","proxyGroup","proxyName"]),we(t,e,["proxyManager"]);var n={},a={};function i(u,c){a[c]||(a[c]=[]);for(var g=a[c],v=0;v<u.length;v++)g.push(u[v].name),n[u[v].name]=u[v],u[v].children&&u[v].children.length&&i(u[v].children,u[v].name)}i(e.ui,Kr),t.updateUI=function(u){e.ui=JSON.parse(JSON.stringify(u||[])),Object.keys(n).forEach(function(c){return delete n[c]}),Object.keys(a).forEach(function(c){return delete a[c]}),i(e.ui,Kr),t.modified()};function s(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Kr;return a[u]}t.updateProxyProperty=function(u,c){var g=n[u];g?Object.assign(g,c):n[u]=wn({},c)},t.activate=function(){if(e.proxyManager){var u="setActive".concat(ae(t.getProxyGroup().slice(0,-1)));e.proxyManager[u]&&e.proxyManager[u](t)}},e.propertyLinkSubscribers={},t.registerPropertyLinkForGC=function(u,c){c in e.propertyLinkSubscribers||(e.propertyLinkSubscribers[c]=[]),e.propertyLinkSubscribers[c].push(u)},t.gcPropertyLinks=function(u){for(var c=e.propertyLinkSubscribers[u]||[];c.length;)c.pop().unbind(t)},e.propertyLinkMap={},t.getPropertyLink=function(u){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e.propertyLinkMap[u])return e.propertyLinkMap[u];var g=null,v=[],p=0,l=!1;function y(O){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(l)return null;var w=[],E=null;for(p=v.length;p--;){var M=v[p];M.instance===O?E=M:w.push(M)}if(!E)return null;var L=E.instance["get".concat(ae(E.propertyName))]();if(!_v(L,g)||C){for(g=L,l=!0;w.length;){var b=w.pop();b.instance.set(K({},b.propertyName,g))}l=!1}return e.propertyLinkMap[u].persistent&&(e.propertyLinkMap[u].value=L),L}function h(O,C){var w=[];for(p=v.length;p--;){var E=v[p];E.instance===O&&(E.propertyName===C||C===void 0)&&(E.subscription.unsubscribe(),w.push(p))}for(;w.length;)v.splice(w.pop(),1)}function T(O,C){var w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,E=O.onModified(y),M=v[0];return v.push({instance:O,propertyName:C,subscription:E}),w&&(e.propertyLinkMap[u].persistent&&e.propertyLinkMap[u].value!==void 0?O.set(K({},C,e.propertyLinkMap[u].value)):M&&y(M.instance,!0)),{unsubscribe:function(){return h(O,C)}}}function x(){for(;v.length;)v.pop().subscription.unsubscribe()}var S={bind:T,unbind:h,unsubscribe:x,persistent:c};return e.propertyLinkMap[u]=S,S};function f(){for(var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Kr,c=[],g=e.proxyId,v=s(u)||[],p=0;p<v.length;p++){var l=v[p],y=t["get".concat(ae(l))],h=y?y():void 0,T={id:g,name:l,value:h},x=f(l);x.length&&(T.children=x),c.push(T)}return c}t.listPropertyNames=function(){return f().map(function(u){return u.name})},t.getPropertyByName=function(u){return f().find(function(c){return c.name===u})},t.getPropertyDomainByName=function(u){return(n[u]||{}).domain},t.getProxySection=function(){return{id:e.proxyId,name:e.proxyGroup,ui:e.ui,properties:f()}},t.delete=function(){for(var u=Object.keys(e.propertyLinkMap),c=u.length;c--;)e.propertyLinkMap[u[c]].unsubscribe();Object.keys(e.propertyLinkSubscribers).forEach(t.gcPropertyLinks),r()},t.getState=function(){return null};function o(){if(e.links)for(var u=0;u<e.links.length;u++){var c=e.links[u],g=c.link,v=c.property,p=c.persistent,l=c.updateOnBind,y=c.type;if(y==="application"){var h=e.proxyManager.getPropertyLink(g,p);t.registerPropertyLinkForGC(h,"application"),h.bind(t,v,l)}}}Xo(o)}function qv(t,e,r){for(var n=t.delete,a=[],i=Object.keys(r),s=i.length;s--;){var f=i[s],o=r[f],u=o.modelKey,c=o.property,g=o.modified,v=g===void 0?!0:g,p=ae(c),l=ae(f);t["get".concat(l)]=e[u]["get".concat(p)],t["set".concat(l)]=e[u]["set".concat(p)],v&&a.push(e[u].onModified(t.modified))}t.delete=function(){for(;a.length;)a.pop().unsubscribe();n()}}function Zv(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};e.this=t;function a(o){for(var u=Object.keys(o),c=u.length;c--;){var g=u[c];e[g].set(o[g])}}for(var i=Object.keys(n),s=i.length,f=function(){var u=i[s];e[u]=n[u];var c=r[u];t["set".concat(ae(u))]=function(g){if(g!==e[u]){e[u]=g;var v=c[g];a(v),t.modified()}}};s--;)f();i.length&&je(t,e,i)}var Hi=10,Pi=40,Ki=800;function Jv(t){var e=0,r=0,n=0,a=0;return"detail"in t&&(r=t.detail),"wheelDelta"in t&&(r=-t.wheelDelta/120),"wheelDeltaY"in t&&(r=-t.wheelDeltaY/120),"wheelDeltaX"in t&&(e=-t.wheelDeltaX/120),"axis"in t&&t.axis===t.HORIZONTAL_AXIS&&(e=r,r=0),n=e*Hi,a=r*Hi,"deltaY"in t&&(a=t.deltaY),"deltaX"in t&&(n=t.deltaX),(n||a)&&t.deltaMode&&(t.deltaMode===1?(n*=Pi,a*=Pi):(n*=Ki,a*=Ki)),n&&!e&&(e=n<1?-1:1),a&&!r&&(r=a<1?-1:1),{spinX:e,spinY:r,pixelX:n,pixelY:a}}var d={algo:Hv,capitalize:Ia,chain:Kv,debounce:Xv,enumToString:Av,event:Pv,EVENT_ABORT:Io,formatBytesToProperUnit:mv,formatNumbersWithThousandSeparator:Gv,get:je,getArray:Qa,getCurrentGlobalMTime:Rv,getStateArrayMapFunc:Ko,isVtkObject:Qo,keystore:qo,measurePromiseExecution:$v,moveToProtected:qa,newInstance:ne,newTypedArray:Br,newTypedArrayFrom:Ho,normalizeWheel:Jv,obj:be,proxy:Qv,proxyPropertyMapping:qv,proxyPropertyState:Zv,safeArrays:Po,set:_n,setArray:Yo,setGet:we,setGetArray:jv,setImmediate:Xo,setLoggerFunction:kv,throttle:Yv,traverseInstanceTree:Da,TYPED_ARRAYS:De,uncapitalize:Fv,VOID:Lv,vtkDebugMacro:_t,vtkErrorMacro:Y,vtkInfoMacro:Uv,vtkLogMacro:Bv,vtkOnceErrorMacro:Nv,vtkWarningMacro:Ya},z=1e-6,Te=typeof Float32Array!="undefined"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function Zo(){var t=new Te(9);return Te!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function Za(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function e0(t){var e=new Te(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function t0(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function r0(t,e,r,n,a,i,s,f,o){var u=new Te(9);return u[0]=t,u[1]=e,u[2]=r,u[3]=n,u[4]=a,u[5]=i,u[6]=s,u[7]=f,u[8]=o,u}function n0(t,e,r,n,a,i,s,f,o,u){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t[4]=i,t[5]=s,t[6]=f,t[7]=o,t[8]=u,t}function $t(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Jo(t,e){if(t===e){var r=e[1],n=e[2],a=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=n,t[7]=a}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function Ja(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],s=e[4],f=e[5],o=e[6],u=e[7],c=e[8],g=c*s-f*u,v=-c*i+f*o,p=u*i-s*o,l=r*g+n*v+a*p;return l?(l=1/l,t[0]=g*l,t[1]=(-c*n+a*u)*l,t[2]=(f*n-a*s)*l,t[3]=v*l,t[4]=(c*r-a*o)*l,t[5]=(-f*r+a*i)*l,t[6]=p*l,t[7]=(-u*r+n*o)*l,t[8]=(s*r-n*i)*l,t):null}function a0(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],s=e[4],f=e[5],o=e[6],u=e[7],c=e[8];return t[0]=s*c-f*u,t[1]=a*u-n*c,t[2]=n*f-a*s,t[3]=f*o-i*c,t[4]=r*c-a*o,t[5]=a*i-r*f,t[6]=i*u-s*o,t[7]=n*o-r*u,t[8]=r*s-n*i,t}function i0(t){var e=t[0],r=t[1],n=t[2],a=t[3],i=t[4],s=t[5],f=t[6],o=t[7],u=t[8];return e*(u*i-s*o)+r*(-u*a+s*f)+n*(o*a-i*f)}function ef(t,e,r){var n=e[0],a=e[1],i=e[2],s=e[3],f=e[4],o=e[5],u=e[6],c=e[7],g=e[8],v=r[0],p=r[1],l=r[2],y=r[3],h=r[4],T=r[5],x=r[6],S=r[7],O=r[8];return t[0]=v*n+p*s+l*u,t[1]=v*a+p*f+l*c,t[2]=v*i+p*o+l*g,t[3]=y*n+h*s+T*u,t[4]=y*a+h*f+T*c,t[5]=y*i+h*o+T*g,t[6]=x*n+S*s+O*u,t[7]=x*a+S*f+O*c,t[8]=x*i+S*o+O*g,t}function s0(t,e,r){var n=e[0],a=e[1],i=e[2],s=e[3],f=e[4],o=e[5],u=e[6],c=e[7],g=e[8],v=r[0],p=r[1];return t[0]=n,t[1]=a,t[2]=i,t[3]=s,t[4]=f,t[5]=o,t[6]=v*n+p*s+u,t[7]=v*a+p*f+c,t[8]=v*i+p*o+g,t}function o0(t,e,r){var n=e[0],a=e[1],i=e[2],s=e[3],f=e[4],o=e[5],u=e[6],c=e[7],g=e[8],v=Math.sin(r),p=Math.cos(r);return t[0]=p*n+v*s,t[1]=p*a+v*f,t[2]=p*i+v*o,t[3]=p*s-v*n,t[4]=p*f-v*a,t[5]=p*o-v*i,t[6]=u,t[7]=c,t[8]=g,t}function f0(t,e,r){var n=r[0],a=r[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=a*e[3],t[4]=a*e[4],t[5]=a*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function u0(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function c0(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=-r,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function g0(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function v0(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function p0(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],s=r+r,f=n+n,o=a+a,u=r*s,c=n*s,g=n*f,v=a*s,p=a*f,l=a*o,y=i*s,h=i*f,T=i*o;return t[0]=1-g-l,t[3]=c-T,t[6]=v+h,t[1]=c+T,t[4]=1-u-l,t[7]=p-y,t[2]=v-h,t[5]=p+y,t[8]=1-u-g,t}function l0(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],s=e[4],f=e[5],o=e[6],u=e[7],c=e[8],g=e[9],v=e[10],p=e[11],l=e[12],y=e[13],h=e[14],T=e[15],x=r*f-n*s,S=r*o-a*s,O=r*u-i*s,C=n*o-a*f,w=n*u-i*f,E=a*u-i*o,M=c*y-g*l,L=c*h-v*l,b=c*T-p*l,D=g*h-v*y,V=g*T-p*y,B=v*T-p*h,R=x*B-S*V+O*D+C*b-w*L+E*M;return R?(R=1/R,t[0]=(f*B-o*V+u*D)*R,t[1]=(o*b-s*B-u*L)*R,t[2]=(s*V-f*b+u*M)*R,t[3]=(a*V-n*B-i*D)*R,t[4]=(r*B-a*b+i*L)*R,t[5]=(n*b-r*V-i*M)*R,t[6]=(y*E-h*w+T*C)*R,t[7]=(h*O-l*E-T*S)*R,t[8]=(l*w-y*O+T*x)*R,t):null}function h0(t,e,r){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/r,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function y0(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function T0(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}function x0(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t}function tf(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t}function d0(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t}function O0(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t}function S0(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function C0(t,e){var r=t[0],n=t[1],a=t[2],i=t[3],s=t[4],f=t[5],o=t[6],u=t[7],c=t[8],g=e[0],v=e[1],p=e[2],l=e[3],y=e[4],h=e[5],T=e[6],x=e[7],S=e[8];return Math.abs(r-g)<=z*Math.max(1,Math.abs(r),Math.abs(g))&&Math.abs(n-v)<=z*Math.max(1,Math.abs(n),Math.abs(v))&&Math.abs(a-p)<=z*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(i-l)<=z*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(s-y)<=z*Math.max(1,Math.abs(s),Math.abs(y))&&Math.abs(f-h)<=z*Math.max(1,Math.abs(f),Math.abs(h))&&Math.abs(o-T)<=z*Math.max(1,Math.abs(o),Math.abs(T))&&Math.abs(u-x)<=z*Math.max(1,Math.abs(u),Math.abs(x))&&Math.abs(c-S)<=z*Math.max(1,Math.abs(c),Math.abs(S))}var w0=ef,E0=tf,M0=Object.freeze(Object.defineProperty({__proto__:null,create:Zo,fromMat4:Za,clone:e0,copy:t0,fromValues:r0,set:n0,identity:$t,transpose:Jo,invert:Ja,adjoint:a0,determinant:i0,multiply:ef,translate:s0,rotate:o0,scale:f0,fromTranslation:u0,fromRotation:c0,fromScaling:g0,fromMat2d:v0,fromQuat:p0,normalFromMat4:l0,projection:h0,str:y0,frob:T0,add:x0,subtract:tf,multiplyScalar:d0,multiplyScalarAndAdd:O0,exactEquals:S0,equals:C0,mul:w0,sub:E0},Symbol.toStringTag,{value:"Module"}));function D0(){var t=new Te(16);return Te!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function b0(t){var e=new Te(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Qe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function L0(t,e,r,n,a,i,s,f,o,u,c,g,v,p,l,y){var h=new Te(16);return h[0]=t,h[1]=e,h[2]=r,h[3]=n,h[4]=a,h[5]=i,h[6]=s,h[7]=f,h[8]=o,h[9]=u,h[10]=c,h[11]=g,h[12]=v,h[13]=p,h[14]=l,h[15]=y,h}function R0(t,e,r,n,a,i,s,f,o,u,c,g,v,p,l,y,h){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t[4]=i,t[5]=s,t[6]=f,t[7]=o,t[8]=u,t[9]=c,t[10]=g,t[11]=v,t[12]=p,t[13]=l,t[14]=y,t[15]=h,t}function ge(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Se(t,e){if(t===e){var r=e[1],n=e[2],a=e[3],i=e[6],s=e[7],f=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=i,t[11]=e[14],t[12]=a,t[13]=s,t[14]=f}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function At(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],s=e[4],f=e[5],o=e[6],u=e[7],c=e[8],g=e[9],v=e[10],p=e[11],l=e[12],y=e[13],h=e[14],T=e[15],x=r*f-n*s,S=r*o-a*s,O=r*u-i*s,C=n*o-a*f,w=n*u-i*f,E=a*u-i*o,M=c*y-g*l,L=c*h-v*l,b=c*T-p*l,D=g*h-v*y,V=g*T-p*y,B=v*T-p*h,R=x*B-S*V+O*D+C*b-w*L+E*M;return R?(R=1/R,t[0]=(f*B-o*V+u*D)*R,t[1]=(a*V-n*B-i*D)*R,t[2]=(y*E-h*w+T*C)*R,t[3]=(v*w-g*E-p*C)*R,t[4]=(o*b-s*B-u*L)*R,t[5]=(r*B-a*b+i*L)*R,t[6]=(h*O-l*E-T*S)*R,t[7]=(c*E-v*O+p*S)*R,t[8]=(s*V-f*b+u*M)*R,t[9]=(n*b-r*V-i*M)*R,t[10]=(l*w-y*O+T*x)*R,t[11]=(g*O-c*w-p*x)*R,t[12]=(f*L-s*D-o*M)*R,t[13]=(r*D-n*L+a*M)*R,t[14]=(y*S-l*C-h*x)*R,t[15]=(c*C-g*S+v*x)*R,t):null}function V0(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],s=e[4],f=e[5],o=e[6],u=e[7],c=e[8],g=e[9],v=e[10],p=e[11],l=e[12],y=e[13],h=e[14],T=e[15];return t[0]=f*(v*T-p*h)-g*(o*T-u*h)+y*(o*p-u*v),t[1]=-(n*(v*T-p*h)-g*(a*T-i*h)+y*(a*p-i*v)),t[2]=n*(o*T-u*h)-f*(a*T-i*h)+y*(a*u-i*o),t[3]=-(n*(o*p-u*v)-f*(a*p-i*v)+g*(a*u-i*o)),t[4]=-(s*(v*T-p*h)-c*(o*T-u*h)+l*(o*p-u*v)),t[5]=r*(v*T-p*h)-c*(a*T-i*h)+l*(a*p-i*v),t[6]=-(r*(o*T-u*h)-s*(a*T-i*h)+l*(a*u-i*o)),t[7]=r*(o*p-u*v)-s*(a*p-i*v)+c*(a*u-i*o),t[8]=s*(g*T-p*y)-c*(f*T-u*y)+l*(f*p-u*g),t[9]=-(r*(g*T-p*y)-c*(n*T-i*y)+l*(n*p-i*g)),t[10]=r*(f*T-u*y)-s*(n*T-i*y)+l*(n*u-i*f),t[11]=-(r*(f*p-u*g)-s*(n*p-i*g)+c*(n*u-i*f)),t[12]=-(s*(g*h-v*y)-c*(f*h-o*y)+l*(f*v-o*g)),t[13]=r*(g*h-v*y)-c*(n*h-a*y)+l*(n*v-a*g),t[14]=-(r*(f*h-o*y)-s*(n*h-a*y)+l*(n*o-a*f)),t[15]=r*(f*v-o*g)-s*(n*v-a*g)+c*(n*o-a*f),t}function k0(t){var e=t[0],r=t[1],n=t[2],a=t[3],i=t[4],s=t[5],f=t[6],o=t[7],u=t[8],c=t[9],g=t[10],v=t[11],p=t[12],l=t[13],y=t[14],h=t[15],T=e*s-r*i,x=e*f-n*i,S=e*o-a*i,O=r*f-n*s,C=r*o-a*s,w=n*o-a*f,E=u*l-c*p,M=u*y-g*p,L=u*h-v*p,b=c*y-g*l,D=c*h-v*l,V=g*h-v*y;return T*V-x*D+S*b+O*L-C*M+w*E}function nt(t,e,r){var n=e[0],a=e[1],i=e[2],s=e[3],f=e[4],o=e[5],u=e[6],c=e[7],g=e[8],v=e[9],p=e[10],l=e[11],y=e[12],h=e[13],T=e[14],x=e[15],S=r[0],O=r[1],C=r[2],w=r[3];return t[0]=S*n+O*f+C*g+w*y,t[1]=S*a+O*o+C*v+w*h,t[2]=S*i+O*u+C*p+w*T,t[3]=S*s+O*c+C*l+w*x,S=r[4],O=r[5],C=r[6],w=r[7],t[4]=S*n+O*f+C*g+w*y,t[5]=S*a+O*o+C*v+w*h,t[6]=S*i+O*u+C*p+w*T,t[7]=S*s+O*c+C*l+w*x,S=r[8],O=r[9],C=r[10],w=r[11],t[8]=S*n+O*f+C*g+w*y,t[9]=S*a+O*o+C*v+w*h,t[10]=S*i+O*u+C*p+w*T,t[11]=S*s+O*c+C*l+w*x,S=r[12],O=r[13],C=r[14],w=r[15],t[12]=S*n+O*f+C*g+w*y,t[13]=S*a+O*o+C*v+w*h,t[14]=S*i+O*u+C*p+w*T,t[15]=S*s+O*c+C*l+w*x,t}function at(t,e,r){var n=r[0],a=r[1],i=r[2],s,f,o,u,c,g,v,p,l,y,h,T;return e===t?(t[12]=e[0]*n+e[4]*a+e[8]*i+e[12],t[13]=e[1]*n+e[5]*a+e[9]*i+e[13],t[14]=e[2]*n+e[6]*a+e[10]*i+e[14],t[15]=e[3]*n+e[7]*a+e[11]*i+e[15]):(s=e[0],f=e[1],o=e[2],u=e[3],c=e[4],g=e[5],v=e[6],p=e[7],l=e[8],y=e[9],h=e[10],T=e[11],t[0]=s,t[1]=f,t[2]=o,t[3]=u,t[4]=c,t[5]=g,t[6]=v,t[7]=p,t[8]=l,t[9]=y,t[10]=h,t[11]=T,t[12]=s*n+c*a+l*i+e[12],t[13]=f*n+g*a+y*i+e[13],t[14]=o*n+v*a+h*i+e[14],t[15]=u*n+p*a+T*i+e[15]),t}function ei(t,e,r){var n=r[0],a=r[1],i=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*a,t[5]=e[5]*a,t[6]=e[6]*a,t[7]=e[7]*a,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function B0(t,e,r,n){var a=n[0],i=n[1],s=n[2],f=Math.hypot(a,i,s),o,u,c,g,v,p,l,y,h,T,x,S,O,C,w,E,M,L,b,D,V,B,R,N;return f<z?null:(f=1/f,a*=f,i*=f,s*=f,o=Math.sin(r),u=Math.cos(r),c=1-u,g=e[0],v=e[1],p=e[2],l=e[3],y=e[4],h=e[5],T=e[6],x=e[7],S=e[8],O=e[9],C=e[10],w=e[11],E=a*a*c+u,M=i*a*c+s*o,L=s*a*c-i*o,b=a*i*c-s*o,D=i*i*c+u,V=s*i*c+a*o,B=a*s*c+i*o,R=i*s*c-a*o,N=s*s*c+u,t[0]=g*E+y*M+S*L,t[1]=v*E+h*M+O*L,t[2]=p*E+T*M+C*L,t[3]=l*E+x*M+w*L,t[4]=g*b+y*D+S*V,t[5]=v*b+h*D+O*V,t[6]=p*b+T*D+C*V,t[7]=l*b+x*D+w*V,t[8]=g*B+y*R+S*N,t[9]=v*B+h*R+O*N,t[10]=p*B+T*R+C*N,t[11]=l*B+x*R+w*N,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function rf(t,e,r){var n=Math.sin(r),a=Math.cos(r),i=e[4],s=e[5],f=e[6],o=e[7],u=e[8],c=e[9],g=e[10],v=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=i*a+u*n,t[5]=s*a+c*n,t[6]=f*a+g*n,t[7]=o*a+v*n,t[8]=u*a-i*n,t[9]=c*a-s*n,t[10]=g*a-f*n,t[11]=v*a-o*n,t}function nf(t,e,r){var n=Math.sin(r),a=Math.cos(r),i=e[0],s=e[1],f=e[2],o=e[3],u=e[8],c=e[9],g=e[10],v=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*a-u*n,t[1]=s*a-c*n,t[2]=f*a-g*n,t[3]=o*a-v*n,t[8]=i*n+u*a,t[9]=s*n+c*a,t[10]=f*n+g*a,t[11]=o*n+v*a,t}function af(t,e,r){var n=Math.sin(r),a=Math.cos(r),i=e[0],s=e[1],f=e[2],o=e[3],u=e[4],c=e[5],g=e[6],v=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*a+u*n,t[1]=s*a+c*n,t[2]=f*a+g*n,t[3]=o*a+v*n,t[4]=u*a-i*n,t[5]=c*a-s*n,t[6]=g*a-f*n,t[7]=v*a-o*n,t}function sf(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function U0(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function N0(t,e,r){var n=r[0],a=r[1],i=r[2],s=Math.hypot(n,a,i),f,o,u;return s<z?null:(s=1/s,n*=s,a*=s,i*=s,f=Math.sin(e),o=Math.cos(e),u=1-o,t[0]=n*n*u+o,t[1]=a*n*u+i*f,t[2]=i*n*u-a*f,t[3]=0,t[4]=n*a*u-i*f,t[5]=a*a*u+o,t[6]=i*a*u+n*f,t[7]=0,t[8]=n*i*u+a*f,t[9]=a*i*u-n*f,t[10]=i*i*u+o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function F0(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function m0(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function G0(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function of(t,e,r){var n=e[0],a=e[1],i=e[2],s=e[3],f=n+n,o=a+a,u=i+i,c=n*f,g=n*o,v=n*u,p=a*o,l=a*u,y=i*u,h=s*f,T=s*o,x=s*u;return t[0]=1-(p+y),t[1]=g+x,t[2]=v-T,t[3]=0,t[4]=g-x,t[5]=1-(c+y),t[6]=l+h,t[7]=0,t[8]=v+T,t[9]=l-h,t[10]=1-(c+p),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function _0(t,e){var r=new Te(3),n=-e[0],a=-e[1],i=-e[2],s=e[3],f=e[4],o=e[5],u=e[6],c=e[7],g=n*n+a*a+i*i+s*s;return g>0?(r[0]=(f*s+c*n+o*i-u*a)*2/g,r[1]=(o*s+c*a+u*n-f*i)*2/g,r[2]=(u*s+c*i+f*a-o*n)*2/g):(r[0]=(f*s+c*n+o*i-u*a)*2,r[1]=(o*s+c*a+u*n-f*i)*2,r[2]=(u*s+c*i+f*a-o*n)*2),of(t,e,r),t}function A0(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function ff(t,e){var r=e[0],n=e[1],a=e[2],i=e[4],s=e[5],f=e[6],o=e[8],u=e[9],c=e[10];return t[0]=Math.hypot(r,n,a),t[1]=Math.hypot(i,s,f),t[2]=Math.hypot(o,u,c),t}function uf(t,e){var r=new Te(3);ff(r,e);var n=1/r[0],a=1/r[1],i=1/r[2],s=e[0]*n,f=e[1]*a,o=e[2]*i,u=e[4]*n,c=e[5]*a,g=e[6]*i,v=e[8]*n,p=e[9]*a,l=e[10]*i,y=s+c+l,h=0;return y>0?(h=Math.sqrt(y+1)*2,t[3]=.25*h,t[0]=(g-p)/h,t[1]=(v-o)/h,t[2]=(f-u)/h):s>c&&s>l?(h=Math.sqrt(1+s-c-l)*2,t[3]=(g-p)/h,t[0]=.25*h,t[1]=(f+u)/h,t[2]=(v+o)/h):c>l?(h=Math.sqrt(1+c-s-l)*2,t[3]=(v-o)/h,t[0]=(f+u)/h,t[1]=.25*h,t[2]=(g+p)/h):(h=Math.sqrt(1+l-s-c)*2,t[3]=(f-u)/h,t[0]=(v+o)/h,t[1]=(g+p)/h,t[2]=.25*h),t}function cf(t,e,r,n){var a=e[0],i=e[1],s=e[2],f=e[3],o=a+a,u=i+i,c=s+s,g=a*o,v=a*u,p=a*c,l=i*u,y=i*c,h=s*c,T=f*o,x=f*u,S=f*c,O=n[0],C=n[1],w=n[2];return t[0]=(1-(l+h))*O,t[1]=(v+S)*O,t[2]=(p-x)*O,t[3]=0,t[4]=(v-S)*C,t[5]=(1-(g+h))*C,t[6]=(y+T)*C,t[7]=0,t[8]=(p+x)*w,t[9]=(y-T)*w,t[10]=(1-(g+l))*w,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function $0(t,e,r,n,a){var i=e[0],s=e[1],f=e[2],o=e[3],u=i+i,c=s+s,g=f+f,v=i*u,p=i*c,l=i*g,y=s*c,h=s*g,T=f*g,x=o*u,S=o*c,O=o*g,C=n[0],w=n[1],E=n[2],M=a[0],L=a[1],b=a[2],D=(1-(y+T))*C,V=(p+O)*C,B=(l-S)*C,R=(p-O)*w,N=(1-(v+T))*w,U=(h+x)*w,G=(l+S)*E,m=(h-x)*E,F=(1-(v+y))*E;return t[0]=D,t[1]=V,t[2]=B,t[3]=0,t[4]=R,t[5]=N,t[6]=U,t[7]=0,t[8]=G,t[9]=m,t[10]=F,t[11]=0,t[12]=r[0]+M-(D*M+R*L+G*b),t[13]=r[1]+L-(V*M+N*L+m*b),t[14]=r[2]+b-(B*M+U*L+F*b),t[15]=1,t}function gf(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],s=r+r,f=n+n,o=a+a,u=r*s,c=n*s,g=n*f,v=a*s,p=a*f,l=a*o,y=i*s,h=i*f,T=i*o;return t[0]=1-g-l,t[1]=c+T,t[2]=v-h,t[3]=0,t[4]=c-T,t[5]=1-u-l,t[6]=p+y,t[7]=0,t[8]=v+h,t[9]=p-y,t[10]=1-u-g,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function W0(t,e,r,n,a,i,s){var f=1/(r-e),o=1/(a-n),u=1/(i-s);return t[0]=i*2*f,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i*2*o,t[6]=0,t[7]=0,t[8]=(r+e)*f,t[9]=(a+n)*o,t[10]=(s+i)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*i*2*u,t[15]=0,t}function vf(t,e,r,n,a){var i=1/Math.tan(e/2),s;return t[0]=i/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,a!=null&&a!==1/0?(s=1/(n-a),t[10]=(a+n)*s,t[14]=2*a*n*s):(t[10]=-1,t[14]=-2*n),t}var z0=vf;function j0(t,e,r,n,a){var i=1/Math.tan(e/2),s;return t[0]=i/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,a!=null&&a!==1/0?(s=1/(n-a),t[10]=a*s,t[14]=a*n*s):(t[10]=-1,t[14]=-n),t}function H0(t,e,r,n){var a=Math.tan(e.upDegrees*Math.PI/180),i=Math.tan(e.downDegrees*Math.PI/180),s=Math.tan(e.leftDegrees*Math.PI/180),f=Math.tan(e.rightDegrees*Math.PI/180),o=2/(s+f),u=2/(a+i);return t[0]=o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=-((s-f)*o*.5),t[9]=(a-i)*u*.5,t[10]=n/(r-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*r/(r-n),t[15]=0,t}function pf(t,e,r,n,a,i,s){var f=1/(e-r),o=1/(n-a),u=1/(i-s);return t[0]=-2*f,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+r)*f,t[13]=(a+n)*o,t[14]=(s+i)*u,t[15]=1,t}var P0=pf;function K0(t,e,r,n,a,i,s){var f=1/(e-r),o=1/(n-a),u=1/(i-s);return t[0]=-2*f,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=u,t[11]=0,t[12]=(e+r)*f,t[13]=(a+n)*o,t[14]=i*u,t[15]=1,t}function X0(t,e,r,n){var a,i,s,f,o,u,c,g,v,p,l=e[0],y=e[1],h=e[2],T=n[0],x=n[1],S=n[2],O=r[0],C=r[1],w=r[2];return Math.abs(l-O)<z&&Math.abs(y-C)<z&&Math.abs(h-w)<z?ge(t):(c=l-O,g=y-C,v=h-w,p=1/Math.hypot(c,g,v),c*=p,g*=p,v*=p,a=x*v-S*g,i=S*c-T*v,s=T*g-x*c,p=Math.hypot(a,i,s),p?(p=1/p,a*=p,i*=p,s*=p):(a=0,i=0,s=0),f=g*s-v*i,o=v*a-c*s,u=c*i-g*a,p=Math.hypot(f,o,u),p?(p=1/p,f*=p,o*=p,u*=p):(f=0,o=0,u=0),t[0]=a,t[1]=f,t[2]=c,t[3]=0,t[4]=i,t[5]=o,t[6]=g,t[7]=0,t[8]=s,t[9]=u,t[10]=v,t[11]=0,t[12]=-(a*l+i*y+s*h),t[13]=-(f*l+o*y+u*h),t[14]=-(c*l+g*y+v*h),t[15]=1,t)}function Y0(t,e,r,n){var a=e[0],i=e[1],s=e[2],f=n[0],o=n[1],u=n[2],c=a-r[0],g=i-r[1],v=s-r[2],p=c*c+g*g+v*v;p>0&&(p=1/Math.sqrt(p),c*=p,g*=p,v*=p);var l=o*v-u*g,y=u*c-f*v,h=f*g-o*c;return p=l*l+y*y+h*h,p>0&&(p=1/Math.sqrt(p),l*=p,y*=p,h*=p),t[0]=l,t[1]=y,t[2]=h,t[3]=0,t[4]=g*h-v*y,t[5]=v*l-c*h,t[6]=c*y-g*l,t[7]=0,t[8]=c,t[9]=g,t[10]=v,t[11]=0,t[12]=a,t[13]=i,t[14]=s,t[15]=1,t}function I0(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function Q0(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function q0(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t}function lf(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t}function Z0(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t}function J0(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t[9]=e[9]+r[9]*n,t[10]=e[10]+r[10]*n,t[11]=e[11]+r[11]*n,t[12]=e[12]+r[12]*n,t[13]=e[13]+r[13]*n,t[14]=e[14]+r[14]*n,t[15]=e[15]+r[15]*n,t}function ep(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function tp(t,e){var r=t[0],n=t[1],a=t[2],i=t[3],s=t[4],f=t[5],o=t[6],u=t[7],c=t[8],g=t[9],v=t[10],p=t[11],l=t[12],y=t[13],h=t[14],T=t[15],x=e[0],S=e[1],O=e[2],C=e[3],w=e[4],E=e[5],M=e[6],L=e[7],b=e[8],D=e[9],V=e[10],B=e[11],R=e[12],N=e[13],U=e[14],G=e[15];return Math.abs(r-x)<=z*Math.max(1,Math.abs(r),Math.abs(x))&&Math.abs(n-S)<=z*Math.max(1,Math.abs(n),Math.abs(S))&&Math.abs(a-O)<=z*Math.max(1,Math.abs(a),Math.abs(O))&&Math.abs(i-C)<=z*Math.max(1,Math.abs(i),Math.abs(C))&&Math.abs(s-w)<=z*Math.max(1,Math.abs(s),Math.abs(w))&&Math.abs(f-E)<=z*Math.max(1,Math.abs(f),Math.abs(E))&&Math.abs(o-M)<=z*Math.max(1,Math.abs(o),Math.abs(M))&&Math.abs(u-L)<=z*Math.max(1,Math.abs(u),Math.abs(L))&&Math.abs(c-b)<=z*Math.max(1,Math.abs(c),Math.abs(b))&&Math.abs(g-D)<=z*Math.max(1,Math.abs(g),Math.abs(D))&&Math.abs(v-V)<=z*Math.max(1,Math.abs(v),Math.abs(V))&&Math.abs(p-B)<=z*Math.max(1,Math.abs(p),Math.abs(B))&&Math.abs(l-R)<=z*Math.max(1,Math.abs(l),Math.abs(R))&&Math.abs(y-N)<=z*Math.max(1,Math.abs(y),Math.abs(N))&&Math.abs(h-U)<=z*Math.max(1,Math.abs(h),Math.abs(U))&&Math.abs(T-G)<=z*Math.max(1,Math.abs(T),Math.abs(G))}var ba=nt,rp=lf,La=Object.freeze(Object.defineProperty({__proto__:null,create:D0,clone:b0,copy:Qe,fromValues:L0,set:R0,identity:ge,transpose:Se,invert:At,adjoint:V0,determinant:k0,multiply:nt,translate:at,scale:ei,rotate:B0,rotateX:rf,rotateY:nf,rotateZ:af,fromTranslation:sf,fromScaling:U0,fromRotation:N0,fromXRotation:F0,fromYRotation:m0,fromZRotation:G0,fromRotationTranslation:of,fromQuat2:_0,getTranslation:A0,getScaling:ff,getRotation:uf,fromRotationTranslationScale:cf,fromRotationTranslationScaleOrigin:$0,fromQuat:gf,frustum:W0,perspectiveNO:vf,perspective:z0,perspectiveZO:j0,perspectiveFromFieldOfView:H0,orthoNO:pf,ortho:P0,orthoZO:K0,lookAt:X0,targetTo:Y0,str:I0,frob:Q0,add:q0,subtract:lf,multiplyScalar:Z0,multiplyScalarAndAdd:J0,exactEquals:ep,equals:tp,mul:ba,sub:rp},Symbol.toStringTag,{value:"Module"}));function hf(){var t=new Te(3);return Te!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function np(t){var e=t[0],r=t[1],n=t[2];return Math.hypot(e,r,n)}function Xi(t,e,r){var n=new Te(3);return n[0]=t,n[1]=e,n[2]=r,n}function vr(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t}function Yt(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function pt(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t}function ap(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function Ra(t,e){var r=e[0],n=e[1],a=e[2],i=r*r+n*n+a*a;return i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t}function yf(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Zn(t,e,r){var n=e[0],a=e[1],i=e[2],s=r[0],f=r[1],o=r[2];return t[0]=a*o-i*f,t[1]=i*s-n*o,t[2]=n*f-a*s,t}function Le(t,e,r){var n=e[0],a=e[1],i=e[2],s=r[3]*n+r[7]*a+r[11]*i+r[15];return s=s||1,t[0]=(r[0]*n+r[4]*a+r[8]*i+r[12])/s,t[1]=(r[1]*n+r[5]*a+r[9]*i+r[13])/s,t[2]=(r[2]*n+r[6]*a+r[10]*i+r[14])/s,t}function Yi(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function Ii(t,e){var r=t[0],n=t[1],a=t[2],i=e[0],s=e[1],f=e[2];return Math.abs(r-i)<=z*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(n-s)<=z*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(a-f)<=z*Math.max(1,Math.abs(a),Math.abs(f))}var ip=Yt,Tf=np;(function(){var t=hf();return function(e,r,n,a,i,s){var f,o;for(r||(r=3),n||(n=0),a?o=Math.min(a*r+n,e.length):o=e.length,f=n;f<o;f+=r)t[0]=e[f],t[1]=e[f+1],t[2]=e[f+2],i(t,t,s),e[f]=t[0],e[f+1]=t[1],e[f+2]=t[2];return e}})();function sp(){var t=new Te(4);return Te!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function op(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],s=r*r+n*n+a*a+i*i;return s>0&&(s=1/Math.sqrt(s)),t[0]=r*s,t[1]=n*s,t[2]=a*s,t[3]=i*s,t}(function(){var t=sp();return function(e,r,n,a,i,s){var f,o;for(r||(r=4),n||(n=0),a?o=Math.min(a*r+n,e.length):o=e.length,f=n;f<o;f+=r)t[0]=e[f],t[1]=e[f+1],t[2]=e[f+2],t[3]=e[f+3],i(t,t,s),e[f]=t[0],e[f+1]=t[1],e[f+2]=t[2],e[f+3]=t[3];return e}})();function Er(){var t=new Te(4);return Te!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function xf(t,e,r){r=r*.5;var n=Math.sin(r);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(r),t}function fp(t,e){var r=Math.acos(e[3])*2,n=Math.sin(r/2);return n>z?(t[0]=e[0]/n,t[1]=e[1]/n,t[2]=e[2]/n):(t[0]=1,t[1]=0,t[2]=0),r}function Jn(t,e,r,n){var a=e[0],i=e[1],s=e[2],f=e[3],o=r[0],u=r[1],c=r[2],g=r[3],v,p,l,y,h;return p=a*o+i*u+s*c+f*g,p<0&&(p=-p,o=-o,u=-u,c=-c,g=-g),1-p>z?(v=Math.acos(p),l=Math.sin(v),y=Math.sin((1-n)*v)/l,h=Math.sin(n*v)/l):(y=1-n,h=n),t[0]=y*a+h*o,t[1]=y*i+h*u,t[2]=y*s+h*c,t[3]=y*f+h*g,t}function up(t,e){var r=e[0]+e[4]+e[8],n;if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var a=0;e[4]>e[0]&&(a=1),e[8]>e[a*3+a]&&(a=2);var i=(a+1)%3,s=(a+2)%3;n=Math.sqrt(e[a*3+a]-e[i*3+i]-e[s*3+s]+1),t[a]=.5*n,n=.5/n,t[3]=(e[i*3+s]-e[s*3+i])*n,t[i]=(e[i*3+a]+e[a*3+i])*n,t[s]=(e[s*3+a]+e[a*3+s])*n}return t}var df=op;(function(){var t=hf(),e=Xi(1,0,0),r=Xi(0,1,0);return function(n,a,i){var s=yf(a,i);return s<-.999999?(Zn(t,e,a),Tf(t)<1e-6&&Zn(t,r,a),Ra(t,t),xf(n,t,Math.PI),n):s>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(Zn(t,a,i),n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=1+s,df(n,n))}})();(function(){var t=Er(),e=Er();return function(r,n,a,i,s,f){return Jn(t,n,s,f),Jn(e,a,i,f),Jn(r,t,e,2*f*(1-f)),r}})();(function(){var t=Zo();return function(e,r,n,a){return t[0]=n[0],t[3]=n[1],t[6]=n[2],t[1]=a[0],t[4]=a[1],t[7]=a[2],t[2]=-r[0],t[5]=-r[1],t[8]=-r[2],df(e,up(e,t))}})();var cp=d.vtkErrorMacro,gp=["Build","Render"];function vp(t,e){e.classHierarchy.push("vtkViewNode"),t.build=function(n){},t.render=function(n){},t.traverse=function(n){var a=n.getTraverseOperation(),i=t[a];if(i){i(n);return}t.apply(n,!0);for(var s=0;s<e.children.length;s++)e.children[s].traverse(n);t.apply(n,!1)},t.apply=function(n,a){var i=t[n.getOperation()];i&&i(a,n)},t.getViewNodeFor=function(n){if(e.renderable===n)return t;for(var a=0;a<e.children.length;++a){var i=e.children[a],s=i.getViewNodeFor(n);if(s)return s}},t.getFirstAncestorOfType=function(n){return e._parent?e._parent.isA(n)?e._parent:e._parent.getFirstAncestorOfType(n):null},t.addMissingNode=function(n){if(!!n){var a=e._renderableChildMap.get(n);if(a!==void 0)a.setVisited(!0);else{var i=t.createViewNode(n);i&&(i.setParent(t),i.setVisited(!0),e._renderableChildMap.set(n,i),e.children.push(i))}}},t.addMissingNodes=function(n){if(!(!n||!n.length))for(var a=0;a<n.length;++a){var i=n[a],s=e._renderableChildMap.get(i);if(s!==void 0)s.setVisited(!0);else{var f=t.createViewNode(i);f&&(f.setParent(t),f.setVisited(!0),e._renderableChildMap.set(i,f),e.children.push(f))}}},t.addMissingChildren=function(n){if(!(!n||!n.length))for(var a=0;a<n.length;++a){var i=n[a],s=e.children.indexOf(i);s===-1&&(i.setParent(t),e.children.push(i)),i.setVisited(!0)}},t.prepareNodes=function(){for(var n=0;n<e.children.length;++n)e.children[n].setVisited(!1)},t.setVisited=function(n){e.visited=n},t.removeUnusedNodes=function(){for(var n=null,a=0;a<e.children.length;++a){var i=e.children[a],s=i.getVisited();if(s)i.setVisited(!1);else{var f=i.getRenderable();f&&e._renderableChildMap.delete(f),n||(n=[]),n.push(i),i.delete()}}n&&(e.children=e.children.filter(function(o){return!n.includes(o)}))},t.createViewNode=function(n){if(!e.myFactory)return cp("Cannot create view nodes without my own factory"),null;var a=e.myFactory.createNode(n);return a&&a.setRenderable(n),a};var r=t.delete;t.delete=function(){for(var n=0;n<e.children.length;n++)e.children[n].delete();r()}}var pp={renderable:null,myFactory:null,children:[],visited:!1};function Of(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,pp,r),d.obj(t,e),d.event(t,e,"event"),e._renderableChildMap=new Map,d.get(t,e,["visited"]),d.setGet(t,e,["_parent","renderable","myFactory"]),d.getArray(t,e,["children"]),d.moveToProtected(t,e,["parent"]),vp(t,e)}var lp=d.newInstance(Of,"vtkViewNode"),ie={newInstance:lp,extend:Of,PASS_TYPES:gp};function hp(t,e){e.overrides||(e.overrides={}),e.classHierarchy.push("vtkViewNodeFactory"),t.createNode=function(r){if(r.isDeleted())return null;for(var n=0,a=r.getClassName(n++),i=!1,s=Object.keys(e.overrides);a&&!i;)s.indexOf(a)!==-1?i=!0:a=r.getClassName(n++);if(!i)return null;var f=e.overrides[a]();return f.setMyFactory(t),f},t.registerOverride=function(r,n){e.overrides[r]=n}}var yp={};function Sf(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,yp,r),d.obj(t,e),hp(t,e)}var Tp=d.newInstance(Sf,"vtkViewNodeFactory"),Cf={newInstance:Tp,extend:Sf},wf=Object.create(null);function He(t,e){wf[t]=e}function xp(t,e){e.classHierarchy.push("vtkOpenGLViewNodeFactory")}var dp={};function Op(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,dp,r),e.overrides=wf,Cf.extend(t,e,r),xp(t,e)}d.newInstance(Op,"vtkOpenGLViewNodeFactory");function Sp(t,e){e.classHierarchy.push("vtkOpenGLCamera"),t.buildPass=function(r){r&&(e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getParent(),e.context=e._openGLRenderWindow.getContext())},t.opaquePass=function(r){if(r){var n=e._openGLRenderer.getTiledSizeAndOrigin();e.context.viewport(n.lowerLeftU,n.lowerLeftV,n.usize,n.vsize),e.context.scissor(n.lowerLeftU,n.lowerLeftV,n.usize,n.vsize)}},t.translucentPass=t.opaquePass,t.zBufferPass=t.opaquePass,t.opaqueZBufferPass=t.opaquePass,t.volumePass=t.opaquePass,t.getKeyMatrices=function(r){if(r!==e.lastRenderer||e._openGLRenderWindow.getMTime()>e.keyMatrixTime.getMTime()||t.getMTime()>e.keyMatrixTime.getMTime()||r.getMTime()>e.keyMatrixTime.getMTime()||e.renderable.getMTime()>e.keyMatrixTime.getMTime()){Qe(e.keyMatrices.wcvc,e.renderable.getViewMatrix()),Za(e.keyMatrices.normalMatrix,e.keyMatrices.wcvc),Ja(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix),Se(e.keyMatrices.wcvc,e.keyMatrices.wcvc);var n=e._openGLRenderer.getAspectRatio();Qe(e.keyMatrices.vcpc,e.renderable.getProjectionMatrix(n,-1,1)),Se(e.keyMatrices.vcpc,e.keyMatrices.vcpc),nt(e.keyMatrices.wcpc,e.keyMatrices.vcpc,e.keyMatrices.wcvc),e.keyMatrixTime.modified(),e.lastRenderer=r}return e.keyMatrices}}var Cp={context:null,lastRenderer:null,keyMatrixTime:null,keyMatrices:null};function wp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Cp,r),ie.extend(t,e,r),e.keyMatrixTime={},be(e.keyMatrixTime),e.keyMatrices={normalMatrix:new Float64Array(9),vcpc:new Float64Array(16),wcvc:new Float64Array(16),wcpc:new Float64Array(16)},we(t,e,["context","keyMatrixTime"]),Sp(t,e)}var Ep=ne(wp);He("vtkCamera",Ep);var Mp=_t;function Dp(t,e){e.classHierarchy.push("vtkOpenGLRenderer"),t.buildPass=function(r){if(r){if(!e.renderable)return;t.updateLights(),t.prepareNodes(),t.addMissingNode(e.renderable.getActiveCamera()),t.addMissingNodes(e.renderable.getViewPropsWithNestedProps()),t.removeUnusedNodes()}},t.updateLights=function(){for(var r=0,n=e.renderable.getLightsByReference(),a=0;a<n.length;++a)n[a].getSwitch()>0&&r++;return r||(Mp("No lights are on, creating one."),e.renderable.createLight()),r},t.zBufferPass=function(r){if(r){var n=0,a=e.context;e.renderable.getTransparent()||(e.context.clearColor(1,0,0,1),n|=a.COLOR_BUFFER_BIT),e.renderable.getPreserveDepthBuffer()||(a.clearDepth(1),n|=a.DEPTH_BUFFER_BIT,e.context.depthMask(!0));var i=t.getTiledSizeAndOrigin();a.enable(a.SCISSOR_TEST),a.scissor(i.lowerLeftU,i.lowerLeftV,i.usize,i.vsize),a.viewport(i.lowerLeftU,i.lowerLeftV,i.usize,i.vsize),a.colorMask(!0,!0,!0,!0),n&&a.clear(n),a.enable(a.DEPTH_TEST)}},t.opaqueZBufferPass=function(r){return t.zBufferPass(r)},t.cameraPass=function(r){r&&t.clear()},t.getAspectRatio=function(){var r=e._parent.getSizeByReference(),n=e.renderable.getViewportByReference();return r[0]*(n[2]-n[0])/((n[3]-n[1])*r[1])},t.getTiledSizeAndOrigin=function(){var r=e.renderable.getViewportByReference(),n=[0,0,1,1],a=r[0]-n[0],i=r[1]-n[1],s=e._parent.normalizedDisplayToDisplay(a,i),f=Math.round(s[0]),o=Math.round(s[1]),u=r[2]-n[0],c=r[3]-n[1],g=e._parent.normalizedDisplayToDisplay(u,c),v=Math.round(g[0])-f,p=Math.round(g[1])-o;return v<0&&(v=0),p<0&&(p=0),{usize:v,vsize:p,lowerLeftU:f,lowerLeftV:o}},t.clear=function(){var r=0,n=e.context;if(!e.renderable.getTransparent()){var a=e.renderable.getBackgroundByReference();e.context.clearColor(a[0],a[1],a[2],a[3]),r|=n.COLOR_BUFFER_BIT}e.renderable.getPreserveDepthBuffer()||(n.clearDepth(1),r|=n.DEPTH_BUFFER_BIT,e.context.depthMask(!0)),n.colorMask(!0,!0,!0,!0);var i=t.getTiledSizeAndOrigin();n.enable(n.SCISSOR_TEST),n.scissor(i.lowerLeftU,i.lowerLeftV,i.usize,i.vsize),n.viewport(i.lowerLeftU,i.lowerLeftV,i.usize,i.vsize),r&&n.clear(r),n.enable(n.DEPTH_TEST)},t.releaseGraphicsResources=function(){e.selector!==null&&e.selector.releaseGraphicsResources()},t.setOpenGLRenderWindow=function(r){e._openGLRenderWindow!==r&&(t.releaseGraphicsResources(),e._openGLRenderWindow=r,e.context=null,r&&(e.context=e._openGLRenderWindow.getContext()))}}var bp={context:null,selector:null};function Lp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,bp,r),ie.extend(t,e,r),je(t,e,["shaderCache"]),we(t,e,["selector"]),qa(t,e,["openGLRenderWindow"]),Dp(t,e)}var Rp=ne(Lp,"vtkOpenGLRenderer");He("vtkRenderer",Rp);function Vp(t,e){e.classHierarchy.push("vtkOpenGLActor"),t.buildPass=function(r){if(r){e._openGLRenderWindow=t.getFirstAncestorOfType("vtkOpenGLRenderWindow"),e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e.context=e._openGLRenderWindow.getContext(),t.prepareNodes(),t.addMissingNodes(e.renderable.getTextures()),t.addMissingNode(e.renderable.getMapper()),t.removeUnusedNodes(),e.ogltextures=null,e.activeTextures=null;for(var n=0;n<e.children.length;n++){var a=e.children[n];a.isA("vtkOpenGLTexture")?(e.ogltextures||(e.ogltextures=[]),e.ogltextures.push(a)):e.oglmapper=a}}},t.traverseZBufferPass=function(r){!e.renderable||!e.renderable.getNestedVisibility()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(r,!0),e.oglmapper.traverse(r),t.apply(r,!1))},t.traverseOpaqueZBufferPass=function(r){return t.traverseOpaquePass(r)},t.traverseOpaquePass=function(r){!e.renderable||!e.renderable.getNestedVisibility()||!e.renderable.getIsOpaque()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(r,!0),e.oglmapper.traverse(r),t.apply(r,!1))},t.traverseTranslucentPass=function(r){!e.renderable||!e.renderable.getNestedVisibility()||e.renderable.getIsOpaque()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(r,!0),e.oglmapper.traverse(r),t.apply(r,!1))},t.activateTextures=function(){if(!!e.ogltextures){e.activeTextures=[];for(var r=0;r<e.ogltextures.length;r++){var n=e.ogltextures[r];n.render(),n.getHandle()&&e.activeTextures.push(n)}}},t.queryPass=function(r,n){if(r){if(!e.renderable||!e.renderable.getVisibility())return;e.renderable.getIsOpaque()?n.incrementOpaqueActorCount():n.incrementTranslucentActorCount()}},t.zBufferPass=function(r,n){return t.opaquePass(r,n)},t.opaqueZBufferPass=function(r,n){return t.opaquePass(r,n)},t.opaquePass=function(r,n){if(r)e.context.depthMask(!0),t.activateTextures();else if(e.activeTextures)for(var a=0;a<e.activeTextures.length;a++)e.activeTextures[a].deactivate()},t.translucentPass=function(r,n){if(r)e.context.depthMask(!1),t.activateTextures();else if(e.activeTextures)for(var a=0;a<e.activeTextures.length;a++)e.activeTextures[a].deactivate()},t.getKeyMatrices=function(){return e.renderable.getMTime()>e.keyMatrixTime.getMTime()&&(e.renderable.computeMatrix(),Qe(e.keyMatrices.mcwc,e.renderable.getMatrix()),Se(e.keyMatrices.mcwc,e.keyMatrices.mcwc),e.renderable.getIsIdentity()?$t(e.keyMatrices.normalMatrix):(Za(e.keyMatrices.normalMatrix,e.keyMatrices.mcwc),Ja(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix),Jo(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix)),e.keyMatrixTime.modified()),e.keyMatrices}}var kp={context:null,keyMatrixTime:null,keyMatrices:null,activeTextures:null};function Bp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,kp,r),ie.extend(t,e,r),e.keyMatrixTime={},be(e.keyMatrixTime,{mtime:0}),e.keyMatrices={normalMatrix:$t(new Float64Array(9)),mcwc:ge(new Float64Array(16))},we(t,e,["context"]),je(t,e,["activeTextures"]),Vp(t,e)}var Up=ne(Bp);He("vtkActor",Up);function Np(t,e){e.classHierarchy.push("vtkOpenGLActor2D"),t.buildPass=function(r){if(r){if(!e.renderable)return;e._openGLRenderWindow=t.getFirstAncestorOfType("vtkOpenGLRenderWindow"),e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e.context=e._openGLRenderWindow.getContext(),t.prepareNodes(),t.addMissingNodes(e.renderable.getTextures()),t.addMissingNode(e.renderable.getMapper()),t.removeUnusedNodes(),e.ogltextures=null,e.activeTextures=null;for(var n=0;n<e.children.length;n++){var a=e.children[n];a.isA("vtkOpenGLTexture")?(e.ogltextures||(e.ogltextures=[]),e.ogltextures.push(a)):e.oglmapper=a}}},t.queryPass=function(r,n){if(r){if(!e.renderable||!e.renderable.getVisibility())return;n.incrementOverlayActorCount()}},t.traverseOpaquePass=function(r){!e.oglmapper||!e.renderable||!e.renderable.getNestedVisibility()||!e.renderable.getIsOpaque()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(r,!0),e.oglmapper.traverse(r),t.apply(r,!1))},t.traverseTranslucentPass=function(r){!e.oglmapper||!e.renderable||!e.renderable.getNestedVisibility()||e.renderable.getIsOpaque()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(r,!0),e.oglmapper.traverse(r),t.apply(r,!1))},t.traverseOverlayPass=function(r){!e.oglmapper||!e.renderable||!e.renderable.getNestedVisibility()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable||(t.apply(r,!0),e.oglmapper.traverse(r),t.apply(r,!1))},t.activateTextures=function(){if(!!e.ogltextures){e.activeTextures=[];for(var r=0;r<e.ogltextures.length;r++){var n=e.ogltextures[r];n.render(),n.getHandle()&&e.activeTextures.push(n)}}},t.opaquePass=function(r,n){if(r)e.context.depthMask(!0),t.activateTextures();else if(e.activeTextures)for(var a=0;a<e.activeTextures.length;a++)e.activeTextures[a].deactivate()},t.translucentPass=function(r,n){if(r)e.context.depthMask(!1),t.activateTextures();else if(e.activeTextures)for(var a=0;a<e.activeTextures.length;a++)e.activeTextures[a].deactivate()},t.overlayPass=function(r,n){if(r)e.context.depthMask(!0),t.activateTextures();else if(e.activeTextures)for(var a=0;a<e.activeTextures.length;a++)e.activeTextures[a].deactivate()}}var Fp={context:null,activeTextures:null};function mp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Fp,r),ie.extend(t,e,r),we(t,e,["context"]),je(t,e,["activeTextures"]),Np(t,e)}var Gp=ne(mp);He("vtkActor2D",Gp);function Tn(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function _p(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Ef(t){let e,r,n;t.length!==2?(e=Tn,r=(f,o)=>Tn(t(f),o),n=(f,o)=>t(f)-o):(e=t===Tn||t===_p?t:Ap,r=t,n=t);function a(f,o,u=0,c=f.length){if(u<c){if(e(o,o)!==0)return c;do{const g=u+c>>>1;r(f[g],o)<0?u=g+1:c=g}while(u<c)}return u}function i(f,o,u=0,c=f.length){if(u<c){if(e(o,o)!==0)return c;do{const g=u+c>>>1;r(f[g],o)<=0?u=g+1:c=g}while(u<c)}return u}function s(f,o,u=0,c=f.length){const g=a(f,o,u,c-1);return g>u&&n(f[g-1],o)>-n(f[g],o)?g-1:g}return{left:a,center:s,right:i}}function Ap(){return 0}function $p(t){return t===null?NaN:+t}const Wp=Ef(Tn),zp=Wp.right;Ef($p).center;var jp=zp;const Hp=Math.sqrt(50),Pp=Math.sqrt(10),Kp=Math.sqrt(2);function En(t,e,r){const n=(e-t)/Math.max(0,r),a=Math.floor(Math.log10(n)),i=n/Math.pow(10,a),s=i>=Hp?10:i>=Pp?5:i>=Kp?2:1;let f,o,u;return a<0?(u=Math.pow(10,-a)/s,f=Math.round(t*u),o=Math.round(e*u),f/u<t&&++f,o/u>e&&--o,u=-u):(u=Math.pow(10,a)*s,f=Math.round(t/u),o=Math.round(e/u),f*u<t&&++f,o*u>e&&--o),o<f&&.5<=r&&r<2?En(t,e,r*2):[f,o,u]}function Xp(t,e,r){if(e=+e,t=+t,r=+r,!(r>0))return[];if(t===e)return[t];const n=e<t,[a,i,s]=n?En(e,t,r):En(t,e,r);if(!(i>=a))return[];const f=i-a+1,o=new Array(f);if(n)if(s<0)for(let u=0;u<f;++u)o[u]=(i-u)/-s;else for(let u=0;u<f;++u)o[u]=(i-u)*s;else if(s<0)for(let u=0;u<f;++u)o[u]=(a+u)/-s;else for(let u=0;u<f;++u)o[u]=(a+u)*s;return o}function Va(t,e,r){return e=+e,t=+t,r=+r,En(t,e,r)[2]}function Yp(t,e,r){e=+e,t=+t,r=+r;const n=e<t,a=n?Va(e,t,r):Va(t,e,r);return(n?-1:1)*(a<0?1/-a:a)}function Ip(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function ti(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function Mf(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function Ur(){}var Mr=.7,Mn=1/Mr,Jt="\\s*([+-]?\\d+)\\s*",Dr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ie="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Qp=/^#([0-9a-f]{3,8})$/,qp=new RegExp(`^rgb\\(${Jt},${Jt},${Jt}\\)$`),Zp=new RegExp(`^rgb\\(${Ie},${Ie},${Ie}\\)$`),Jp=new RegExp(`^rgba\\(${Jt},${Jt},${Jt},${Dr}\\)$`),el=new RegExp(`^rgba\\(${Ie},${Ie},${Ie},${Dr}\\)$`),tl=new RegExp(`^hsl\\(${Dr},${Ie},${Ie}\\)$`),rl=new RegExp(`^hsla\\(${Dr},${Ie},${Ie},${Dr}\\)$`),Qi={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ti(Ur,br,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:qi,formatHex:qi,formatHex8:nl,formatHsl:al,formatRgb:Zi,toString:Zi});function qi(){return this.rgb().formatHex()}function nl(){return this.rgb().formatHex8()}function al(){return Df(this).formatHsl()}function Zi(){return this.rgb().formatRgb()}function br(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=Qp.exec(t))?(r=e[1].length,e=parseInt(e[1],16),r===6?Ji(e):r===3?new Me(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):r===8?Xr(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):r===4?Xr(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=qp.exec(t))?new Me(e[1],e[2],e[3],1):(e=Zp.exec(t))?new Me(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Jp.exec(t))?Xr(e[1],e[2],e[3],e[4]):(e=el.exec(t))?Xr(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=tl.exec(t))?rs(e[1],e[2]/100,e[3]/100,1):(e=rl.exec(t))?rs(e[1],e[2]/100,e[3]/100,e[4]):Qi.hasOwnProperty(t)?Ji(Qi[t]):t==="transparent"?new Me(NaN,NaN,NaN,0):null}function Ji(t){return new Me(t>>16&255,t>>8&255,t&255,1)}function Xr(t,e,r,n){return n<=0&&(t=e=r=NaN),new Me(t,e,r,n)}function il(t){return t instanceof Ur||(t=br(t)),t?(t=t.rgb(),new Me(t.r,t.g,t.b,t.opacity)):new Me}function ka(t,e,r,n){return arguments.length===1?il(t):new Me(t,e,r,n==null?1:n)}function Me(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}ti(Me,ka,Mf(Ur,{brighter(t){return t=t==null?Mn:Math.pow(Mn,t),new Me(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Mr:Math.pow(Mr,t),new Me(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Me(Ft(this.r),Ft(this.g),Ft(this.b),Dn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:es,formatHex:es,formatHex8:sl,formatRgb:ts,toString:ts}));function es(){return`#${kt(this.r)}${kt(this.g)}${kt(this.b)}`}function sl(){return`#${kt(this.r)}${kt(this.g)}${kt(this.b)}${kt((isNaN(this.opacity)?1:this.opacity)*255)}`}function ts(){const t=Dn(this.opacity);return`${t===1?"rgb(":"rgba("}${Ft(this.r)}, ${Ft(this.g)}, ${Ft(this.b)}${t===1?")":`, ${t})`}`}function Dn(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Ft(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function kt(t){return t=Ft(t),(t<16?"0":"")+t.toString(16)}function rs(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new We(t,e,r,n)}function Df(t){if(t instanceof We)return new We(t.h,t.s,t.l,t.opacity);if(t instanceof Ur||(t=br(t)),!t)return new We;if(t instanceof We)return t;t=t.rgb();var e=t.r/255,r=t.g/255,n=t.b/255,a=Math.min(e,r,n),i=Math.max(e,r,n),s=NaN,f=i-a,o=(i+a)/2;return f?(e===i?s=(r-n)/f+(r<n)*6:r===i?s=(n-e)/f+2:s=(e-r)/f+4,f/=o<.5?i+a:2-i-a,s*=60):f=o>0&&o<1?0:s,new We(s,f,o,t.opacity)}function ol(t,e,r,n){return arguments.length===1?Df(t):new We(t,e,r,n==null?1:n)}function We(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}ti(We,ol,Mf(Ur,{brighter(t){return t=t==null?Mn:Math.pow(Mn,t),new We(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Mr:Math.pow(Mr,t),new We(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,a=2*r-n;return new Me(ea(t>=240?t-240:t+120,a,n),ea(t,a,n),ea(t<120?t+240:t-120,a,n),this.opacity)},clamp(){return new We(ns(this.h),Yr(this.s),Yr(this.l),Dn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Dn(this.opacity);return`${t===1?"hsl(":"hsla("}${ns(this.h)}, ${Yr(this.s)*100}%, ${Yr(this.l)*100}%${t===1?")":`, ${t})`}`}}));function ns(t){return t=(t||0)%360,t<0?t+360:t}function Yr(t){return Math.max(0,Math.min(1,t||0))}function ea(t,e,r){return(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)*255}var ri=t=>()=>t;function fl(t,e){return function(r){return t+r*e}}function ul(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}function cl(t){return(t=+t)==1?bf:function(e,r){return r-e?ul(e,r,t):ri(isNaN(e)?r:e)}}function bf(t,e){var r=e-t;return r?fl(t,r):ri(isNaN(t)?e:t)}var as=function t(e){var r=cl(e);function n(a,i){var s=r((a=ka(a)).r,(i=ka(i)).r),f=r(a.g,i.g),o=r(a.b,i.b),u=bf(a.opacity,i.opacity);return function(c){return a.r=s(c),a.g=f(c),a.b=o(c),a.opacity=u(c),a+""}}return n.gamma=t,n}(1);function gl(t,e){e||(e=[]);var r=t?Math.min(e.length,t.length):0,n=e.slice(),a;return function(i){for(a=0;a<r;++a)n[a]=t[a]*(1-i)+e[a]*i;return n}}function vl(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function pl(t,e){var r=e?e.length:0,n=t?Math.min(r,t.length):0,a=new Array(n),i=new Array(r),s;for(s=0;s<n;++s)a[s]=ni(t[s],e[s]);for(;s<r;++s)i[s]=e[s];return function(f){for(s=0;s<n;++s)i[s]=a[s](f);return i}}function ll(t,e){var r=new Date;return t=+t,e=+e,function(n){return r.setTime(t*(1-n)+e*n),r}}function bn(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}function hl(t,e){var r={},n={},a;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(a in e)a in t?r[a]=ni(t[a],e[a]):n[a]=e[a];return function(i){for(a in r)n[a]=r[a](i);return n}}var Ba=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ta=new RegExp(Ba.source,"g");function yl(t){return function(){return t}}function Tl(t){return function(e){return t(e)+""}}function xl(t,e){var r=Ba.lastIndex=ta.lastIndex=0,n,a,i,s=-1,f=[],o=[];for(t=t+"",e=e+"";(n=Ba.exec(t))&&(a=ta.exec(e));)(i=a.index)>r&&(i=e.slice(r,i),f[s]?f[s]+=i:f[++s]=i),(n=n[0])===(a=a[0])?f[s]?f[s]+=a:f[++s]=a:(f[++s]=null,o.push({i:s,x:bn(n,a)})),r=ta.lastIndex;return r<e.length&&(i=e.slice(r),f[s]?f[s]+=i:f[++s]=i),f.length<2?o[0]?Tl(o[0].x):yl(e):(e=o.length,function(u){for(var c=0,g;c<e;++c)f[(g=o[c]).i]=g.x(u);return f.join("")})}function ni(t,e){var r=typeof e,n;return e==null||r==="boolean"?ri(e):(r==="number"?bn:r==="string"?(n=br(e))?(e=n,as):xl:e instanceof br?as:e instanceof Date?ll:vl(e)?gl:Array.isArray(e)?pl:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?hl:bn)(t,e)}function dl(t,e){return t=+t,e=+e,function(r){return Math.round(t*(1-r)+e*r)}}function Ol(t){return function(){return t}}function Sl(t){return+t}var is=[0,1];function It(t){return t}function Ua(t,e){return(e-=t=+t)?function(r){return(r-t)/e}:Ol(isNaN(e)?NaN:.5)}function Cl(t,e){var r;return t>e&&(r=t,t=e,e=r),function(n){return Math.max(t,Math.min(e,n))}}function wl(t,e,r){var n=t[0],a=t[1],i=e[0],s=e[1];return a<n?(n=Ua(a,n),i=r(s,i)):(n=Ua(n,a),i=r(i,s)),function(f){return i(n(f))}}function El(t,e,r){var n=Math.min(t.length,e.length)-1,a=new Array(n),i=new Array(n),s=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<n;)a[s]=Ua(t[s],t[s+1]),i[s]=r(e[s],e[s+1]);return function(f){var o=jp(t,f,1,n)-1;return i[o](a[o](f))}}function Ml(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Dl(){var t=is,e=is,r=ni,n,a,i,s=It,f,o,u;function c(){var v=Math.min(t.length,e.length);return s!==It&&(s=Cl(t[0],t[v-1])),f=v>2?El:wl,o=u=null,g}function g(v){return v==null||isNaN(v=+v)?i:(o||(o=f(t.map(n),e,r)))(n(s(v)))}return g.invert=function(v){return s(a((u||(u=f(e,t.map(n),bn)))(v)))},g.domain=function(v){return arguments.length?(t=Array.from(v,Sl),c()):t.slice()},g.range=function(v){return arguments.length?(e=Array.from(v),c()):e.slice()},g.rangeRound=function(v){return e=Array.from(v),r=dl,c()},g.clamp=function(v){return arguments.length?(s=v?!0:It,c()):s!==It},g.interpolate=function(v){return arguments.length?(r=v,c()):r},g.unknown=function(v){return arguments.length?(i=v,g):i},function(v,p){return n=v,a=p,c()}}function bl(){return Dl()(It,It)}function Ll(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function Ln(t,e){if((r=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var r,n=t.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+t.slice(r+1)]}function tr(t){return t=Ln(Math.abs(t)),t?t[1]:NaN}function Rl(t,e){return function(r,n){for(var a=r.length,i=[],s=0,f=t[0],o=0;a>0&&f>0&&(o+f+1>n&&(f=Math.max(1,n-o)),i.push(r.substring(a-=f,a+f)),!((o+=f+1)>n));)f=t[s=(s+1)%t.length];return i.reverse().join(e)}}function Vl(t){return function(e){return e.replace(/[0-9]/g,function(r){return t[+r]})}}var kl=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Rn(t){if(!(e=kl.exec(t)))throw new Error("invalid format: "+t);var e;return new ai({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}Rn.prototype=ai.prototype;function ai(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}ai.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Bl(t){e:for(var e=t.length,r=1,n=-1,a;r<e;++r)switch(t[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+t[r])break e;n>0&&(n=0);break}return n>0?t.slice(0,n)+t.slice(a+1):t}var Lf;function Ul(t,e){var r=Ln(t,e);if(!r)return t+"";var n=r[0],a=r[1],i=a-(Lf=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,s=n.length;return i===s?n:i>s?n+new Array(i-s+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+Ln(t,Math.max(0,e+i-1))[0]}function ss(t,e){var r=Ln(t,e);if(!r)return t+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}var os={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:Ll,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>ss(t*100,e),r:ss,s:Ul,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function fs(t){return t}var us=Array.prototype.map,cs=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function Nl(t){var e=t.grouping===void 0||t.thousands===void 0?fs:Rl(us.call(t.grouping,Number),t.thousands+""),r=t.currency===void 0?"":t.currency[0]+"",n=t.currency===void 0?"":t.currency[1]+"",a=t.decimal===void 0?".":t.decimal+"",i=t.numerals===void 0?fs:Vl(us.call(t.numerals,String)),s=t.percent===void 0?"%":t.percent+"",f=t.minus===void 0?"\u2212":t.minus+"",o=t.nan===void 0?"NaN":t.nan+"";function u(g){g=Rn(g);var v=g.fill,p=g.align,l=g.sign,y=g.symbol,h=g.zero,T=g.width,x=g.comma,S=g.precision,O=g.trim,C=g.type;C==="n"?(x=!0,C="g"):os[C]||(S===void 0&&(S=12),O=!0,C="g"),(h||v==="0"&&p==="=")&&(h=!0,v="0",p="=");var w=y==="$"?r:y==="#"&&/[boxX]/.test(C)?"0"+C.toLowerCase():"",E=y==="$"?n:/[%p]/.test(C)?s:"",M=os[C],L=/[defgprs%]/.test(C);S=S===void 0?6:/[gprs]/.test(C)?Math.max(1,Math.min(21,S)):Math.max(0,Math.min(20,S));function b(D){var V=w,B=E,R,N,U;if(C==="c")B=M(D)+B,D="";else{D=+D;var G=D<0||1/D<0;if(D=isNaN(D)?o:M(Math.abs(D),S),O&&(D=Bl(D)),G&&+D==0&&l!=="+"&&(G=!1),V=(G?l==="("?l:f:l==="-"||l==="("?"":l)+V,B=(C==="s"?cs[8+Lf/3]:"")+B+(G&&l==="("?")":""),L){for(R=-1,N=D.length;++R<N;)if(U=D.charCodeAt(R),48>U||U>57){B=(U===46?a+D.slice(R+1):D.slice(R))+B,D=D.slice(0,R);break}}}x&&!h&&(D=e(D,1/0));var m=V.length+D.length+B.length,F=m<T?new Array(T-m+1).join(v):"";switch(x&&h&&(D=e(F+D,F.length?T-B.length:1/0),F=""),p){case"<":D=V+D+B+F;break;case"=":D=V+F+D+B;break;case"^":D=F.slice(0,m=F.length>>1)+V+D+B+F.slice(m);break;default:D=F+V+D+B;break}return i(D)}return b.toString=function(){return g+""},b}function c(g,v){var p=u((g=Rn(g),g.type="f",g)),l=Math.max(-8,Math.min(8,Math.floor(tr(v)/3)))*3,y=Math.pow(10,-l),h=cs[8+l/3];return function(T){return p(y*T)+h}}return{format:u,formatPrefix:c}}var Ir,Rf,Vf;Fl({thousands:",",grouping:[3],currency:["$",""]});function Fl(t){return Ir=Nl(t),Rf=Ir.format,Vf=Ir.formatPrefix,Ir}function ml(t){return Math.max(0,-tr(Math.abs(t)))}function Gl(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(tr(e)/3)))*3-tr(Math.abs(t)))}function _l(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,tr(e)-tr(t))+1}function Al(t,e,r,n){var a=Yp(t,e,r),i;switch(n=Rn(n==null?",f":n),n.type){case"s":{var s=Math.max(Math.abs(t),Math.abs(e));return n.precision==null&&!isNaN(i=Gl(a,s))&&(n.precision=i),Vf(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=_l(a,Math.max(Math.abs(t),Math.abs(e))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=ml(a))&&(n.precision=i-(n.type==="%")*2);break}}return Rf(n)}function $l(t){var e=t.domain;return t.ticks=function(r){var n=e();return Xp(n[0],n[n.length-1],r==null?10:r)},t.tickFormat=function(r,n){var a=e();return Al(a[0],a[a.length-1],r==null?10:r,n)},t.nice=function(r){r==null&&(r=10);var n=e(),a=0,i=n.length-1,s=n[a],f=n[i],o,u,c=10;for(f<s&&(u=s,s=f,f=u,u=a,a=i,i=u);c-- >0;){if(u=Va(s,f,r),u===o)return n[a]=s,n[i]=f,e(n);if(u>0)s=Math.floor(s/u)*u,f=Math.ceil(f/u)*u;else if(u<0)s=Math.ceil(s*u)/u,f=Math.floor(f*u)/u;else break;o=u}return t},t}function ii(){var t=bl();return t.copy=function(){return Ml(t,ii())},Ip.apply(t,arguments),$l(t)}var kf={exports:{}};(function(t){(function(e,r,n){function a(o){var u=this,c=f();u.next=function(){var g=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=g-(u.c=g|0)},u.c=1,u.s0=c(" "),u.s1=c(" "),u.s2=c(" "),u.s0-=c(o),u.s0<0&&(u.s0+=1),u.s1-=c(o),u.s1<0&&(u.s1+=1),u.s2-=c(o),u.s2<0&&(u.s2+=1),c=null}function i(o,u){return u.c=o.c,u.s0=o.s0,u.s1=o.s1,u.s2=o.s2,u}function s(o,u){var c=new a(o),g=u&&u.state,v=c.next;return v.int32=function(){return c.next()*4294967296|0},v.double=function(){return v()+(v()*2097152|0)*11102230246251565e-32},v.quick=v,g&&(typeof g=="object"&&i(g,c),v.state=function(){return i(c,{})}),v}function f(){var o=4022871197,u=function(c){c=String(c);for(var g=0;g<c.length;g++){o+=c.charCodeAt(g);var v=.02519603282416938*o;o=v>>>0,v-=o,v*=o,o=v>>>0,v-=o,o+=v*4294967296}return(o>>>0)*23283064365386963e-26};return u}r&&r.exports?r.exports=s:n&&n.amd?n(function(){return s}):this.alea=s})(Ne,t,!1)})(kf);var Bf={exports:{}};(function(t){(function(e,r,n){function a(f){var o=this,u="";o.x=0,o.y=0,o.z=0,o.w=0,o.next=function(){var g=o.x^o.x<<11;return o.x=o.y,o.y=o.z,o.z=o.w,o.w^=o.w>>>19^g^g>>>8},f===(f|0)?o.x=f:u+=f;for(var c=0;c<u.length+64;c++)o.x^=u.charCodeAt(c)|0,o.next()}function i(f,o){return o.x=f.x,o.y=f.y,o.z=f.z,o.w=f.w,o}function s(f,o){var u=new a(f),c=o&&o.state,g=function(){return(u.next()>>>0)/4294967296};return g.double=function(){do var v=u.next()>>>11,p=(u.next()>>>0)/4294967296,l=(v+p)/(1<<21);while(l===0);return l},g.int32=u.next,g.quick=g,c&&(typeof c=="object"&&i(c,u),g.state=function(){return i(u,{})}),g}r&&r.exports?r.exports=s:n&&n.amd?n(function(){return s}):this.xor128=s})(Ne,t,!1)})(Bf);var Uf={exports:{}};(function(t){(function(e,r,n){function a(f){var o=this,u="";o.next=function(){var g=o.x^o.x>>>2;return o.x=o.y,o.y=o.z,o.z=o.w,o.w=o.v,(o.d=o.d+362437|0)+(o.v=o.v^o.v<<4^(g^g<<1))|0},o.x=0,o.y=0,o.z=0,o.w=0,o.v=0,f===(f|0)?o.x=f:u+=f;for(var c=0;c<u.length+64;c++)o.x^=u.charCodeAt(c)|0,c==u.length&&(o.d=o.x<<10^o.x>>>4),o.next()}function i(f,o){return o.x=f.x,o.y=f.y,o.z=f.z,o.w=f.w,o.v=f.v,o.d=f.d,o}function s(f,o){var u=new a(f),c=o&&o.state,g=function(){return(u.next()>>>0)/4294967296};return g.double=function(){do var v=u.next()>>>11,p=(u.next()>>>0)/4294967296,l=(v+p)/(1<<21);while(l===0);return l},g.int32=u.next,g.quick=g,c&&(typeof c=="object"&&i(c,u),g.state=function(){return i(u,{})}),g}r&&r.exports?r.exports=s:n&&n.amd?n(function(){return s}):this.xorwow=s})(Ne,t,!1)})(Uf);var Nf={exports:{}};(function(t){(function(e,r,n){function a(f){var o=this;o.next=function(){var c=o.x,g=o.i,v,p;return v=c[g],v^=v>>>7,p=v^v<<24,v=c[g+1&7],p^=v^v>>>10,v=c[g+3&7],p^=v^v>>>3,v=c[g+4&7],p^=v^v<<7,v=c[g+7&7],v=v^v<<13,p^=v^v<<9,c[g]=p,o.i=g+1&7,p};function u(c,g){var v,p=[];if(g===(g|0))p[0]=g;else for(g=""+g,v=0;v<g.length;++v)p[v&7]=p[v&7]<<15^g.charCodeAt(v)+p[v+1&7]<<13;for(;p.length<8;)p.push(0);for(v=0;v<8&&p[v]===0;++v);for(v==8?p[7]=-1:p[v],c.x=p,c.i=0,v=256;v>0;--v)c.next()}u(o,f)}function i(f,o){return o.x=f.x.slice(),o.i=f.i,o}function s(f,o){f==null&&(f=+new Date);var u=new a(f),c=o&&o.state,g=function(){return(u.next()>>>0)/4294967296};return g.double=function(){do var v=u.next()>>>11,p=(u.next()>>>0)/4294967296,l=(v+p)/(1<<21);while(l===0);return l},g.int32=u.next,g.quick=g,c&&(c.x&&i(c,u),g.state=function(){return i(u,{})}),g}r&&r.exports?r.exports=s:n&&n.amd?n(function(){return s}):this.xorshift7=s})(Ne,t,!1)})(Nf);var Ff={exports:{}};(function(t){(function(e,r,n){function a(f){var o=this;o.next=function(){var c=o.w,g=o.X,v=o.i,p,l;return o.w=c=c+1640531527|0,l=g[v+34&127],p=g[v=v+1&127],l^=l<<13,p^=p<<17,l^=l>>>15,p^=p>>>12,l=g[v]=l^p,o.i=v,l+(c^c>>>16)|0};function u(c,g){var v,p,l,y,h,T=[],x=128;for(g===(g|0)?(p=g,g=null):(g=g+"\0",p=0,x=Math.max(x,g.length)),l=0,y=-32;y<x;++y)g&&(p^=g.charCodeAt((y+32)%g.length)),y===0&&(h=p),p^=p<<10,p^=p>>>15,p^=p<<4,p^=p>>>13,y>=0&&(h=h+1640531527|0,v=T[y&127]^=p+h,l=v==0?l+1:0);for(l>=128&&(T[(g&&g.length||0)&127]=-1),l=127,y=4*128;y>0;--y)p=T[l+34&127],v=T[l=l+1&127],p^=p<<13,v^=v<<17,p^=p>>>15,v^=v>>>12,T[l]=p^v;c.w=h,c.X=T,c.i=l}u(o,f)}function i(f,o){return o.i=f.i,o.w=f.w,o.X=f.X.slice(),o}function s(f,o){f==null&&(f=+new Date);var u=new a(f),c=o&&o.state,g=function(){return(u.next()>>>0)/4294967296};return g.double=function(){do var v=u.next()>>>11,p=(u.next()>>>0)/4294967296,l=(v+p)/(1<<21);while(l===0);return l},g.int32=u.next,g.quick=g,c&&(c.X&&i(c,u),g.state=function(){return i(u,{})}),g}r&&r.exports?r.exports=s:n&&n.amd?n(function(){return s}):this.xor4096=s})(Ne,t,!1)})(Ff);var mf={exports:{}};(function(t){(function(e,r,n){function a(f){var o=this,u="";o.next=function(){var g=o.b,v=o.c,p=o.d,l=o.a;return g=g<<25^g>>>7^v,v=v-p|0,p=p<<24^p>>>8^l,l=l-g|0,o.b=g=g<<20^g>>>12^v,o.c=v=v-p|0,o.d=p<<16^v>>>16^l,o.a=l-g|0},o.a=0,o.b=0,o.c=-1640531527,o.d=1367130551,f===Math.floor(f)?(o.a=f/4294967296|0,o.b=f|0):u+=f;for(var c=0;c<u.length+20;c++)o.b^=u.charCodeAt(c)|0,o.next()}function i(f,o){return o.a=f.a,o.b=f.b,o.c=f.c,o.d=f.d,o}function s(f,o){var u=new a(f),c=o&&o.state,g=function(){return(u.next()>>>0)/4294967296};return g.double=function(){do var v=u.next()>>>11,p=(u.next()>>>0)/4294967296,l=(v+p)/(1<<21);while(l===0);return l},g.int32=u.next,g.quick=g,c&&(typeof c=="object"&&i(c,u),g.state=function(){return i(u,{})}),g}r&&r.exports?r.exports=s:n&&n.amd?n(function(){return s}):this.tychei=s})(Ne,t,!1)})(mf);var Gf={exports:{}};(function(t){(function(e,r,n){var a=256,i=6,s=52,f="random",o=n.pow(a,i),u=n.pow(2,s),c=u*2,g=a-1,v;function p(O,C,w){var E=[];C=C==!0?{entropy:!0}:C||{};var M=T(h(C.entropy?[O,S(r)]:O==null?x():O,3),E),L=new l(E),b=function(){for(var D=L.g(i),V=o,B=0;D<u;)D=(D+B)*a,V*=a,B=L.g(1);for(;D>=c;)D/=2,V/=2,B>>>=1;return(D+B)/V};return b.int32=function(){return L.g(4)|0},b.quick=function(){return L.g(4)/4294967296},b.double=b,T(S(L.S),r),(C.pass||w||function(D,V,B,R){return R&&(R.S&&y(R,L),D.state=function(){return y(L,{})}),B?(n[f]=D,V):D})(b,M,"global"in C?C.global:this==n,C.state)}function l(O){var C,w=O.length,E=this,M=0,L=E.i=E.j=0,b=E.S=[];for(w||(O=[w++]);M<a;)b[M]=M++;for(M=0;M<a;M++)b[M]=b[L=g&L+O[M%w]+(C=b[M])],b[L]=C;(E.g=function(D){for(var V,B=0,R=E.i,N=E.j,U=E.S;D--;)V=U[R=g&R+1],B=B*a+U[g&(U[R]=U[N=g&N+V])+(U[N]=V)];return E.i=R,E.j=N,B})(a)}function y(O,C){return C.i=O.i,C.j=O.j,C.S=O.S.slice(),C}function h(O,C){var w=[],E=typeof O,M;if(C&&E=="object")for(M in O)try{w.push(h(O[M],C-1))}catch{}return w.length?w:E=="string"?O:O+"\0"}function T(O,C){for(var w=O+"",E,M=0;M<w.length;)C[g&M]=g&(E^=C[g&M]*19)+w.charCodeAt(M++);return S(C)}function x(){try{var O;return v&&(O=v.randomBytes)?O=O(a):(O=new Uint8Array(a),(e.crypto||e.msCrypto).getRandomValues(O)),S(O)}catch{var C=e.navigator,w=C&&C.plugins;return[+new Date,e,w,e.screen,S(r)]}}function S(O){return String.fromCharCode.apply(0,O)}if(T(n.random(),r),t.exports){t.exports=p;try{v=require("crypto")}catch{}}else n["seed"+f]=p})(typeof self!="undefined"?self:Ne,[],Math)})(Gf);var Wl=kf.exports,zl=Bf.exports,jl=Uf.exports,Hl=Nf.exports,Pl=Ff.exports,Kl=mf.exports,sr=Gf.exports;sr.alea=Wl;sr.xor128=zl;sr.xorwow=jl;sr.xorshift7=Hl;sr.xor4096=Pl;sr.tychei=Kl;var Xl=1e-6,Yl=1e-12,gs=d.vtkWarningMacro;function Na(){for(var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:3,e=Array(t),r=0;r<t;++r)e[r]=0;return e}function Qt(t){return t/180*Math.PI}function Il(t){return t*180/Math.PI}var Qr=Math.round;function $e(t){for(var e=1;e<t;)e*=2;return e}function qr(t){return t===$e(t)}function Ql(t,e,r){return r[0]=t[0]+e[0],r[1]=t[1]+e[1],r[2]=t[2]+e[2],r}function yt(t,e,r){return r[0]=t[0]-e[0],r[1]=t[1]-e[1],r[2]=t[2]-e[2],r}function vs(t,e,r,n){return n[0]=t[0]+e[0]*r,n[1]=t[1]+e[1]*r,n[2]=t[2]+e[2]*r,n}function j(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function si(t,e,r){var n=t[1]*e[2]-t[2]*e[1],a=t[2]*e[0]-t[0]*e[2],i=t[0]*e[1]-t[1]*e[0];return r[0]=n,r[1]=a,r[2]=i,r}function _f(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3;switch(e){case 1:return Math.abs(t);case 2:return Math.sqrt(t[0]*t[0]+t[1]*t[1]);case 3:return Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);default:{for(var r=0,n=0;n<e;n++)r+=t[n]*t[n];return Math.sqrt(r)}}}function Vn(t){var e=_f(t);return e!==0&&(t[0]/=e,t[1]/=e,t[2]/=e),e}function Je(t,e){return(t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])+(t[2]-e[2])*(t[2]-e[2])}function ql(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Zl(t){var e=ql(t);return e!==0&&(t[0]/=e,t[1]/=e),e}function xn(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return e.length===2?e[0][0]*e[1][1]-e[1][0]*e[0][1]:e.length===4?e[0]*e[3]-e[1]*e[2]:Number.NaN}function Jl(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Xl;if(t.length!==e.length)return!1;function n(a,i){return Math.abs(a-e[i])<=r}return t.every(n)}var eh=Jl;function ra(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(!"".concat(t).includes("e"))return+"".concat(Math.round("".concat(t,"e+").concat(e)),"e-").concat(e);var r="".concat(t).split("e"),n="";return+r[1]+e>0&&(n="+"),+"".concat(Math.round("".concat(+r[0],"e").concat(n).concat(+r[1]+e)),"e-").concat(e)}function ps(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return e[0]=ra(t[0],r),e[1]=ra(t[1],r),e[2]=ra(t[2],r),e}function th(t,e,r){var n,a,i,s,f=0,o,u,c,g=Na(r);for(n=0;n<r;n++){for(s=0,a=0;a<r;a++)(c=Math.abs(t[n*r+a]))>s&&(s=c);if(s===0)return gs("Unable to factor linear system"),0;g[n]=1/s}for(a=0;a<r;a++){for(n=0;n<a;n++){for(o=t[n*r+a],i=0;i<n;i++)o-=t[n*r+i]*t[i*r+a];t[n*r+a]=o}for(s=0,n=a;n<r;n++){for(o=t[n*r+a],i=0;i<a;i++)o-=t[n*r+i]*t[i*r+a];t[n*r+a]=o,(u=g[n]*Math.abs(o))>=s&&(s=u,f=n)}if(a!==f){for(i=0;i<r;i++)u=t[f*r+i],t[f*r+i]=t[a*r+i],t[a*r+i]=u;g[f]=g[a]}if(e[a]=f,Math.abs(t[a*r+a])<=Yl)return gs("Unable to factor linear system"),0;if(a!==r-1)for(u=1/t[a*r+a],n=a+1;n<r;n++)t[n*r+a]*=u}return 1}function rh(t,e,r,n){var a,i,s,f,o;for(s=-1,a=0;a<n;a++){if(f=e[a],o=r[f],r[f]=r[a],s>=0)for(i=s;i<=a-1;i++)o-=t[a*n+i]*r[i];else o!==0&&(s=a);r[a]=o}for(a=n-1;a>=0;a--){for(o=r[a],i=a+1;i<n;i++)o-=t[a*n+i]*r[i];r[a]=o/t[a*n+a]}}function nh(t,e,r){if(r===2){var n=Na(2),a=xn(t[0],t[1],t[2],t[3]);return a===0?0:(n[0]=(t[3]*e[0]-t[1]*e[1])/a,n[1]=(-(t[2]*e[0])+t[0]*e[1])/a,e[0]=n[0],e[1]=n[1],1)}if(r===1)return t[0]===0?0:(e[0]/=t[0],1);var i=Na(r);return th(t,i,r)===0?0:(rh(t,i,e,r),1)}function ah(t,e){var r=Ye(t,3),n=r[0],a=r[1],i=r[2],s=1/3,f=1/6,o=2/3,u=5/6,c,g,v;n>f&&n<=s?(g=1,c=(s-n)/f,v=0):n>s&&n<=.5?(g=1,v=(n-s)/f,c=0):n>.5&&n<=o?(v=1,g=(o-n)/f,c=0):n>o&&n<=u?(v=1,c=(n-o)/f,g=0):n>u&&n<=1?(c=1,v=(1-n)/f,g=0):(c=1,g=n/f,v=0),c=a*c+(1-a),g=a*g+(1-a),v=a*v+(1-a),c*=i,g*=i,v*=i,e[0]=c,e[1]=g,e[2]=v}function oi(t){return t[0]=1,t[1]=-1,t[2]=1,t[3]=-1,t[4]=1,t[5]=-1,t}function na(t,e,r){return t<e?e:t>r?r:t}function ls(t,e,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[0,0,0];return n[0]=na(t[0],e[0],r[0]),n[1]=na(t[1],e[1],r[1]),n[2]=na(t[2],e[2],r[2]),n}var ih=Number.isNaN,Af=ih;function sh(){return[].concat([Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE])}function hs(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function oh(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?hs(Object(r),!0).forEach(function(n){K(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):hs(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var Fa=1e-6,$f="coincide",Wf="disjoint";function fh(t,e,r){return t[0]*(r[0]-e[0])+t[1]*(r[1]-e[1])+t[2]*(r[2]-e[2])}function zf(t,e,r){var n=r[0]*(t[0]-e[0])+r[1]*(t[1]-e[1])+r[2]*(t[2]-e[2]);return Math.abs(n)}function jf(t,e,r,n){var a=[];yt(t,e,a);var i=j(r,a);n[0]=t[0]-i*r[0],n[1]=t[1]-i*r[1],n[2]=t[2]-i*r[2]}function Hf(t,e,r){var n=j(t,e),a=j(e,e);return a===0&&(a=1),r[0]=t[0]-n*e[0]/a,r[1]=t[1]-n*e[1]/a,r[2]=t[2]-n*e[2]/a,r}function Pf(t,e,r,n){var a=[];yt(t,e,a);var i=j(r,a),s=j(r,r);s!==0?(n[0]=t[0]-i*r[0]/s,n[1]=t[1]-i*r[1]/s,n[2]=t[2]-i*r[2]/s):(n[0]=t[0],n[1]=t[1],n[2]=t[2])}function Kf(t,e,r,n){var a={intersection:!1,betweenPoints:!1,t:Number.MAX_VALUE,x:[]},i=[],s=[];yt(e,t,i),yt(r,t,s);var f=j(n,s),o=j(n,i),u,c;return o<0?u=-o:u=o,f<0?c=-f*Fa:c=f*Fa,u<=c||(a.t=f/o,a.x[0]=t[0]+a.t*i[0],a.x[1]=t[1]+a.t*i[1],a.x[2]=t[2]+a.t*i[2],a.intersection=!0,a.betweenPoints=a.t>=0&&a.t<=1),a}function Xf(t,e,r,n){var a={intersection:!1,l0:[],l1:[],error:null},i=[];si(e,n,i);var s=i.map(function(v){return Math.abs(v)});if(s[0]+s[1]+s[2]<Fa){var f=[];return yt(t,r,f),j(e,f)===0?a.error=$f:a.error=Wf,a}var o;s[0]>s[1]&&s[0]>s[2]?o="x":s[1]>s[2]?o="y":o="z";var u=[],c=-j(e,t),g=-j(n,r);switch(o){case"x":u[0]=0,u[1]=(g*e[2]-c*n[2])/i[0],u[2]=(c*n[1]-g*e[1])/i[0];break;case"y":u[0]=(c*n[2]-g*e[2])/i[1],u[1]=0,u[2]=(g*e[0]-c*n[0])/i[1];break;case"z":u[0]=(g*e[1]-c*n[1])/i[2],u[1]=(c*n[0]-g*e[0])/i[2],u[2]=0;break}return a.l0=u,Ql(u,i,a.l1),a.intersection=!0,a}var uh={evaluate:fh,distanceToPlane:zf,projectPoint:jf,projectVector:Hf,generalizedProjectPoint:Pf,intersectWithLine:Kf,intersectWithPlane:Xf,DISJOINT:Wf,COINCIDE:$f};function ch(t,e){e.classHierarchy.push("vtkPlane"),t.distanceToPlane=function(r){return zf(r,e.origin,e.normal)},t.projectPoint=function(r,n){jf(r,e.origin,e.normal,n)},t.projectVector=function(r,n){return Hf(r,e.normal,n)},t.push=function(r){if(r!==0)for(var n=0;n<3;n++)e.origin[n]+=r*e.normal[n]},t.generalizedProjectPoint=function(r,n){Pf(r,e.origin,e.normal,n)},t.evaluateFunction=function(r,n,a){return Array.isArray(r)?e.normal[0]*(r[0]-e.origin[0])+e.normal[1]*(r[1]-e.origin[1])+e.normal[2]*(r[2]-e.origin[2]):e.normal[0]*(r-e.origin[0])+e.normal[1]*(n-e.origin[1])+e.normal[2]*(a-e.origin[2])},t.evaluateGradient=function(r){var n=[e.normal[0],e.normal[1],e.normal[2]];return n},t.intersectWithLine=function(r,n){return Kf(r,n,e.origin,e.normal)},t.intersectWithPlane=function(r,n){return Xf(r,n,e.origin,e.normal)}}var gh={normal:[0,0,1],origin:[0,0,0]};function Yf(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,gh,r),d.obj(t,e),d.setGetArray(t,e,["normal","origin"],3),ch(t,e)}var vh=d.newInstance(Yf,"vtkPlane"),rr=oh({newInstance:vh,extend:Yf},uh);function ys(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function ph(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ys(Object(r),!0).forEach(function(n){K(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ys(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var An=[Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE];function If(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]}function it(t){return t[0]<=t[1]&&t[2]<=t[3]&&t[4]<=t[5]}function fi(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function ui(t){return fi(t,An)}function kn(t,e,r,n){var a=Ye(t,6),i=a[0],s=a[1],f=a[2],o=a[3],u=a[4],c=a[5];return t[0]=i<e?i:e,t[1]=s>e?s:e,t[2]=f<r?f:r,t[3]=o>r?o:r,t[4]=u<n?u:n,t[5]=c>n?c:n,t}function ci(t,e){if(e.length===0)return t;if(Array.isArray(e[0]))for(var r=0;r<e.length;++r)kn.apply(void 0,[t].concat(re(e[r])));else for(var n=0;n<e.length;n+=3)kn.apply(void 0,[t].concat(re(e.slice(n,n+3))));return t}function Qf(t,e,r,n,a,i,s){var f=Ye(t,6),o=f[0],u=f[1],c=f[2],g=f[3],v=f[4],p=f[5];return s===void 0?(t[0]=Math.min(e[0],o),t[1]=Math.max(e[1],u),t[2]=Math.min(e[2],c),t[3]=Math.max(e[3],g),t[4]=Math.min(e[4],v),t[5]=Math.max(e[5],p)):(t[0]=Math.min(e,o),t[1]=Math.max(r,u),t[2]=Math.min(n,c),t[3]=Math.max(a,g),t[4]=Math.min(i,v),t[5]=Math.max(s,p)),t}function qf(t,e,r,n){var a=Ye(t,6),i=a[0],s=a[1],f=a[2],o=a[3],u=a[4],c=a[5];return t[0]=e,t[1]=e>s?e:s,t[2]=r,t[3]=r>o?r:o,t[4]=n,t[5]=n>c?n:c,i!==e||f!==r||u!==n}function Zf(t,e,r,n){var a=Ye(t,6),i=a[0],s=a[1],f=a[2],o=a[3],u=a[4],c=a[5];return t[0]=e<i?e:i,t[1]=e,t[2]=r<f?r:f,t[3]=r,t[4]=n<u?n:u,t[5]=n,s!==e||o!==r||c!==n}function Jf(t,e){return t[0]-=e,t[1]+=e,t[2]-=e,t[3]+=e,t[4]-=e,t[5]+=e,t}function gi(t,e,r,n){return it(t)?(e>=0?(t[0]*=e,t[1]*=e):(t[0]=e*t[1],t[1]=e*t[0]),r>=0?(t[2]*=r,t[3]*=r):(t[2]=r*t[3],t[3]=r*t[2]),n>=0?(t[4]*=n,t[5]*=n):(t[4]=n*t[5],t[5]=n*t[4]),!0):!1}function vi(t){return[.5*(t[0]+t[1]),.5*(t[2]+t[3]),.5*(t[4]+t[5])]}function lh(t,e,r,n){if(!it(t))return!1;var a=vi(t);return t[0]-=a[0],t[1]-=a[0],t[2]-=a[1],t[3]-=a[1],t[4]-=a[2],t[5]-=a[2],gi(t,e,r,n),t[0]+=a[0],t[1]+=a[0],t[2]+=a[1],t[3]+=a[1],t[4]+=a[2],t[5]+=a[2],!0}function dr(t,e){return t[e*2+1]-t[e*2]}function $n(t){return[dr(t,0),dr(t,1),dr(t,2)]}function eu(t){return t.slice(0,2)}function tu(t){return t.slice(2,4)}function ru(t){return t.slice(4,6)}function nu(t){var e=$n(t);return e[0]>e[1]?e[0]>e[2]?e[0]:e[2]:e[1]>e[2]?e[1]:e[2]}function au(t){if(it(t)){var e=$n(t);return Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2])}return null}function pi(t){return[t[0],t[2],t[4]]}function li(t){return[t[1],t[3],t[5]]}function Zr(t,e){return t<=0&&e>=0||t>=0&&e<=0}function hi(t,e){for(var r=0,n=0;n<2;n++)for(var a=2;a<4;a++)for(var i=4;i<6;i++)e[r]=[t[n],t[a],t[i]],r++;return e}function iu(t,e,r){return e[0]=t[0],e[1]=t[2],e[2]=t[4],r[0]=t[1],r[1]=t[3],r[2]=t[5],e}function su(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];r.length<6&&ui(r);for(var n=hi(t,[]),a=0;a<n.length;++a)Le(n[a],n[a],e);return ci(r,n)}function ou(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return e[0]=.5*(t[1]-t[0]),e[1]=.5*(t[3]-t[2]),e[2]=.5*(t[5]-t[4]),e}function fu(t,e,r,n){for(var a=[].concat(An),i=t.getData(),s=0;s<i.length;s+=3){var f=[i[s],i[s+1],i[s+2]],o=j(f,e);a[0]=Math.min(o,a[0]),a[1]=Math.max(o,a[1]);var u=j(f,r);a[2]=Math.min(u,a[2]),a[3]=Math.max(u,a[3]);var c=j(f,n);a[4]=Math.min(c,a[4]),a[5]=Math.max(c,a[5])}return a}function uu(t,e,r,n,a){for(var i=!0,s=[],f=0,o=[],u=[0,0,0],c=0,g=1,v=2,p=0;p<3;p++)e[p]<t[2*p]?(s[p]=g,u[p]=t[2*p],i=!1):e[p]>t[2*p+1]?(s[p]=c,u[p]=t[2*p+1],i=!1):s[p]=v;if(i)return n[0]=e[0],n[1]=e[1],n[2]=e[2],a[0]=0,1;for(var l=0;l<3;l++)s[l]!==v&&r[l]!==0?o[l]=(u[l]-e[l])/r[l]:o[l]=-1;for(var y=0;y<3;y++)o[f]<o[y]&&(f=y);if(o[f]>1||o[f]<0)return 0;a[0]=o[f];for(var h=0;h<3;h++)if(f!==h){if(n[h]=e[h]+o[f]*r[h],n[h]<t[2*h]||n[h]>t[2*h+1])return 0}else n[h]=u[h];return 1}function cu(t,e,r){for(var n=[],a=0,i=1,s=1,f=4;f<=5;++f){n[2]=t[f];for(var o=2;o<=3;++o){n[1]=t[o];for(var u=0;u<=1;++u)if(n[0]=t[u],a=rr.evaluate(r,e,n),s&&(i=a>=0?1:-1,s=0),a===0||i>0&&a<0||i<0&&a>0)return 1}}return 0}function gu(t,e){if(!(it(t)&&it(e)))return!1;for(var r=[0,0,0,0,0,0],n,a=0;a<3;a++)if(n=!1,e[a*2]>=t[a*2]&&e[a*2]<=t[a*2+1]?(n=!0,r[a*2]=e[a*2]):t[a*2]>=e[a*2]&&t[a*2]<=e[a*2+1]&&(n=!0,r[a*2]=t[a*2]),e[a*2+1]>=t[a*2]&&e[a*2+1]<=t[a*2+1]?(n=!0,r[a*2+1]=e[2*a+1]):t[a*2+1]>=e[a*2]&&t[a*2+1]<=e[a*2+1]&&(n=!0,r[a*2+1]=t[a*2+1]),!n)return!1;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],!0}function Bn(t,e){if(!(it(t)&&it(e)))return!1;for(var r=0;r<3;r++)if(!(e[r*2]>=t[r*2]&&e[r*2]<=t[r*2+1])&&!(t[r*2]>=e[r*2]&&t[r*2]<=e[r*2+1])&&!(e[r*2+1]>=t[r*2]&&e[r*2+1]<=t[r*2+1])&&!(t[r*2+1]>=e[r*2]&&t[r*2+1]<=e[r*2+1]))return!1;return!0}function Un(t,e,r,n){return!(e<t[0]||e>t[1]||r<t[2]||r>t[3]||n<t[4]||n>t[5])}function hh(t,e){return!(!Bn(t,e)||!Un.apply(void 0,[t].concat(re(pi(e))))||!Un.apply(void 0,[t].concat(re(li(e)))))}function vu(t,e,r){for(var n=[[0,1,2,3,4,5,6,7],[0,1,4,5,2,3,6,7],[0,2,4,6,1,3,5,7]],a=[0,0,0,0,0,0,0,0],i=0,s=0;s<2;s++)for(var f=2;f<4;f++)for(var o=4;o<6;o++){var u=[t[s],t[f],t[o]];a[i++]=rr.evaluate(r,e,u)}for(var c=2;c--&&!(Zr(a[n[c][0]],a[n[c][4]])&&Zr(a[n[c][1]],a[n[c][5]])&&Zr(a[n[c][2]],a[n[c][6]])&&Zr(a[n[c][3]],a[n[c][7]])););if(c<0)return!1;for(var g=Math.sign(r[c]),v=Math.abs((t[c*2+1]-t[c*2])*r[c]),p=g>0?1:0,l=0;l<4;l++)if(v!==0){var y=Math.abs(a[n[c][l]])/v;g>0&&y<p&&(p=y),g<0&&y>p&&(p=y)}var h=(1-p)*t[c*2]+p*t[c*2+1];return g>0?t[c*2]=h:t[c*2+1]=h,!0}var yh=function(){function t(e){Ka(this,t),this.bounds=e,this.bounds||(this.bounds=new Float64Array(An))}return Xa(t,[{key:"getBounds",value:function(){return this.bounds}},{key:"equals",value:function(r){return If(this.bounds,r)}},{key:"isValid",value:function(){return it(this.bounds)}},{key:"setBounds",value:function(r){return fi(this.bounds,r)}},{key:"reset",value:function(){return ui(this.bounds)}},{key:"addPoint",value:function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return kn.apply(void 0,[this.bounds].concat(n))}},{key:"addPoints",value:function(r){return ci(this.bounds,r)}},{key:"addBounds",value:function(r,n,a,i,s,f){return Qf(this.bounds,r,n,a,i,s,f)}},{key:"setMinPoint",value:function(r,n,a){return qf(this.bounds,r,n,a)}},{key:"setMaxPoint",value:function(r,n,a){return Zf(this.bounds,r,n,a)}},{key:"inflate",value:function(r){return Jf(this.bounds,r)}},{key:"scale",value:function(r,n,a){return gi(this.bounds,r,n,a)}},{key:"getCenter",value:function(){return vi(this.bounds)}},{key:"getLength",value:function(r){return dr(this.bounds,r)}},{key:"getLengths",value:function(){return $n(this.bounds)}},{key:"getMaxLength",value:function(){return nu(this.bounds)}},{key:"getDiagonalLength",value:function(){return au(this.bounds)}},{key:"getMinPoint",value:function(){return pi(this.bounds)}},{key:"getMaxPoint",value:function(){return li(this.bounds)}},{key:"getXRange",value:function(){return eu(this.bounds)}},{key:"getYRange",value:function(){return tu(this.bounds)}},{key:"getZRange",value:function(){return ru(this.bounds)}},{key:"getCorners",value:function(r){return hi(this.bounds,r)}},{key:"computeCornerPoints",value:function(r,n){return iu(this.bounds,r,n)}},{key:"computeLocalBounds",value:function(r,n,a){return fu(this.bounds,r,n,a)}},{key:"transformBounds",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return su(this.bounds,r,n)}},{key:"computeScale3",value:function(r){return ou(this.bounds,r)}},{key:"cutWithPlane",value:function(r,n){return vu(this.bounds,r,n)}},{key:"intersectBox",value:function(r,n,a,i){return uu(this.bounds,r,n,a,i)}},{key:"intersectPlane",value:function(r,n){return cu(this.bounds,r,n)}},{key:"intersect",value:function(r){return gu(this.bounds,r)}},{key:"intersects",value:function(r){return Bn(this.bounds,r)}},{key:"containsPoint",value:function(r,n,a){return Un(this.bounds,r,n,a)}},{key:"contains",value:function(r){return Bn(this.bounds,r)}}]),t}();function Th(t){var e=t&&t.bounds;return new yh(e)}var xh={equals:If,isValid:it,setBounds:fi,reset:ui,addPoint:kn,addPoints:ci,addBounds:Qf,setMinPoint:qf,setMaxPoint:Zf,inflate:Jf,scale:gi,scaleAboutCenter:lh,getCenter:vi,getLength:dr,getLengths:$n,getMaxLength:nu,getDiagonalLength:au,getMinPoint:pi,getMaxPoint:li,getXRange:eu,getYRange:tu,getZRange:ru,getCorners:hi,computeCornerPoints:iu,computeLocalBounds:fu,transformBounds:su,computeScale3:ou,cutWithPlane:vu,intersectBox:uu,intersectPlane:cu,intersect:gu,intersects:Bn,containsPoint:Un,contains:hh,INIT_BOUNDS:An},Oe=ph({newInstance:Th},xh),dh={DISPLAY:0,WORLD:1},pu={CoordinateSystem:dh};function Ts(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Oh(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ts(Object(r),!0).forEach(function(n){K(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ts(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var ma=pu.CoordinateSystem;function xs(t){return function(){return d.vtkErrorMacro("vtkProp::".concat(t," - NOT IMPLEMENTED"))}}function Sh(t,e){e.classHierarchy.push("vtkProp"),t.getMTime=function(){for(var r=e.mtime,n=0;n<e.textures.length;++n){var a=e.textures[n].getMTime();a>r&&(r=a)}return r},t.processSelectorPixelBuffers=function(r,n){},t.getNestedProps=function(){return null},t.getActors=function(){return[]},t.getActors2D=function(){return[]},t.getVolumes=function(){return[]},t.pick=xs("pick"),t.hasKey=xs("hasKey"),t.getNestedVisibility=function(){return e.visibility&&(!e._parentProp||e._parentProp.getNestedVisibility())},t.getNestedPickable=function(){return e.pickable&&(!e._parentProp||e._parentProp.getNestedPickable())},t.getNestedDragable=function(){return e.dragable&&(!e._parentProp||e._parentProp.getNestedDragable())},t.getRedrawMTime=function(){return e.mtime},t.setEstimatedRenderTime=function(r){e.estimatedRenderTime=r,e.savedEstimatedRenderTime=r},t.restoreEstimatedRenderTime=function(){e.estimatedRenderTime=e.savedEstimatedRenderTime},t.addEstimatedRenderTime=function(r){e.estimatedRenderTime+=r},t.setAllocatedRenderTime=function(r){e.allocatedRenderTime=r,e.savedEstimatedRenderTime=e.estimatedRenderTime,e.estimatedRenderTime=0},t.getSupportsSelection=function(){return!1},t.getTextures=function(){return e.textures},t.hasTexture=function(r){return e.textures.indexOf(r)!==-1},t.addTexture=function(r){r&&!t.hasTexture(r)&&(e.textures=e.textures.concat(r),t.modified())},t.removeTexture=function(r){var n=e.textures.filter(function(a){return a!==r});e.textures.length!==n.length&&(e.textures=n,t.modified())},t.removeAllTextures=function(){e.textures=[],t.modified()},t.setCoordinateSystemToWorld=function(){return t.setCoordinateSystem(ma.WORLD)},t.setCoordinateSystemToDisplay=function(){return t.setCoordinateSystem(ma.DISPLAY)}}var Ch={allocatedRenderTime:10,coordinateSystem:ma.WORLD,dragable:!0,estimatedRenderTime:0,paths:null,pickable:!0,renderTimeMultiplier:1,savedEstimatedRenderTime:0,textures:[],useBounds:!0,visibility:!0};function lu(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Ch,r),d.obj(t,e),d.get(t,e,["estimatedRenderTime","allocatedRenderTime"]),d.setGet(t,e,["_parentProp","coordinateSystem","dragable","pickable","renderTimeMultiplier","useBounds","visibility"]),d.moveToProtected(t,e,["parentProp"]),Sh(t,e)}var wh=d.newInstance(lu,"vtkProp"),Nr=Oh({newInstance:wh,extend:lu},pu);function Eh(t,e){e.classHierarchy.push("vtkProp3D"),t.addPosition=function(n){e.position=e.position.map(function(a,i){return a+n[i]}),t.modified()},t.getOrientationWXYZ=function(){var n=Er();uf(n,e.rotation);var a=new Float64Array(3),i=fp(a,n);return[Il(i),a[0],a[1],a[2]]},t.rotateX=function(n){n!==0&&(rf(e.rotation,e.rotation,Qt(n)),t.modified())},t.rotateY=function(n){n!==0&&(nf(e.rotation,e.rotation,Qt(n)),t.modified())},t.rotateZ=function(n){n!==0&&(af(e.rotation,e.rotation,Qt(n)),t.modified())},t.rotateWXYZ=function(n,a,i,s){if(!(n===0||a===0&&i===0&&s===0)){var f=Qt(n),o=Er();xf(o,[a,i,s],f);var u=new Float64Array(16);gf(u,o),nt(e.rotation,e.rotation,u),t.modified()}},t.setOrientation=function(n,a,i){return n===e.orientation[0]&&a===e.orientation[1]&&i===e.orientation[2]?!1:(e.orientation=[n,a,i],ge(e.rotation),t.rotateZ(i),t.rotateX(n),t.rotateY(a),t.modified(),!0)},t.setUserMatrix=function(n){return eh(e.userMatrix,n)?!1:(Qe(e.userMatrix,n),t.modified(),!0)},t.getMatrix=function(){return t.computeMatrix(),e.matrix},t.computeMatrix=function(){if(t.getMTime()>e.matrixMTime.getMTime()){ge(e.matrix),e.userMatrix&&nt(e.matrix,e.matrix,e.userMatrix),at(e.matrix,e.matrix,e.origin),at(e.matrix,e.matrix,e.position),nt(e.matrix,e.matrix,e.rotation),ei(e.matrix,e.matrix,e.scale),at(e.matrix,e.matrix,[-e.origin[0],-e.origin[1],-e.origin[2]]),Se(e.matrix,e.matrix),e.isIdentity=!0;for(var n=0;n<4;++n)for(var a=0;a<4;++a)(n===a?1:0)!==e.matrix[n+a*4]&&(e.isIdentity=!1);e.matrixMTime.modified()}},t.getCenter=function(){return Oe.getCenter(e.bounds)},t.getLength=function(){return Oe.getLength(e.bounds)},t.getXRange=function(){return Oe.getXRange(e.bounds)},t.getYRange=function(){return Oe.getYRange(e.bounds)},t.getZRange=function(){return Oe.getZRange(e.bounds)},t.getUserMatrix=function(){return e.userMatrix};function r(){t.computeMatrix()}t.onModified(r)}var Mh={origin:[0,0,0],position:[0,0,0],orientation:[0,0,0],rotation:null,scale:[1,1,1],bounds:[1,-1,1,-1,1,-1],userMatrix:null,userMatrixMTime:null,cachedProp3D:null,isIdentity:!0,matrixMTime:null};function hu(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Mh,r),Nr.extend(t,e,r),e.matrixMTime={},d.obj(e.matrixMTime),d.get(t,e,["bounds","isIdentity"]),d.getArray(t,e,["orientation"]),d.setGetArray(t,e,["origin","position","scale"],3),e.matrix=ge(new Float64Array(16)),e.rotation=ge(new Float64Array(16)),e.userMatrix=ge(new Float64Array(16)),e.transform=null,Eh(t,e)}var Dh=d.newInstance(hu,"vtkProp3D"),bh={newInstance:Dh,extend:hu},yu={FLAT:0,GOURAUD:1,PHONG:2},Fe={POINTS:0,WIREFRAME:1,SURFACE:2},Lh=yu,yi={Shading:yu,Representation:Fe,Interpolation:Lh};function ds(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Rh(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ds(Object(r),!0).forEach(function(n){K(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ds(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var pr=yi.Representation,lr=yi.Interpolation;function Os(t){return function(){return d.vtkErrorMacro("vtkProperty::".concat(t," - NOT IMPLEMENTED"))}}function Vh(t,e){e.classHierarchy.push("vtkProperty"),t.setColor=function(r,n,a){Array.isArray(r)?(e.color[0]!==r[0]||e.color[1]!==r[1]||e.color[2]!==r[2])&&(e.color[0]=r[0],e.color[1]=r[1],e.color[2]=r[2],t.modified()):(e.color[0]!==r||e.color[1]!==n||e.color[2]!==a)&&(e.color[0]=r,e.color[1]=n,e.color[2]=a,t.modified()),t.setDiffuseColor(e.color),t.setAmbientColor(e.color),t.setSpecularColor(e.color)},t.computeCompositeColor=Os("ComputeCompositeColor"),t.getColor=function(){var r=0;e.ambient+e.diffuse+e.specular>0&&(r=1/(e.ambient+e.diffuse+e.specular));for(var n=0;n<3;n++)e.color[n]=r*(e.ambient*e.ambientColor[n]+e.diffuse*e.diffuseColor[n]+e.specular*e.specularColor[n]);return[].concat(e.color)},t.setSpecularPower=function(r){var n=1/Math.max(1,r);(e.roughness!==n||e.specularPower!==r)&&(e.specularPower=r,e.roughness=n,t.modified())},t.addShaderVariable=Os("AddShaderVariable"),t.setInterpolationToFlat=function(){return t.setInterpolation(lr.FLAT)},t.setInterpolationToGouraud=function(){return t.setInterpolation(lr.GOURAUD)},t.setInterpolationToPhong=function(){return t.setInterpolation(lr.PHONG)},t.getInterpolationAsString=function(){return d.enumToString(lr,e.interpolation)},t.setRepresentationToWireframe=function(){return t.setRepresentation(pr.WIREFRAME)},t.setRepresentationToSurface=function(){return t.setRepresentation(pr.SURFACE)},t.setRepresentationToPoints=function(){return t.setRepresentation(pr.POINTS)},t.getRepresentationAsString=function(){return d.enumToString(pr,e.representation)}}var kh={color:[1,1,1],ambientColor:[1,1,1],diffuseColor:[1,1,1],specularColor:[1,1,1],edgeColor:[0,0,0],ambient:0,diffuse:1,metallic:0,roughness:.6,normalStrength:1,emission:1,baseIOR:1.45,specular:0,specularPower:1,opacity:1,interpolation:lr.GOURAUD,representation:pr.SURFACE,edgeVisibility:!1,backfaceCulling:!1,frontfaceCulling:!1,pointSize:1,lineWidth:1,lighting:!0,shading:!1,materialName:null};function Tu(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,kh,r),d.obj(t,e),d.setGet(t,e,["lighting","interpolation","ambient","diffuse","metallic","roughness","normalStrength","emission","baseIOR","specular","specularPower","opacity","edgeVisibility","lineWidth","pointSize","backfaceCulling","frontfaceCulling","representation","diffuseTexture","metallicTexture","roughnessTexture","normalTexture","ambientOcclusionTexture","emissionTexture"]),d.setGetArray(t,e,["ambientColor","specularColor","diffuseColor","edgeColor"],3),Vh(t,e)}var Bh=d.newInstance(Tu,"vtkProperty"),Fr=Rh({newInstance:Bh,extend:Tu},yi);function Ss(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Uh(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ss(Object(r),!0).forEach(function(n){K(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ss(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var Nh=d.vtkDebugMacro;function Fh(t,e){e.classHierarchy.push("vtkActor");var r=Uh({},t);t.getActors=function(){return[t]},t.getIsOpaque=function(){if(e.forceOpaque)return!0;if(e.forceTranslucent)return!1;e.property||t.getProperty();var n=e.property.getOpacity()>=1;return n=n&&(!e.texture||!e.texture.isTranslucent()),n=n&&(!e.mapper||e.mapper.getIsOpaque()),n},t.hasTranslucentPolygonalGeometry=function(){return e.mapper===null?!1:(e.property===null&&t.setProperty(t.makeProperty()),!t.getIsOpaque())},t.makeProperty=Fr.newInstance,t.getProperty=function(){return e.property===null&&(e.property=t.makeProperty()),e.property},t.getBounds=function(){if(e.mapper===null)return e.bounds;var n=e.mapper.getBounds();if(!n||n.length!==6)return n;if(n[0]>n[1])return e.mapperBounds=n.concat(),e.bounds=[1,-1,1,-1,1,-1],e.boundsMTime.modified(),n;if(!e.mapperBounds||n[0]!==e.mapperBounds[0]||n[1]!==e.mapperBounds[1]||n[2]!==e.mapperBounds[2]||n[3]!==e.mapperBounds[3]||n[4]!==e.mapperBounds[4]||n[5]!==e.mapperBounds[5]||t.getMTime()>e.boundsMTime.getMTime()){Nh("Recomputing bounds..."),e.mapperBounds=n.concat();var a=[];Oe.getCorners(n,a),t.computeMatrix();var i=new Float64Array(16);Se(i,e.matrix),a.forEach(function(s){return Le(s,s,i)}),e.bounds[0]=e.bounds[2]=e.bounds[4]=Number.MAX_VALUE,e.bounds[1]=e.bounds[3]=e.bounds[5]=-Number.MAX_VALUE,e.bounds=e.bounds.map(function(s,f){return f%2===0?a.reduce(function(o,u){return o>u[f/2]?u[f/2]:o},s):a.reduce(function(o,u){return o<u[(f-1)/2]?u[(f-1)/2]:o},s)}),e.boundsMTime.modified()}return e.bounds},t.getMTime=function(){var n=r.getMTime();if(e.property!==null){var a=e.property.getMTime();n=a>n?a:n}if(e.backfaceProperty!==null){var i=e.backfaceProperty.getMTime();n=i>n?i:n}return n},t.getRedrawMTime=function(){var n=e.mtime;if(e.mapper!==null){var a=e.mapper.getMTime();n=a>n?a:n,e.mapper.getInput()!==null&&(e.mapper.getInputAlgorithm().update(),a=e.mapper.getInput().getMTime(),n=a>n?a:n)}return n},t.getSupportsSelection=function(){return e.mapper?e.mapper.getSupportsSelection():!1},t.processSelectorPixelBuffers=function(n,a){e.mapper&&e.mapper.processSelectorPixelBuffers&&e.mapper.processSelectorPixelBuffers(n,a)}}var mh={mapper:null,property:null,backfaceProperty:null,forceOpaque:!1,forceTranslucent:!1,bounds:[1,-1,1,-1,1,-1]};function xu(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,mh,r),bh.extend(t,e,r),e.boundsMTime={},d.obj(e.boundsMTime),d.set(t,e,["property"]),d.setGet(t,e,["backfaceProperty","forceOpaque","forceTranslucent","mapper"]),Fh(t,e)}var Gh=d.newInstance(xu,"vtkActor"),nr={newInstance:Gh,extend:xu},du={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},mr={VOID:"",CHAR:"Int8Array",SIGNED_CHAR:"Int8Array",UNSIGNED_CHAR:"Uint8Array",SHORT:"Int16Array",UNSIGNED_SHORT:"Uint16Array",INT:"Int32Array",UNSIGNED_INT:"Uint32Array",FLOAT:"Float32Array",DOUBLE:"Float64Array"},_h=mr.FLOAT,Ou={DefaultDataType:_h,DataTypeByteSize:du,VtkDataTypes:mr};function Cs(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Nn(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Cs(Object(r),!0).forEach(function(n){K(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Cs(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var Ah=Y,$h=Ou.DefaultDataType;function Ga(t,e,r){var n=t.length,a,i,s,f;if(n===0)return{min:Number.MAX_VALUE,max:-Number.MAX_VALUE};for(a=t[e],i=a,f=e;f<n;f+=r)s=t[f],s<a?a=s:s>i&&(i=s);return{min:a,max:i}}function Wh(){var t=Number.MAX_VALUE,e=-Number.MAX_VALUE,r=0,n=0;return{add:function(i){t>i&&(t=i),e<i&&(e=i),r++,n+=i},get:function(){return{min:t,max:e,count:r,sum:n,mean:n/r}},getRange:function(){return{min:t,max:e}}}}function Su(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;if(e<0&&r>1){for(var n=t.length,a=n/r,i=new Float64Array(a),s=0,f=0;s<a;++s){for(var o,u=f+r;f<u;++f)i[s]+=t[f]*t[f];o=s,i[o]=Math.pow(i[o],.5)}return Ga(i,0,1)}return Ga(t,e<0?0:e,r)}function ws(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=t||[];r.length<=e;)r.push(null);return r}function Ti(t){return Object.prototype.toString.call(t).slice(8,-1)}function zh(t){for(var e=t.getNumberOfComponents(),r=0,n=new Array(e),a=0;a<t.getNumberOfTuples();++a){t.getTuple(a,n);var i=_f(n,e);i>r&&(r=i)}return r}var Cu={computeRange:Su,createRangeHelper:Wh,fastComputeRange:Ga,getDataType:Ti,getMaxNorm:zh};function jh(t,e){e.classHierarchy.push("vtkDataArray");function r(n){if(n<0)return!1;var a=t.getNumberOfComponents(),i=e.values.length/(a>0?a:1);if(n===i)return!0;if(n>i){var s=e.values;return e.values=Br(e.dataType,(n+i)*a),e.values.set(s),!0}return e.size>n*a&&(e.size=n*a,t.dataChange()),!0}t.dataChange=function(){e.ranges=null,t.modified()},t.resize=function(n){r(n);var a=n*t.getNumberOfComponents();return e.size!==a?(e.size=a,t.dataChange(),!0):!1},t.initialize=function(){t.resize(0)},t.getElementComponentSize=function(){return e.values.BYTES_PER_ELEMENT},t.getComponent=function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return e.values[n*e.numberOfComponents+a]},t.setComponent=function(n,a,i){i!==e.values[n*e.numberOfComponents+a]&&(e.values[n*e.numberOfComponents+a]=i,t.dataChange())},t.getValue=function(n){var a=n/e.numberOfComponents,i=n%e.numberOfComponents;return t.getComponent(a,i)},t.setValue=function(n,a){var i=n/e.numberOfComponents,s=n%e.numberOfComponents;t.setComponent(i,s,a)},t.getData=function(){return e.size===e.values.length?e.values:e.values.subarray(0,e.size)},t.getRange=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:-1,a=n<0?e.numberOfComponents:n,i=null;return e.ranges||(e.ranges=ws(e.ranges,e.numberOfComponents)),i=e.ranges[a],i?(e.rangeTuple[0]=i.min,e.rangeTuple[1]=i.max,e.rangeTuple):(i=Su(t.getData(),n,e.numberOfComponents),e.ranges[a]=i,e.rangeTuple[0]=i.min,e.rangeTuple[1]=i.max,e.rangeTuple)},t.setRange=function(n,a){e.ranges||(e.ranges=ws(e.ranges,e.numberOfComponents));var i={min:n.min,max:n.max};return e.ranges[a]=i,e.rangeTuple[0]=i.min,e.rangeTuple[1]=i.max,e.rangeTuple},t.setTuple=function(n,a){for(var i=n*e.numberOfComponents,s=0;s<e.numberOfComponents;s++)e.values[i+s]=a[s]},t.setTuples=function(n,a){for(var i=n*e.numberOfComponents,s=Math.min(a.length,e.size-i),f=0;f<s;)e.values[i++]=a[f++]},t.insertTuple=function(n,a){return e.size<=n*e.numberOfComponents&&(e.size=(n+1)*e.numberOfComponents,r(n+1)),t.setTuple(n,a),n},t.insertTuples=function(n,a){var i=n+a.length/e.numberOfComponents;return e.size<i*e.numberOfComponents&&(e.size=i*e.numberOfComponents,r(i)),t.setTuples(n,a),i},t.insertNextTuple=function(n){var a=e.size/e.numberOfComponents;return t.insertTuple(a,n)},t.insertNextTuples=function(n){var a=e.size/e.numberOfComponents;return t.insertTuples(a,n)},t.getTuple=function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=e.numberOfComponents||1,s=n*i;switch(i){case 4:a[3]=e.values[s+3];case 3:a[2]=e.values[s+2];case 2:a[1]=e.values[s+1];case 1:a[0]=e.values[s];break;default:for(var f=i-1;f>=0;--f)a[f]=e.values[s+f]}return a},t.getTuples=function(n,a){var i=(n!=null?n:0)*e.numberOfComponents,s=(a!=null?a:t.getNumberOfTuples())*e.numberOfComponents,f=t.getData().subarray(i,s);return f.length>0?f:null},t.getTupleLocation=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;return n*e.numberOfComponents},t.getNumberOfComponents=function(){return e.numberOfComponents},t.getNumberOfValues=function(){return e.size},t.getNumberOfTuples=function(){return e.size/e.numberOfComponents},t.getDataType=function(){return e.dataType},t.newClone=function(){return Eu({empty:!0,name:e.name,dataType:e.dataType,numberOfComponents:e.numberOfComponents})},t.getName=function(){return e.name||(t.modified(),e.name="vtkDataArray".concat(t.getMTime())),e.name},t.setData=function(n,a){e.values=n,e.size=n.length,e.dataType=Ti(n),a&&(e.numberOfComponents=a),e.size%e.numberOfComponents!==0&&(e.numberOfComponents=1),t.dataChange()},t.getState=function(){if(e.deleted)return null;var n=Nn(Nn({},e),{},{vtkClass:t.getClassName()});n.values=Array.from(n.values),delete n.buffer,Object.keys(n).forEach(function(i){n[i]||delete n[i]});var a={};return Object.keys(n).sort().forEach(function(i){a[i]=n[i]}),a.mtime&&delete a.mtime,a},t.deepCopy=function(n){t.shallowCopy(n),t.setData(n.getData().slice())},t.interpolateTuple=function(n,a,i,s,f,o){var u=e.numberOfComponents||1;(u!==a.getNumberOfComponents()||u!==s.getNumberOfComponents())&&Ah("numberOfComponents must match");var c=a.getTuple(i),g=s.getTuple(f),v=[];switch(v.length=u,u){case 4:v[3]=c[3]+(g[3]-c[3])*o;case 3:v[2]=c[2]+(g[2]-c[2])*o;case 2:v[1]=c[1]+(g[1]-c[1])*o;case 1:v[0]=c[0]+(g[0]-c[0])*o;break;default:for(var p=0;p<u;p++)v[p]=c[p]+(g[p]-c[p])*o}return t.insertTuple(n,v)}}var Hh={name:"",numberOfComponents:1,dataType:$h,rangeTuple:[0,0]};function wu(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(Object.assign(e,Hh,r),!e.empty&&!e.values&&!e.size)throw new TypeError("Cannot create vtkDataArray object without: size > 0, values");if(e.values?Array.isArray(e.values)&&(e.values=Ho(e.dataType,e.values)):e.values=Br(e.dataType,e.size),e.values){var n;e.size=(n=e.size)!==null&&n!==void 0?n:e.values.length,e.dataType=Ti(e.values)}be(t,e),_n(t,e,["name","numberOfComponents"]),jh(t,e)}var Eu=ne(wu,"vtkDataArray"),ve=Nn(Nn({newInstance:Eu,extend:wu},Cu),Ou);function Ph(t,e){e.classHierarchy.push("vtkAbstractMapper"),t.update=function(){t.getInputData()},t.addClippingPlane=function(r){return r.isA("vtkPlane")?e.clippingPlanes.includes(r)?!1:(e.clippingPlanes.push(r),t.modified(),!0):!1},t.getNumberOfClippingPlanes=function(){return e.clippingPlanes.length},t.removeAllClippingPlanes=function(){return e.clippingPlanes.length===0?!1:(e.clippingPlanes.length=0,t.modified(),!0)},t.removeClippingPlane=function(r){var n=e.clippingPlanes.indexOf(r);return n===-1?!1:(e.clippingPlanes.splice(n,1),t.modified(),!0)},t.getClippingPlanes=function(){return e.clippingPlanes},t.setClippingPlanes=function(r){if(!!r)if(!Array.isArray(r))t.addClippingPlane(r);else for(var n=r.length,a=0;a<n&&a<6;a++)t.addClippingPlane(r[a])},t.getClippingPlaneInDataCoords=function(r,n,a){var i=e.clippingPlanes,s=r;if(i){var f=i.length;if(n>=0&&n<f){var o=i[n],u=o.getNormal(),c=o.getOrigin(),g=u[0],v=u[1],p=u[2],l=-(g*c[0]+v*c[1]+p*c[2]);a[0]=g*s[0]+v*s[4]+p*s[8]+l*s[12],a[1]=g*s[1]+v*s[5]+p*s[9]+l*s[13],a[2]=g*s[2]+v*s[6]+p*s[10]+l*s[14],a[3]=g*s[3]+v*s[7]+p*s[11]+l*s[15];return}}d.vtkErrorMacro("Clipping plane index ".concat(n," is out of range."))}}var Kh={clippingPlanes:[]};function Xh(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Kh,r),d.obj(t,e),d.algo(t,e,1,0),e.clippingPlanes||(e.clippingPlanes=[]),Ph(t,e)}var Mu={extend:Xh};function Yh(t,e){t.getBounds=function(){return 0},t.getBounds=function(r){t.getBounds();for(var n=0;n<6;n++)r[n]=e.bounds[n]},t.getCenter=function(){t.getBounds();for(var r=0;r<3;r++)e.center[r]=(e.bounds[2*r+1]+e.bounds[2*r])/2;return e.center.slice()},t.getLength=function(){var r=0,n=0;t.getBounds();for(var a=0;a<3;a++)r=e.bounds[2*a+1]-e.bounds[2*a],n+=r*r;return Math.sqrt(n)}}var Ih={bounds:[1,-1,1,-1,1,-1],center:[0,0,0]};function Qh(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Ih,r),Mu.extend(t,e,r),e.bounds||oi(e.bounds),e.center||(e.center=[0,0,0]),Yh(t,e)}var qh={extend:Qh},Es=d.vtkErrorMacro,Zh=d.vtkWarningMacro;function Jh(t,e){e.classHierarchy.push("vtkFieldData");var r=t.getState;e.arrays&&(e.arrays=e.arrays.map(function(n){return{data:ze(n.data)}})),t.initialize=function(){t.initializeFields(),t.copyAllOn(),t.clearFieldFlags()},t.initializeFields=function(){e.arrays=[],e.copyFieldFlags={},t.modified()},t.copyStructure=function(n){t.initializeFields(),e.copyFieldFlags=n.getCopyFieldFlags().map(function(a){return a}),e.arrays=n.arrays().map(function(a){return{array:a}})},t.getNumberOfArrays=function(){return e.arrays.length},t.getNumberOfActiveArrays=function(){return e.arrays.length},t.addArray=function(n){var a=n.getName(),i=t.getArrayWithIndex(a),s=i.array,f=i.index;return s!=null?(e.arrays[f]={data:n},f):(e.arrays=[].concat(e.arrays,{data:n}),e.arrays.length-1)},t.removeAllArrays=function(){e.arrays=[]},t.removeArray=function(n){var a=e.arrays.findIndex(function(i){return i.getName()===n});return t.removeArrayByIndex(a)},t.removeArrayByIndex=function(n){return n!==-1&&n<e.arrays.length?(e.arrays.splice(n,1),!0):!1},t.getArrays=function(){return e.arrays.map(function(n){return n.data})},t.getArray=function(n){return typeof n=="number"?t.getArrayByIndex(n):t.getArrayByName(n)},t.getArrayByName=function(n){return e.arrays.reduce(function(a,i,s){return i.data.getName()===n?i.data:a},null)},t.getArrayWithIndex=function(n){var a=e.arrays.findIndex(function(i){return i.data.getName()===n});return{array:a!==-1?e.arrays[a].data:null,index:a}},t.getArrayByIndex=function(n){return n>=0&&n<e.arrays.length?e.arrays[n].data:null},t.hasArray=function(n){return t.getArrayWithIndex(n).index>=0},t.getArrayName=function(n){var a=e.arrays[n];return a?a.data.getName():""},t.getCopyFieldFlags=function(){return e.copyFieldFlags},t.getFlag=function(n){return e.copyFieldFlags[n]},t.passData=function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1;n.getArrays().forEach(function(s){var f=t.getFlag(s.getName());if(f!==!1&&!(e.doCopyAllOff&&f!==!0)&&s){var o=t.getArrayByName(s.getName());if(o)if(s.getNumberOfComponents()===o.getNumberOfComponents())if(a>-1&&a<s.getNumberOfTuples()){var v=i>-1?i:a;o.insertTuple(v,s.getTuple(a))}else o.insertTuples(0,s.getTuples());else Es("Unhandled case in passData");else if(a<0||a>s.getNumberOfTuples())t.addArray(s),n.getAttributes(s).forEach(function(p){t.setAttribute(s,p)});else{var u=s.getNumberOfComponents(),c=s.getNumberOfValues(),g=i>-1?i:a;c<=g*u&&(c=(g+1)*u),o=ve.newInstance({name:s.getName(),dataType:s.getDataType(),numberOfComponents:u,values:d.newTypedArray(s.getDataType(),c),size:0}),o.insertTuple(g,s.getTuple(a)),t.addArray(o),n.getAttributes(s).forEach(function(p){t.setAttribute(o,p)})}}})},t.interpolateData=function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:-1,f=arguments.length>4&&arguments[4]!==void 0?arguments[4]:.5;n.getArrays().forEach(function(o){var u=t.getFlag(o.getName());if(u!==!1&&!(e.doCopyAllOff&&u!==!0)&&o){var c=t.getArrayByName(o.getName());if(c)if(o.getNumberOfComponents()===c.getNumberOfComponents())if(a>-1&&a<o.getNumberOfTuples()){var l=s>-1?s:a;c.interpolateTuple(l,o,a,o,i,f),Zh("Unexpected case in interpolateData")}else c.insertTuples(o.getTuples());else Es("Unhandled case in interpolateData");else if(a<0||i<0||a>o.getNumberOfTuples())t.addArray(o),n.getAttributes(o).forEach(function(y){t.setAttribute(o,y)});else{var g=o.getNumberOfComponents(),v=o.getNumberOfValues(),p=s>-1?s:a;v<=p*g&&(v=(p+1)*g),c=ve.newInstance({name:o.getName(),dataType:o.getDataType(),numberOfComponents:g,values:d.newTypedArray(o.getDataType(),v),size:0}),c.interpolateTuple(p,o,a,o,i,f),t.addArray(c),n.getAttributes(o).forEach(function(y){t.setAttribute(c,y)})}}})},t.copyFieldOn=function(n){e.copyFieldFlags[n]=!0},t.copyFieldOff=function(n){e.copyFieldFlags[n]=!1},t.copyAllOn=function(){(!e.doCopyAllOn||e.doCopyAllOff)&&(e.doCopyAllOn=!0,e.doCopyAllOff=!1,t.modified())},t.copyAllOff=function(){(e.doCopyAllOn||!e.doCopyAllOff)&&(e.doCopyAllOn=!1,e.doCopyAllOff=!0,t.modified())},t.clearFieldFlags=function(){e.copyFieldFlags={}},t.deepCopy=function(n){e.arrays=n.getArrays().map(function(a){var i=a.newClone();return i.deepCopy(a),{data:i}})},t.copyFlags=function(n){return n.getCopyFieldFlags().map(function(a){return a})},t.reset=function(){return e.arrays.forEach(function(n){return n.data.reset()})},t.getMTime=function(){return e.arrays.reduce(function(n,a){return a.data.getMTime()>n?a.data.getMTime():n},e.mtime)},t.getNumberOfComponents=function(){return e.arrays.reduce(function(n,a){return n+a.data.getNumberOfComponents()},0)},t.getNumberOfTuples=function(){return e.arrays.length>0?e.arrays[0].getNumberOfTuples():0},t.getState=function(){var n=r();return n&&(n.arrays=e.arrays.map(function(a){return{data:a.data.getState()}})),n}}var ey={arrays:[],copyFieldFlags:[],doCopyAllOn:!0,doCopyAllOff:!1};function Du(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,ey,r),d.obj(t,e),Jh(t,e)}var ty=d.newInstance(Du,"vtkFieldData"),ry={newInstance:ty,extend:Du},ny={SCALARS:0,VECTORS:1,NORMALS:2,TCOORDS:3,TENSORS:4,GLOBALIDS:5,PEDIGREEIDS:6,EDGEFLAG:7,NUM_ATTRIBUTES:8},ay={MAX:0,EXACT:1,NOLIMIT:2},iy={DUPLICATECELL:1,HIGHCONNECTIVITYCELL:2,LOWCONNECTIVITYCELL:4,REFINEDCELL:8,EXTERIORCELL:16,HIDDENCELL:32},sy={DUPLICATEPOINT:1,HIDDENPOINT:2},oy={COPYTUPLE:0,INTERPOLATE:1,PASSDATA:2,ALLCOPY:3},fy="vtkGhostType",uy={DEFAULT:0,SINGLE:1,DOUBLE:2},xi={AttributeCopyOperations:oy,AttributeLimitTypes:ay,AttributeTypes:ny,CellGhostTypes:iy,DesiredOutputPrecision:uy,PointGhostTypes:sy,ghostArrayName:fy};function Ms(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function bu(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ms(Object(r),!0).forEach(function(n){K(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ms(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var ut=xi.AttributeTypes,dt=xi.AttributeCopyOperations,Jr=d.vtkWarningMacro;function cy(t,e){var r=["Scalars","Vectors","Normals","TCoords","Tensors","GlobalIds","PedigreeIds"];function n(s){var f=r.find(function(o){return ut[o.toUpperCase()]===s||typeof s!="number"&&o.toLowerCase()===s.toLowerCase()});return typeof f=="undefined"&&(f=null),f}e.classHierarchy.push("vtkDataSetAttributes");var a=bu({},t);t.checkNumberOfComponents=function(s){return!0},t.setAttribute=function(s,f){var o=n(f);if(s&&o.toUpperCase()==="PEDIGREEIDS"&&!s.isA("vtkDataArray"))return Jr("Cannot set attribute ".concat(o,". The attribute must be a vtkDataArray.")),-1;if(s&&!t.checkNumberOfComponents(s,o))return Jr("Cannot set attribute ".concat(o,". Incorrect number of components.")),-1;var u=e["active".concat(o)];if(u>=0&&u<e.arrays.length){if(e.arrays[u]===s)return u;t.removeArrayByIndex(u)}return s?(u=t.addArray(s),e["active".concat(o)]=u):e["active".concat(o)]=-1,t.modified(),e["active".concat(o)]},t.getAttributes=function(s){return r.filter(function(f){return t["get".concat(f)]()===s})},t.setActiveAttributeByName=function(s,f){return t.setActiveAttributeByIndex(t.getArrayWithIndex(s).index,f)},t.setActiveAttributeByIndex=function(s,f){var o=n(f);if(s>=0&&s<e.arrays.length){if(o.toUpperCase()!=="PEDIGREEIDS"){var u=t.getArrayByIndex(s);if(!u.isA("vtkDataArray"))return Jr("Cannot set attribute ".concat(o,". Only vtkDataArray subclasses can be set as active attributes.")),-1;if(!t.checkNumberOfComponents(u,o))return Jr("Cannot set attribute ".concat(o,". Incorrect number of components.")),-1}return e["active".concat(o)]=s,t.modified(),s}return s===-1&&(e["active".concat(o)]=s,t.modified()),-1},t.getActiveAttribute=function(s){var f=n(s);return t["get".concat(f)]()},t.removeAllArrays=function(){r.forEach(function(s){e["active".concat(s)]=-1}),a.removeAllArrays()},t.removeArrayByIndex=function(s){return s!==-1&&r.forEach(function(f){s===e["active".concat(f)]?e["active".concat(f)]=-1:s<e["active".concat(f)]&&(e["active".concat(f)]-=1)}),a.removeArrayByIndex(s)},r.forEach(function(s){var f="active".concat(s);t["get".concat(s)]=function(){return t.getArrayByIndex(e[f])},t["set".concat(s)]=function(o){return t.setAttribute(o,s)},t["setActive".concat(s)]=function(o){return t.setActiveAttributeByIndex(t.getArrayWithIndex(o).index,s)},t["copy".concat(s,"Off")]=function(){var o=s.toUpperCase();e.copyAttributeFlags[dt.PASSDATA][ut[o]]=!1},t["copy".concat(s,"On")]=function(){var o=s.toUpperCase();e.copyAttributeFlags[dt.PASSDATA][ut[o]]=!0}}),t.initializeAttributeCopyFlags=function(){e.copyAttributeFlags=[],Object.keys(dt).filter(function(s){return s!=="ALLCOPY"}).forEach(function(s){e.copyAttributeFlags[dt[s]]=Object.keys(ut).filter(function(f){return f!=="NUM_ATTRIBUTES"}).reduce(function(f,o){return f[ut[o]]=!0,f},[])}),e.copyAttributeFlags[dt.COPYTUPLE][ut.GLOBALIDS]=!1,e.copyAttributeFlags[dt.INTERPOLATE][ut.GLOBALIDS]=!1,e.copyAttributeFlags[dt.COPYTUPLE][ut.PEDIGREEIDS]=!1},t.initialize=d.chain(t.initialize,t.initializeAttributeCopyFlags),e.dataArrays&&Object.keys(e.dataArrays).length&&Object.keys(e.dataArrays).forEach(function(s){!e.dataArrays[s].ref&&e.dataArrays[s].type==="vtkDataArray"&&t.addArray(ve.newInstance(e.dataArrays[s]))});var i=t.shallowCopy;t.shallowCopy=function(s,f){i(s,f),e.arrays=s.getArrays().map(function(o){var u=o.newClone();return u.shallowCopy(o,f),{data:u}})},t.initializeAttributeCopyFlags()}var gy={activeScalars:-1,activeVectors:-1,activeTensors:-1,activeNormals:-1,activeTCoords:-1,activeGlobalIds:-1,activePedigreeIds:-1};function Lu(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,gy,r),ry.extend(t,e,r),d.setGet(t,e,["activeScalars","activeNormals","activeTCoords","activeVectors","activeTensors","activeGlobalIds","activePedigreeIds"]),e.arrays||(e.arrays={}),cy(t,e)}var vy=d.newInstance(Lu,"vtkDataSetAttributes"),Ds=bu({newInstance:vy,extend:Lu},xi),py={UNIFORM:0,DATA_OBJECT_FIELD:0,COORDINATE:1,POINT_DATA:1,POINT:2,POINT_FIELD_DATA:2,CELL:3,CELL_FIELD_DATA:3,VERTEX:4,VERTEX_FIELD_DATA:4,EDGE:5,EDGE_FIELD_DATA:5,ROW:6,ROW_DATA:6},ly={FIELD_ASSOCIATION_POINTS:0,FIELD_ASSOCIATION_CELLS:1,FIELD_ASSOCIATION_NONE:2,FIELD_ASSOCIATION_POINTS_THEN_CELLS:3,FIELD_ASSOCIATION_VERTICES:4,FIELD_ASSOCIATION_EDGES:5,FIELD_ASSOCIATION_ROWS:6,NUMBER_OF_ASSOCIATIONS:7},hy={FieldDataTypes:py,FieldAssociations:ly};function bs(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function yy(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?bs(Object(r),!0).forEach(function(n){K(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):bs(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var _a=["pointData","cellData","fieldData"];function Ty(t,e){e.classHierarchy.push("vtkDataSet"),_a.forEach(function(n){e[n]?e[n]=ze(e[n]):e[n]=Ds.newInstance()});var r=t.shallowCopy;t.shallowCopy=function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;r(n,a),_a.forEach(function(i){e[i]=Ds.newInstance(),e[i].shallowCopy(n.getReferenceByName(i))})}}var xy={};function Ru(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,xy,r),d.obj(t,e),d.setGet(t,e,_a),Ty(t,e)}var dy=d.newInstance(Ru,"vtkDataSet"),Wn=yy({newInstance:dy,extend:Ru},hy),Ge={UNCHANGED:0,SINGLE_POINT:1,X_LINE:2,Y_LINE:3,Z_LINE:4,XY_PLANE:5,YZ_PLANE:6,XZ_PLANE:7,XYZ_GRID:8,EMPTY:9},Vu={StructuredType:Ge};function Ls(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Oy(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ls(Object(r),!0).forEach(function(n){K(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ls(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var Ze=Vu.StructuredType;function Sy(t){for(var e=0,r=0;r<3;++r)t[r*2]<t[r*2+1]&&e++;return t[0]>t[1]||t[2]>t[3]||t[4]>t[5]?Ze.EMPTY:e===3?Ze.XYZ_GRID:e===2?t[0]===t[1]?Ze.YZ_PLANE:t[2]===t[3]?Ze.XZ_PLANE:Ze.XY_PLANE:e===1?t[0]<t[1]?Ze.X_LINE:t[2]<t[3]?Ze.Y_LINE:Ze.Z_LINE:Ze.SINGLE_POINT}var Cy=Oy({getDataDescriptionFromExtent:Sy},Vu),Ot=d.vtkErrorMacro;function wy(t,e){e.classHierarchy.push("vtkImageData"),t.setExtent=function(){if(e.deleted)return Ot("instance deleted - cannot call any method"),!1;for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];var i=n.length===1?n[0]:n;if(i.length!==6)return!1;var s=e.extent.some(function(f,o){return f!==i[o]});return s&&(e.extent=i.slice(),e.dataDescription=Cy.getDataDescriptionFromExtent(e.extent),t.modified()),s},t.setDimensions=function(){var r,n,a;if(e.deleted){Ot("instance deleted - cannot call any method");return}if(arguments.length===1){var i=arguments.length<=0?void 0:arguments[0];r=i[0],n=i[1],a=i[2]}else if(arguments.length===3)r=arguments.length<=0?void 0:arguments[0],n=arguments.length<=1?void 0:arguments[1],a=arguments.length<=2?void 0:arguments[2];else{Ot("Bad dimension specification");return}t.setExtent(0,r-1,0,n-1,0,a-1)},t.getDimensions=function(){return[e.extent[1]-e.extent[0]+1,e.extent[3]-e.extent[2]+1,e.extent[5]-e.extent[4]+1]},t.getNumberOfCells=function(){for(var r=t.getDimensions(),n=1,a=0;a<3;a++){if(r[a]===0)return 0;r[a]>1&&(n*=r[a]-1)}return n},t.getNumberOfPoints=function(){var r=t.getDimensions();return r[0]*r[1]*r[2]},t.getPoint=function(r){var n=t.getDimensions();if(n[0]===0||n[1]===0||n[2]===0)return Ot("Requesting a point from an empty image."),null;var a=new Float64Array(3);switch(e.dataDescription){case Ge.EMPTY:return null;case Ge.SINGLE_POINT:break;case Ge.X_LINE:a[0]=r;break;case Ge.Y_LINE:a[1]=r;break;case Ge.Z_LINE:a[2]=r;break;case Ge.XY_PLANE:a[0]=r%n[0],a[1]=r/n[0];break;case Ge.YZ_PLANE:a[1]=r%n[1],a[2]=r/n[1];break;case Ge.XZ_PLANE:a[0]=r%n[0],a[2]=r/n[0];break;case Ge.XYZ_GRID:a[0]=r%n[0],a[1]=r/n[0]%n[1],a[2]=r/(n[0]*n[1]);break;default:Ot("Invalid dataDescription");break}var i=[0,0,0];return t.indexToWorld(a,i),i},t.getBounds=function(){return t.extentToBounds(t.getSpatialExtent())},t.extentToBounds=function(r){return Oe.transformBounds(r,e.indexToWorld)},t.getSpatialExtent=function(){return Oe.inflate(re(e.extent),.5)},t.computeTransforms=function(){sf(e.indexToWorld,e.origin),e.indexToWorld[0]=e.direction[0],e.indexToWorld[1]=e.direction[1],e.indexToWorld[2]=e.direction[2],e.indexToWorld[4]=e.direction[3],e.indexToWorld[5]=e.direction[4],e.indexToWorld[6]=e.direction[5],e.indexToWorld[8]=e.direction[6],e.indexToWorld[9]=e.direction[7],e.indexToWorld[10]=e.direction[8],ei(e.indexToWorld,e.indexToWorld,e.spacing),At(e.worldToIndex,e.indexToWorld)},t.indexToWorld=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return Le(n,r,e.indexToWorld),n},t.indexToWorldVec3=t.indexToWorld,t.worldToIndex=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return Le(n,r,e.worldToIndex),n},t.worldToIndexVec3=t.worldToIndex,t.indexToWorldBounds=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return Oe.transformBounds(r,e.indexToWorld,n)},t.worldToIndexBounds=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return Oe.transformBounds(r,e.worldToIndex,n)},t.onModified(t.computeTransforms),t.computeTransforms(),t.getCenter=function(){return Oe.getCenter(t.getBounds())},t.computeHistogram=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,a=[0,0,0,0,0,0];t.worldToIndexBounds(r,a);var i=[0,0,0],s=[0,0,0];Oe.computeCornerPoints(a,i,s),ps(i,i),ps(s,s);var f=t.getDimensions();ls(i,[0,0,0],[f[0]-1,f[1]-1,f[2]-1],i),ls(s,[0,0,0],[f[0]-1,f[1]-1,f[2]-1],s);for(var o=f[0],u=f[0]*f[1],c=t.getPointData().getScalars().getData(),g=-1/0,v=1/0,p=0,l=0,y=0,h=i[2];h<=s[2];h++)for(var T=i[1];T<=s[1];T++)for(var x=i[0]+T*o+h*u,S=i[0];S<=s[0];S++){if(!n||n([S,T,h],a)){var O=c[x];O>g&&(g=O),O<v&&(v=O),p+=O*O,l+=O,y+=1}++x}var C=y>0?l/y:0,w=y?Math.abs(p/y-C*C):0,E=Math.sqrt(w);return{minimum:v,maximum:g,average:C,variance:w,sigma:E,count:y}},t.computeIncrements=function(r){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,a=[],i=n,s=0;s<3;++s)a[s]=i,i*=r[s*2+1]-r[s*2]+1;return a},t.computeOffsetIndex=function(r){var n=Ye(r,3),a=n[0],i=n[1],s=n[2],f=t.getExtent(),o=t.getPointData().getScalars().getNumberOfComponents(),u=t.computeIncrements(f,o);return Math.floor((Math.round(a)-f[0])*u[0]+(Math.round(i)-f[2])*u[1]+(Math.round(s)-f[4])*u[2])},t.getOffsetIndexFromWorld=function(r){for(var n=t.getExtent(),a=t.worldToIndex(r),i=0;i<3;++i)if(a[i]<n[i*2]||a[i]>n[i*2+1])return Ot("GetScalarPointer: Pixel ".concat(a," is not in memory. Current extent = ").concat(n)),NaN;return t.computeOffsetIndex(a)},t.getScalarValueFromWorld=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=t.getPointData().getScalars().getNumberOfComponents();if(n<0||n>=a)return Ot("GetScalarPointer: Scalar Component ".concat(n," is not within bounds. Current Scalar numberOfComponents: ").concat(a)),NaN;var i=t.getOffsetIndexFromWorld(r);return Number.isNaN(i)?i:t.getPointData().getScalars().getComponent(i,n)}}var Ey={direction:null,indexToWorld:null,worldToIndex:null,spacing:[1,1,1],origin:[0,0,0],extent:[0,-1,0,-1,0,-1],dataDescription:Ge.EMPTY};function ku(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Ey,r),Wn.extend(t,e,r),e.direction?Array.isArray(e.direction)&&(e.direction=new Float64Array(e.direction.slice(0,9))):e.direction=$t(new Float64Array(9)),e.indexToWorld=new Float64Array(16),e.worldToIndex=new Float64Array(16),d.get(t,e,["indexToWorld","worldToIndex"]),d.setGetArray(t,e,["origin","spacing"],3),d.setGetArray(t,e,["direction"],9),d.getArray(t,e,["extent"],6),wy(t,e)}var My=d.newInstance(ku,"vtkImageData"),Dy={newInstance:My,extend:ku},by={MAGNITUDE:0,COMPONENT:1,RGBCOLORS:2},Aa={LUMINANCE:1,LUMINANCE_ALPHA:2,RGB:3,RGBA:4},zn={VectorMode:by,ScalarMappingTarget:Aa},Ly={DEFAULT:0,MAP_SCALARS:1,DIRECT_SCALARS:2},Ry={DEFAULT:0,USE_POINT_DATA:1,USE_CELL_DATA:2,USE_POINT_FIELD_DATA:3,USE_CELL_FIELD_DATA:4,USE_FIELD_DATA:5},Vy={BY_ID:0,BY_NAME:1},Tt={ColorMode:Ly,GetArray:Vy,ScalarMode:Ry};function Rs(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function ky(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Rs(Object(r),!0).forEach(function(n){K(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Rs(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var Vs=zn.ScalarMappingTarget,Xe=zn.VectorMode,St=ve.VtkDataTypes,en=Tt.ColorMode,ks=d.vtkErrorMacro;function By(t){return t}function Bs(t){return Math.floor(t*255+.5)}function Uy(t,e){e.classHierarchy.push("vtkScalarsToColors"),t.setVectorModeToMagnitude=function(){return t.setVectorMode(Xe.MAGNITUDE)},t.setVectorModeToComponent=function(){return t.setVectorMode(Xe.COMPONENT)},t.setVectorModeToRGBColors=function(){return t.setVectorMode(Xe.RGBCOLORS)},t.build=function(){},t.isOpaque=function(){return!0},t.setAnnotations=function(r,n){if(!(r&&!n||!r&&n)){if(r&&n&&r.length!==n.length){ks("Values and annotations do not have the same number of tuples so ignoring");return}if(e.annotationArray=[],n&&r)for(var a=n.length,i=0;i<a;i++)e.annotationArray.push({value:r[i],annotation:String(n[i])});t.updateAnnotatedValueMap(),t.modified()}},t.setAnnotation=function(r,n){var a=t.checkForAnnotatedValue(r),i=!1;return a>=0?e.annotationArray[a].annotation!==n&&(e.annotationArray[a].annotation=n,i=!0):(e.annotationArray.push({value:r,annotation:n}),a=e.annotationArray.length-1,i=!0),i&&(t.updateAnnotatedValueMap(),t.modified()),a},t.getNumberOfAnnotatedValues=function(){return e.annotationArray.length},t.getAnnotatedValue=function(r){return r<0||r>=e.annotationArray.length?null:e.annotationArray[r].value},t.getAnnotation=function(r){return e.annotationArray[r]===void 0?null:e.annotationArray[r].annotation},t.getAnnotatedValueIndex=function(r){return e.annotationArray.length?t.checkForAnnotatedValue(r):-1},t.removeAnnotation=function(r){var n=t.checkForAnnotatedValue(r),a=n>=0;return a&&(e.annotationArray.splice(n,1),t.updateAnnotatedValueMap(),t.modified()),a},t.resetAnnotations=function(){e.annotationArray=[],e.annotatedValueMap=[],t.modified()},t.getAnnotationColor=function(r,n){if(e.indexedLookup){var a=t.getAnnotatedValueIndex(r);t.getIndexedColor(a,n)}else t.getColor(parseFloat(r),n),n[3]=1},t.checkForAnnotatedValue=function(r){return t.getAnnotatedValueIndexInternal(r)},t.getAnnotatedValueIndexInternal=function(r){if(e.annotatedValueMap[r]!==void 0){var n=e.annotationArray.length;return e.annotatedValueMap[r]%n}return-1},t.getIndexedColor=function(r,n){n[0]=0,n[1]=0,n[2]=0,n[3]=0},t.updateAnnotatedValueMap=function(){e.annotatedValueMap=[];for(var r=e.annotationArray.length,n=0;n<r;n++)e.annotatedValueMap[e.annotationArray[n].value]=n},t.mapScalars=function(r,n,a){var i=r.getNumberOfComponents(),s=null;if(n===en.DEFAULT&&r.getDataType()===St.UNSIGNED_CHAR||n===en.DIRECT_SCALARS&&r)s=t.convertToRGBA(r,i,r.getNumberOfTuples());else{var f={type:"vtkDataArray",name:"temp",numberOfComponents:4,dataType:St.UNSIGNED_CHAR},o=d.newTypedArray(f.dataType,4*r.getNumberOfTuples());f.values=o,f.size=o.length,s=ve.newInstance(f);var u=a;u<0&&i>1?t.mapVectorsThroughTable(r,s,Vs.RGBA,-1,-1):(u<0&&(u=0),u>=i&&(u=i-1),t.mapScalarsThroughTable(r,s,Vs.RGBA,u))}return s},t.mapVectorsToMagnitude=function(r,n,a){for(var i=r.getNumberOfTuples(),s=r.getNumberOfComponents(),f=n.getData(),o=r.getData(),u=0;u<i;u++){for(var c=0,g=0;g<a;g++)c+=o[u*s+g]*o[u*s+g];f[u]=Math.sqrt(c)}},t.mapVectorsThroughTable=function(r,n,a,i,s){var f=t.getVectorMode(),o=s,u=i,c=r.getNumberOfComponents();f===Xe.COMPONENT?(u===-1&&(u=t.getVectorComponent()),u<0&&(u=0),u>=c&&(u=c-1)):(o===-1&&(o=t.getVectorSize()),o<=0?(u=0,o=c):(u<0&&(u=0),u>=c&&(u=c-1),u+o>c&&(o=c-u)),f===Xe.MAGNITUDE&&(c===1||o===1)&&(f=Xe.COMPONENT));var g=0;switch(u>0&&(g=u),f){case Xe.COMPONENT:{t.mapScalarsThroughTable(r,n,a,g);break}case Xe.RGBCOLORS:break;case Xe.MAGNITUDE:default:{var v=ve.newInstance({numberOfComponents:1,values:new Float32Array(r.getNumberOfTuples())});t.mapVectorsToMagnitude(r,v,o),t.mapScalarsThroughTable(v,n,a,0);break}}},t.luminanceToRGBA=function(r,n,a,i){for(var s=i(a),f=n.getData(),o=r.getData(),u=f.length,c=0,g=1,v=0,p=c;p<u;p+=g){var l=i(f[p]);o[v*4]=l,o[v*4+1]=l,o[v*4+2]=l,o[v*4+3]=s,v++}},t.luminanceAlphaToRGBA=function(r,n,a,i){for(var s=n.getData(),f=r.getData(),o=s.length,u=0,c=2,g=0,v=u;v<o;v+=c){var p=i(s[v]);f[g]=p,f[g+1]=p,f[g+2]=p,f[g+3]=i(s[v+1])*a,g+=4}},t.rGBToRGBA=function(r,n,a,i){for(var s=Bs(a),f=n.getData(),o=r.getData(),u=f.length,c=0,g=3,v=0,p=c;p<u;p+=g)o[v*4]=i(f[p]),o[v*4+1]=i(f[p+1]),o[v*4+2]=i(f[p+2]),o[v*4+3]=s,v++},t.rGBAToRGBA=function(r,n,a,i){for(var s=n.getData(),f=r.getData(),o=s.length,u=0,c=4,g=0,v=u;v<o;v+=c)f[g*4]=i(s[v]),f[g*4+1]=i(s[v+1]),f[g*4+2]=i(s[v+2]),f[g*4+3]=i(s[v+3])*a,g++},t.convertToRGBA=function(r,n,a){var i=e.alpha;if(n===4&&i>=1&&r.getDataType()===St.UNSIGNED_CHAR)return r;var s=ve.newInstance({numberOfComponents:4,empty:!0,size:4*a,dataType:St.UNSIGNED_CHAR});if(a<=0)return s;i=i>0?i:0,i=i<1?i:1;var f=By;switch((r.getDataType()===St.FLOAT||r.getDataType()===St.DOUBLE)&&(f=Bs),n){case 1:t.luminanceToRGBA(s,r,i,f);break;case 2:t.luminanceAlphaToRGBA(s,r,f);break;case 3:t.rGBToRGBA(s,r,i,f);break;case 4:t.rGBAToRGBA(s,r,i,f);break;default:return ks("Cannot convert colors"),null}return s},t.usingLogScale=function(){return!1},t.getNumberOfAvailableColors=function(){return 256*256*256},t.setRange=function(r,n){return t.setMappingRange(r,n)},t.getRange=function(){return t.getMappingRange()},t.areScalarsOpaque=function(r,n,a){if(!r)return t.isOpaque();var i=r.getNumberOfComponents();if(n===en.DEFAULT&&r.getDataType()===St.UNSIGNED_CHAR||n===en.DIRECT_SCALARS){if(i===3||i===1)return e.alpha>=1;var s=r.getRange(i-1);return s[0]===255}return!0}}var Ny={alpha:1,vectorComponent:0,vectorSize:-1,vectorMode:Xe.COMPONENT,mappingRange:null,annotationArray:null,annotatedValueMap:null,indexedLookup:!1};function Bu(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Ny,r),d.obj(t,e),e.mappingRange=[0,255],e.annotationArray=[],e.annotatedValueMap=[],d.setGet(t,e,["vectorSize","vectorComponent","vectorMode","alpha","indexedLookup"]),d.setArray(t,e,["mappingRange"],2),d.getArray(t,e,["mappingRange"]),Uy(t,e)}var Fy=d.newInstance(Bu,"vtkScalarsToColors"),Uu=ky({newInstance:Fy,extend:Bu},zn),Us=d.vtkErrorMacro,Ns=0,Fs=1,aa=2;function my(t,e){e.classHierarchy.push("vtkLookupTable"),t.isOpaque=function(){if(e.opaqueFlagBuildTime.getMTime()<t.getMTime()){var r=!0;e.nanColor[3]<1&&(r=0),e.useBelowRangeColor&&e.belowRangeColor[3]<1&&(r=0),e.useAboveRangeColor&&e.aboveRangeColor[3]<1&&(r=0);for(var n=3;n<e.table.length&&r;n+=4)e.table[n]<255&&(r=!1);e.opaqueFlag=r,e.opaqueFlagBuildTime.modified()}return e.opaqueFlag},t.usingLogScale=function(){return!1},t.getNumberOfAvailableColors=function(){return e.table.length/4},t.linearIndexLookup=function(r,n){var a=0;return r<n.range[0]?a=n.maxIndex+Ns+1.5:r>n.range[1]?a=n.maxIndex+Fs+1.5:(a=(r+n.shift)*n.scale,a=a<n.maxIndex?a:n.maxIndex),Math.floor(a)},t.linearLookup=function(r,n,a){var i=0;Af(r)?i=Math.floor(a.maxIndex+1.5+aa):i=t.linearIndexLookup(r,a);var s=4*i;return n.slice(s,s+4)},t.indexedLookupFunction=function(r,n,a){var i=t.getAnnotatedValueIndexInternal(r);i===-1&&(i=e.numberOfColors+aa);var s=4*i;return[n[s],n[s+1],n[s+2],n[s+3]]},t.lookupShiftAndScale=function(r,n){n.shift=-r[0],n.scale=Number.MAX_VALUE,r[1]>r[0]&&(n.scale=(n.maxIndex+1)/(r[1]-r[0]))},t.mapScalarsThroughTable=function(r,n,a,i){var s=t.linearLookup;e.indexedLookup&&(s=t.indexedLookupFunction);var f=t.getMappingRange(),o={maxIndex:t.getNumberOfColors()-1,range:f,shift:0,scale:0};t.lookupShiftAndScale(f,o);var u=t.getAlpha(),c=r.getNumberOfTuples(),g=r.getNumberOfComponents(),v=n.getData(),p=r.getData();if(u>=1){if(a===Aa.RGBA)for(var l=0;l<c;l++){var y=s(p[l*g+i],e.table,o);v[l*4]=y[0],v[l*4+1]=y[1],v[l*4+2]=y[2],v[l*4+3]=y[3]}}else if(a===Aa.RGBA)for(var h=0;h<c;h++){var T=s(p[h*g+i],e.table,o);v[h*4]=T[0],v[h*4+1]=T[1],v[h*4+2]=T[2],v[h*4+3]=Math.floor(T[3]*u+.5)}},t.forceBuild=function(){var r=0,n=0,a=0,i=0,s=e.numberOfColors-1;s&&(r=(e.hueRange[1]-e.hueRange[0])/s,n=(e.saturationRange[1]-e.saturationRange[0])/s,a=(e.valueRange[1]-e.valueRange[0])/s,i=(e.alphaRange[1]-e.alphaRange[0])/s),e.table.length=4*s+16;for(var f=[],o=[],u=0;u<=s;u++)f[0]=e.hueRange[0]+u*r,f[1]=e.saturationRange[0]+u*n,f[2]=e.valueRange[0]+u*a,ah(f,o),o[3]=e.alphaRange[0]+u*i,e.table[u*4]=o[0]*255+.5,e.table[u*4+1]=o[1]*255+.5,e.table[u*4+2]=o[2]*255+.5,e.table[u*4+3]=o[3]*255+.5;t.buildSpecialColors(),e.buildTime.modified()},t.setTable=function(r){if(r.getNumberOfComponents()!==4){Us("Expected 4 components for RGBA colors");return}if(r.getDataType()!==mr.UNSIGNED_CHAR){Us("Expected unsigned char values for RGBA colors");return}e.numberOfColors=r.getNumberOfTuples();var n=r.getData();e.table.length=n.length;for(var a=0;a<n.length;a++)e.table[a]=n[a];t.buildSpecialColors(),e.insertTime.modified(),t.modified()},t.buildSpecialColors=function(){var r=e.numberOfColors,n=e.table,a=(r+Ns)*4;e.useBelowRangeColor||r===0?(n[a]=e.belowRangeColor[0]*255+.5,n[a+1]=e.belowRangeColor[1]*255+.5,n[a+2]=e.belowRangeColor[2]*255+.5,n[a+3]=e.belowRangeColor[3]*255+.5):(n[a]=n[0],n[a+1]=n[1],n[a+2]=n[2],n[a+3]=n[3]),a=(r+Fs)*4,e.useAboveRangeColor||r===0?(n[a]=e.aboveRangeColor[0]*255+.5,n[a+1]=e.aboveRangeColor[1]*255+.5,n[a+2]=e.aboveRangeColor[2]*255+.5,n[a+3]=e.aboveRangeColor[3]*255+.5):(n[a]=n[4*(r-1)+0],n[a+1]=n[4*(r-1)+1],n[a+2]=n[4*(r-1)+2],n[a+3]=n[4*(r-1)+3]),a=(r+aa)*4,n[a]=e.nanColor[0]*255+.5,n[a+1]=e.nanColor[1]*255+.5,n[a+2]=e.nanColor[2]*255+.5,n[a+3]=e.nanColor[3]*255+.5},t.build=function(){(e.table.length<1||t.getMTime()>e.buildTime.getMTime()&&e.insertTime.getMTime()<=e.buildTime.getMTime())&&t.forceBuild()},e.table.length>0&&e.insertTime.modified()}var Gy={numberOfColors:256,hueRange:[0,.66667],saturationRange:[1,1],valueRange:[1,1],alphaRange:[1,1],nanColor:[.5,0,0,1],belowRangeColor:[0,0,0,1],aboveRangeColor:[1,1,1,1],useAboveRangeColor:!1,useBelowRangeColor:!1,alpha:1};function Nu(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Gy,r),Uu.extend(t,e,r),e.table||(e.table=[]),e.buildTime={},d.obj(e.buildTime),e.opaqueFlagBuildTime={},d.obj(e.opaqueFlagBuildTime,{mtime:0}),e.insertTime={},d.obj(e.insertTime,{mtime:0}),d.get(t,e,["buildTime"]),d.setGet(t,e,["numberOfColors","useAboveRangeColor","useBelowRangeColor"]),d.setArray(t,e,["alphaRange","hueRange","saturationRange","valueRange"],2),d.setArray(t,e,["nanColor","belowRangeColor","aboveRangeColor"],4),d.getArray(t,e,["hueRange","saturationRange","valueRange","alphaRange","nanColor","belowRangeColor","aboveRangeColor"]),my(t,e)}var _y=d.newInstance(Nu,"vtkLookupTable"),hr={newInstance:_y,extend:Nu},Fu=1,di=0,Ay=["VTK_RESOLVE_OFF","VTK_RESOLVE_POLYGON_OFFSET"];function $y(){return Fu}function Wy(t){Fu=t}function zy(){return di}function jn(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;di=t}function jy(){jn(0)}function Hy(){jn(0)}function Py(){jn(1)}function Ky(){return Ay[di]}var $a={getResolveCoincidentTopologyAsString:Ky,getResolveCoincidentTopologyPolygonOffsetFaces:$y,getResolveCoincidentTopology:zy,setResolveCoincidentTopology:jn,setResolveCoincidentTopologyPolygonOffsetFaces:Wy,setResolveCoincidentTopologyToDefault:jy,setResolveCoincidentTopologyToOff:Hy,setResolveCoincidentTopologyToPolygonOffset:Py};function mu(t,e,r){r.forEach(function(n){t["get".concat(n.method)]=function(){return e[n.key]},t["set".concat(n.method)]=function(a,i){e[n.key]={factor:a,offset:i}}})}var Oi=["Polygon","Line","Point"],Xy={Polygon:{factor:2,offset:0},Line:{factor:1,offset:-1},Point:{factor:0,offset:-2}},Rt={};mu(Rt,Xy,Oi.map(function(t){return{key:t,method:"ResolveCoincidentTopology".concat(t,"OffsetParameters")}}));function Yy(t,e){e.resolveCoincidentTopology===void 0&&(e.resolveCoincidentTopology=!1),d.setGet(t,e,["resolveCoincidentTopology"]),e.topologyOffset={Polygon:{factor:0,offset:0},Line:{factor:0,offset:0},Point:{factor:0,offset:0}},Object.keys($a).forEach(function(r){t[r]=$a[r]}),Object.keys(Rt).forEach(function(r){t[r]=Rt[r]}),mu(t,e.topologyOffset,Oi.map(function(r){return{key:r,method:"RelativeCoincidentTopology".concat(r,"OffsetParameters")}})),t.getCoincidentTopologyPolygonOffsetParameters=function(){var r=Rt.getResolveCoincidentTopologyPolygonOffsetParameters(),n=t.getRelativeCoincidentTopologyPolygonOffsetParameters();return{factor:r.factor+n.factor,offset:r.offset+n.offset}},t.getCoincidentTopologyLineOffsetParameters=function(){var r=Rt.getResolveCoincidentTopologyLineOffsetParameters(),n=t.getRelativeCoincidentTopologyLineOffsetParameters();return{factor:r.factor+n.factor,offset:r.offset+n.offset}},t.getCoincidentTopologyPointOffsetParameter=function(){var r=Rt.getResolveCoincidentTopologyPointOffsetParameters(),n=t.getRelativeCoincidentTopologyPointOffsetParameters();return{factor:r.factor+n.factor,offset:r.offset+n.offset}}}var Si={implementCoincidentTopologyMethods:Yy,staticOffsetAPI:Rt,otherStaticMethods:$a,CATEGORIES:Oi},Ee={MIN_KNOWN_PASS:0,ACTOR_PASS:0,COMPOSITE_INDEX_PASS:1,ID_LOW24:2,ID_HIGH24:3,MAX_KNOWN_PASS:3};function ms(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function ia(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ms(Object(r),!0).forEach(function(n){K(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ms(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var Gs=Wn.FieldAssociations,Iy=Si.staticOffsetAPI,Qy=Si.otherStaticMethods,sa=Tt.ColorMode,Ct=Tt.ScalarMode,oa=Tt.GetArray,qy=zn.VectorMode,Zy=ve.VtkDataTypes;function cr(t){return function(){return d.vtkErrorMacro("vtkMapper::".concat(t," - NOT IMPLEMENTED"))}}function Jy(t,e){e.classHierarchy.push("vtkMapper"),t.getBounds=function(){var r=t.getInputData();return r?(e.static||t.update(),e.bounds=r.getBounds()):e.bounds=sh(),e.bounds},t.setForceCompileOnly=function(r){e.forceCompileOnly=r},t.createDefaultLookupTable=function(){e.lookupTable=hr.newInstance()},t.getColorModeAsString=function(){return d.enumToString(sa,e.colorMode)},t.setColorModeToDefault=function(){return t.setColorMode(0)},t.setColorModeToMapScalars=function(){return t.setColorMode(1)},t.setColorModeToDirectScalars=function(){return t.setColorMode(2)},t.getScalarModeAsString=function(){return d.enumToString(Ct,e.scalarMode)},t.setScalarModeToDefault=function(){return t.setScalarMode(0)},t.setScalarModeToUsePointData=function(){return t.setScalarMode(1)},t.setScalarModeToUseCellData=function(){return t.setScalarMode(2)},t.setScalarModeToUsePointFieldData=function(){return t.setScalarMode(3)},t.setScalarModeToUseCellFieldData=function(){return t.setScalarMode(4)},t.setScalarModeToUseFieldData=function(){return t.setScalarMode(5)},t.getAbstractScalars=function(r,n,a,i,s){if(!r||!e.scalarVisibility)return{scalars:null,cellFLag:!1};var f=null,o=!1;if(n===Ct.DEFAULT)f=r.getPointData().getScalars(),f||(f=r.getCellData().getScalars(),o=!0);else if(n===Ct.USE_POINT_DATA)f=r.getPointData().getScalars();else if(n===Ct.USE_CELL_DATA)f=r.getCellData().getScalars(),o=!0;else if(n===Ct.USE_POINT_FIELD_DATA){var u=r.getPointData();a===oa.BY_ID?f=u.getArrayByIndex(i):f=u.getArrayByName(s)}else if(n===Ct.USE_CELL_FIELD_DATA){var c=r.getCellData();o=!0,a===oa.BY_ID?f=c.getArrayByIndex(i):f=c.getArrayByName(s)}else if(n===Ct.USE_FIELD_DATA){var g=r.getFieldData();a===oa.BY_ID?f=g.getArrayByIndex(i):f=g.getArrayByName(s)}return{scalars:f,cellFlag:o}},t.mapScalars=function(r,n){var a=t.getAbstractScalars(r,e.scalarMode,e.arrayAccessMode,e.arrayId,e.colorByArrayName).scalars;if(!a){e.colorCoordinates=null,e.colorTextureMap=null,e.colorMapColors=null;return}var i="".concat(t.getMTime()).concat(a.getMTime()).concat(n);if(e.colorBuildString!==i){if(e.useLookupTableScalarRange||t.getLookupTable().setRange(e.scalarRange[0],e.scalarRange[1]),t.canUseTextureMapForColoring(r))t.mapScalarsToTexture(a,n);else{e.colorCoordinates=null,e.colorTextureMap=null;var s=t.getLookupTable();s&&(s.build(),e.colorMapColors=s.mapScalars(a,e.colorMode,e.fieldDataTupleId))}e.colorBuildString="".concat(t.getMTime()).concat(a.getMTime()).concat(n)}},t.scalarToTextureCoordinate=function(r,n,a){var i=.5,s=1;return Af(r)||(s=.49,i=(r-n)*a,i>1e3?i=1e3:i<-1e3&&(i=-1e3)),{texCoordS:i,texCoordT:s}},t.createColorTextureCoordinates=function(r,n,a,i,s,f,o,u,c){var g=(f[1]-f[0])/u,v=[];v[0]=f[0]-g,v[1]=f[1]+g;var p=1/(v[1]-v[0]),l=n.getData(),y=r.getData(),h=0,T=0;if(s<0||s>=i)for(var x=0;x<a;++x){for(var S=0,O=0;O<i;++O)S+=y[h]*y[h],h++;var C=Math.sqrt(S);c&&(C=hr.applyLogScale(C,o,f));var w=t.scalarToTextureCoordinate(C,v[0],p);l[T]=w.texCoordS,l[T+1]=w.texCoordT,T+=2}else{h+=s;for(var E=0;E<a;++E){var M=y[h];c&&(M=hr.applyLogScale(M,o,f));var L=t.scalarToTextureCoordinate(M,v[0],p);l[T]=L.texCoordS,l[T+1]=L.texCoordT,T+=2,h+=i}}},t.mapScalarsToTexture=function(r,n){var a=e.lookupTable.getRange(),i=e.lookupTable.usingLogScale();i&&hr.getLogRange(a,a);var s=e.lookupTable.getAlpha();if(e.colorMapColors=null,e.colorTextureMap==null||t.getMTime()>e.colorTextureMap.getMTime()||e.lookupTable.getMTime()>e.colorTextureMap.getMTime()||e.lookupTable.getAlpha()!==n){e.lookupTable.setAlpha(n),e.colorTextureMap=null,e.lookupTable.build();var f=e.lookupTable.getNumberOfAvailableColors();f>4094&&(f=4094),f+=2;for(var o=(a[1]-a[0])/(f-1-2),u=new Float64Array(f*2),c=0;c<f;++c)u[c]=a[0]+c*o-o,i&&(u[c]=Math.pow(10,u[c]));for(var g=0;g<f;++g)u[g+f]=NaN;e.colorTextureMap=Dy.newInstance(),e.colorTextureMap.setExtent(0,f-1,0,1,0,0);var v=ve.newInstance({numberOfComponents:1,values:u});e.colorTextureMap.getPointData().setScalars(e.lookupTable.mapScalars(v,e.colorMode,0)),e.lookupTable.setAlpha(s)}if(!e.colorCoordinates||t.getMTime()>e.colorCoordinates.getMTime()||t.getInputData(0).getMTime()>e.colorCoordinates.getMTime()||e.lookupTable.getMTime()>e.colorCoordinates.getMTime()){e.colorCoordinates=null;var p=r.getNumberOfComponents(),l=r.getNumberOfTuples();e.colorCoordinates=ve.newInstance({numberOfComponents:2,values:new Float32Array(l*2)});var y=e.lookupTable.getVectorComponent();e.lookupTable.getVectorMode()===qy.MAGNITUDE&&r.getNumberOfComponents()>1&&(y=-1),t.createColorTextureCoordinates(r,e.colorCoordinates,l,p,y,a,e.lookupTable.getRange(),e.colorTextureMap.getPointData().getScalars().getNumberOfTuples()/2-2,i)}},t.getIsOpaque=function(){var r=t.getInputData(),n=t.getAbstractScalars(r,e.scalarMode,e.arrayAccessMode,e.arrayId,e.colorByArrayName),a=n.scalars;if(!e.scalarVisibility||a==null)return!0;var i=t.getLookupTable();return i?(i.build(),i.areScalarsOpaque(a,e.colorMode,-1)):!0},t.canUseTextureMapForColoring=function(r){if(!e.interpolateScalarsBeforeMapping||e.lookupTable&&e.lookupTable.getIndexedLookup())return!1;var n=t.getAbstractScalars(r,e.scalarMode,e.arrayAccessMode,e.arrayId,e.colorByArrayName),a=n.scalars;return!(!a||n.cellFlag||e.colorMode===sa.DEFAULT&&a.getDataType()===Zy.UNSIGNED_CHAR||e.colorMode===sa.DIRECT_SCALARS)},t.clearColorArrays=function(){e.colorMapColors=null,e.colorCoordinates=null,e.colorTextureMap=null},t.getLookupTable=function(){return e.lookupTable||t.createDefaultLookupTable(),e.lookupTable},t.getMTime=function(){var r=e.mtime;if(e.lookupTable!==null){var n=e.lookupTable.getMTime();r=n>r?n:r}return r},t.getPrimitiveCount=function(){var r=t.getInputData(),n={points:r.getPoints().getNumberOfValues()/3,verts:r.getVerts().getNumberOfValues()-r.getVerts().getNumberOfCells(),lines:r.getLines().getNumberOfValues()-2*r.getLines().getNumberOfCells(),triangles:r.getPolys().getNumberOfValues()-3*r.getPolys().getNumberOfCells()};return n},t.acquireInvertibleLookupTable=cr("AcquireInvertibleLookupTable"),t.valueToColor=cr("ValueToColor"),t.colorToValue=cr("ColorToValue"),t.useInvertibleColorFor=cr("UseInvertibleColorFor"),t.clearInvertibleColor=cr("ClearInvertibleColor"),t.processSelectorPixelBuffers=function(r,n){if(!(!r||!e.selectionWebGLIdsToVTKIds||!e.populateSelectionSettings)){var a=r.getRawPixelBuffer(Ee.ID_LOW24),i=r.getRawPixelBuffer(Ee.ID_HIGH24),s=r.getCurrentPass(),f=r.getFieldAssociation(),o=null;f===Gs.FIELD_ASSOCIATION_POINTS?o=e.selectionWebGLIdsToVTKIds.points:f===Gs.FIELD_ASSOCIATION_CELLS&&(o=e.selectionWebGLIdsToVTKIds.cells),o&&n.forEach(function(u){if(s===Ee.ID_LOW24){var c=0;i&&(c+=i[u],c*=256),c+=a[u+2],c*=256,c+=a[u+1],c*=256,c+=a[u];var g=o[c],v=r.getPixelBuffer(Ee.ID_LOW24);v[u]=g&255,v[u+1]=(g&65280)>>8,v[u+2]=(g&16711680)>>16}else if(s===Ee.ID_HIGH24&&i){var p=0;p+=i[u],p*=256,p+=a[u],p*=256,p+=a[u+1],p*=256,p+=a[u+2];var l=o[p],y=r.getPixelBuffer(Ee.ID_HIGH24);y[u]=(l&4278190080)>>24}})}}}var e1={colorMapColors:null,static:!1,lookupTable:null,scalarVisibility:!0,scalarRange:[0,1],useLookupTableScalarRange:!1,colorMode:0,scalarMode:0,arrayAccessMode:1,renderTime:0,colorByArrayName:null,fieldDataTupleId:-1,populateSelectionSettings:!0,selectionWebGLIdsToVTKIds:null,interpolateScalarsBeforeMapping:!1,colorCoordinates:null,colorTextureMap:null,forceCompileOnly:0,useInvertibleColors:!1,invertibleScalars:null,viewSpecificProperties:null,customShaderAttributes:[]};function Gu(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,e1,r),qh.extend(t,e,r),d.get(t,e,["colorCoordinates","colorMapColors","colorTextureMap"]),d.setGet(t,e,["colorByArrayName","arrayAccessMode","colorMode","fieldDataTupleId","interpolateScalarsBeforeMapping","lookupTable","populateSelectionSettings","renderTime","scalarMode","scalarVisibility","selectionWebGLIdsToVTKIds","static","useLookupTableScalarRange","viewSpecificProperties","customShaderAttributes"]),d.setGetArray(t,e,["scalarRange"],2),e.viewSpecificProperties||(e.viewSpecificProperties={}),Si.implementCoincidentTopologyMethods(t,e),Jy(t,e)}var t1=d.newInstance(Gu,"vtkMapper"),ar=ia(ia(ia({newInstance:t1,extend:Gu},Iy),Qy),Tt);function _s(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Ci(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?_s(Object(r),!0).forEach(function(n){K(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):_s(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function _u(t){var e=0;return t.filter(function(r,n){return n===e?(e+=r+1,!0):!1})}function Au(t){for(var e=0,r=0;r<t.length;)r+=t[r]+1,e++;return e}var r1={extractCellSizes:_u,getNumberOfCells:Au};function n1(t,e){e.classHierarchy.push("vtkCellArray");var r=Ci({},t);t.getNumberOfCells=function(n){return e.numberOfCells!==void 0&&!n||(e.cellSizes?e.numberOfCells=e.cellSizes.length:e.numberOfCells=Au(t.getData())),e.numberOfCells},t.getCellSizes=function(n){return e.cellSizes!==void 0&&!n||(e.cellSizes=_u(t.getData())),e.cellSizes},t.resize=function(n){var a=t.getNumberOfTuples();r.resize(n);var i=t.getNumberOfTuples();i<a&&(i===0?(e.numberOfCells=0,e.cellSizes=[]):(e.numberOfCells=void 0,e.cellSizes=void 0))},t.setData=function(n){r.setData(n,1),e.numberOfCells=void 0,e.cellSizes=void 0},t.getCell=function(n){var a=n,i=e.values[a++];return e.values.subarray(a,a+i)},t.insertNextCell=function(n){var a=t.getNumberOfCells();return t.insertNextTuples([n.length].concat(re(n))),++e.numberOfCells,e.cellSizes!=null&&e.cellSizes.push(n.length),a}}function a1(t){return Ci({empty:!0,numberOfComponents:1,dataType:mr.UNSIGNED_INT},t)}function $u(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};ve.extend(t,e,a1(r)),n1(t,e)}var i1=d.newInstance($u,"vtkCellArray"),As=Ci({newInstance:i1,extend:$u},r1),s1=d.vtkErrorMacro,o1=[1,-1,1,-1,1,-1];function f1(t,e){e.classHierarchy.push("vtkPoints"),t.getNumberOfPoints=t.getNumberOfTuples,t.setNumberOfPoints=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3;t.getNumberOfPoints()!==r&&(e.size=r*n,e.values=d.newTypedArray(e.dataType,e.size),t.setNumberOfComponents(n),t.modified())},t.setPoint=function(r){for(var n=arguments.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];t.setTuple(r,a)},t.getPoint=t.getTuple,t.insertNextPoint=function(r,n,a){return t.insertNextTuple([r,n,a])},t.getBounds=function(){if(t.getNumberOfComponents()===3){var r=t.getRange(0);e.bounds[0]=r[0],e.bounds[1]=r[1];var n=t.getRange(1);e.bounds[2]=n[0],e.bounds[3]=n[1];var a=t.getRange(2);return e.bounds[4]=a[0],e.bounds[5]=a[1],e.bounds}if(t.getNumberOfComponents()!==2)return s1(`getBounds called on an array with components of
        `.concat(t.getNumberOfComponents())),o1;var i=t.getRange(0);e.bounds[0]=i[0],e.bounds[1]=i[1];var s=t.getRange(1);return e.bounds[2]=s[0],e.bounds[3]=s[1],e.bounds[4]=0,e.bounds[5]=0,e.bounds},t.computeBounds=t.getBounds,t.setNumberOfComponents(e.numberOfComponents<2?3:e.numberOfComponents)}var u1={empty:!0,numberOfComponents:3,dataType:mr.FLOAT,bounds:[1,-1,1,-1,1,-1]};function Wu(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,u1,r),ve.extend(t,e,r),f1(t,e)}var c1=d.newInstance(Wu,"vtkPoints"),Fn={newInstance:c1,extend:Wu};function g1(t,e){e.classHierarchy.push("vtkCell"),t.initialize=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(n){e.pointsIds=n;var i=e.points.getData();i.length!==3*e.pointsIds.length&&(i=d.newTypedArray(r.getDataType(),3*e.pointsIds.length));var s=r.getData();e.pointsIds.forEach(function(f,o){var u=3*f,c=3*o;i[c]=s[u],i[++c]=s[++u],i[++c]=s[++u]}),e.points.setData(i)}else{e.points=r,e.pointsIds=new Array(r.getNumberOfPoints());for(var a=r.getNumberOfPoints()-1;a>=0;--a)e.pointsIds[a]=a}},t.getBounds=function(){var r=e.points.getNumberOfPoints(),n=[];if(r){e.points.getPoint(0,n),e.bounds[0]=n[0],e.bounds[1]=n[0],e.bounds[2]=n[1],e.bounds[3]=n[1],e.bounds[4]=n[2],e.bounds[5]=n[2];for(var a=1;a<r;a++)e.points.getPoint(a,n),e.bounds[0]=n[0]<e.bounds[0]?n[0]:e.bounds[0],e.bounds[1]=n[0]>e.bounds[1]?n[0]:e.bounds[1],e.bounds[2]=n[1]<e.bounds[2]?n[1]:e.bounds[2],e.bounds[3]=n[1]>e.bounds[3]?n[1]:e.bounds[3],e.bounds[4]=n[2]<e.bounds[4]?n[2]:e.bounds[4],e.bounds[5]=n[2]>e.bounds[5]?n[2]:e.bounds[5]}else oi(e.bounds);return e.bounds},t.getLength2=function(){t.getBounds();for(var r=0,n=0,a=0;a<3;a++)n=e.bounds[2*a+1]-e.bounds[2*a],r+=n*n;return r},t.getParametricDistance=function(r){for(var n,a=0,i=0;i<3;i++)r[i]<0?n=-r[i]:r[i]>1?n=r[i]-1:n=0,n>a&&(a=n);return a},t.getNumberOfPoints=function(){return e.points.getNumberOfPoints()},t.deepCopy=function(r){r.initialize(e.points,e.pointsIds)},t.getCellDimension=function(){},t.intersectWithLine=function(r,n,a,i,s,f,o){},t.evaluatePosition=function(r,n,a,i,s,f){d.vtkErrorMacro("vtkCell.evaluatePosition is not implemented.")}}var v1={bounds:[-1,-1,-1,-1,-1,-1],pointsIds:[]};function zu(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,v1,r),d.obj(t,e),e.points||(e.points=Fn.newInstance()),d.get(t,e,["points","pointsIds"]),g1(t,e)}var p1=d.newInstance(zu,"vtkCell"),mn={newInstance:p1,extend:zu};function l1(t,e){var r=e;for(e>=t.array.length&&(r+=t.array.length);r>t.array.length;)t.array.push({ncells:0,cells:null});t.array.length=r}function h1(t,e){e.classHierarchy.push("vtkCellLinks"),t.buildLinks=function(r){var n=r.getPoints().getNumberOfPoints(),a=r.getNumberOfCells(),i=new Uint32Array(n);if(r.isA("vtkPolyData")){for(var s=0;s<a;++s){var f=r.getCellPoints(s),o=f.cellPointIds;o.forEach(function(y){t.incrementLinkCount(y)})}t.allocateLinks(n),e.maxId=n-1;for(var u=function(h){var T=r.getCellPoints(h),x=T.cellPointIds;x.forEach(function(S){t.insertCellReference(S,i[S]++,h)})},c=0;c<a;++c)u(c)}else{for(var g=0;g<a;g++){var v=mn.newInstance();v.getPointsIds().forEach(function(y){t.incrementLinkCount(y)})}t.allocateLinks(n),e.maxId=n-1;for(var p=function(h){var T=mn.newInstance();T.getPointsIds().forEach(function(x){t.insertCellReference(x,i[x]++,h)})},l=0;l<a;++l)p(l)}},t.allocate=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3;e.array=Array(r).fill().map(function(){return{ncells:0,cells:null}}),e.extend=n,e.maxId=-1},t.initialize=function(){e.array=null},t.getLink=function(r){return e.array[r]},t.getNcells=function(r){return e.array[r].ncells},t.getCells=function(r){return e.array[r].cells},t.insertNextPoint=function(r){e.array.push({ncells:r,cells:Array(r)}),++e.maxId},t.insertNextCellReference=function(r,n){e.array[r].cells[e.array[r].ncells++]=n},t.deletePoint=function(r){e.array[r].ncells=0,e.array[r].cells=null},t.removeCellReference=function(r,n){e.array[n].cells=e.array[n].cells.filter(function(a){return a!==r}),e.array[n].ncells=e.array[n].cells.length},t.addCellReference=function(r,n){e.array[n].cells[e.array[n].ncells++]=r},t.resizeCellList=function(r,n){e.array[r].cells.length=n},t.squeeze=function(){l1(e,e.maxId+1)},t.reset=function(){e.maxId=-1},t.deepCopy=function(r){e.array=re(r.array),e.extend=r.extend,e.maxId=r.maxId},t.incrementLinkCount=function(r){++e.array[r].ncells},t.allocateLinks=function(r){for(var n=0;n<r;++n)e.array[n].cells=new Array(e.array[n].ncells)},t.insertCellReference=function(r,n,a){e.array[r].cells[n]=a}}var y1={array:null,maxId:0,extend:0};function ju(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,y1,r),d.obj(t,e),h1(t,e)}var T1=d.newInstance(ju,"vtkCellLinks"),x1={newInstance:T1,extend:ju},Z={VTK_EMPTY_CELL:0,VTK_VERTEX:1,VTK_POLY_VERTEX:2,VTK_LINE:3,VTK_POLY_LINE:4,VTK_TRIANGLE:5,VTK_TRIANGLE_STRIP:6,VTK_POLYGON:7,VTK_PIXEL:8,VTK_QUAD:9,VTK_TETRA:10,VTK_VOXEL:11,VTK_HEXAHEDRON:12,VTK_WEDGE:13,VTK_PYRAMID:14,VTK_PENTAGONAL_PRISM:15,VTK_HEXAGONAL_PRISM:16,VTK_QUADRATIC_EDGE:21,VTK_QUADRATIC_TRIANGLE:22,VTK_QUADRATIC_QUAD:23,VTK_QUADRATIC_POLYGON:36,VTK_QUADRATIC_TETRA:24,VTK_QUADRATIC_HEXAHEDRON:25,VTK_QUADRATIC_WEDGE:26,VTK_QUADRATIC_PYRAMID:27,VTK_BIQUADRATIC_QUAD:28,VTK_TRIQUADRATIC_HEXAHEDRON:29,VTK_QUADRATIC_LINEAR_QUAD:30,VTK_QUADRATIC_LINEAR_WEDGE:31,VTK_BIQUADRATIC_QUADRATIC_WEDGE:32,VTK_BIQUADRATIC_QUADRATIC_HEXAHEDRON:33,VTK_BIQUADRATIC_TRIANGLE:34,VTK_CUBIC_LINE:35,VTK_CONVEX_POINT_SET:41,VTK_POLYHEDRON:42,VTK_PARAMETRIC_CURVE:51,VTK_PARAMETRIC_SURFACE:52,VTK_PARAMETRIC_TRI_SURFACE:53,VTK_PARAMETRIC_QUAD_SURFACE:54,VTK_PARAMETRIC_TETRA_REGION:55,VTK_PARAMETRIC_HEX_REGION:56,VTK_HIGHER_ORDER_EDGE:60,VTK_HIGHER_ORDER_TRIANGLE:61,VTK_HIGHER_ORDER_QUAD:62,VTK_HIGHER_ORDER_POLYGON:63,VTK_HIGHER_ORDER_TETRAHEDRON:64,VTK_HIGHER_ORDER_WEDGE:65,VTK_HIGHER_ORDER_PYRAMID:66,VTK_HIGHER_ORDER_HEXAHEDRON:67,VTK_LAGRANGE_CURVE:68,VTK_LAGRANGE_TRIANGLE:69,VTK_LAGRANGE_QUADRILATERAL:70,VTK_LAGRANGE_TETRAHEDRON:71,VTK_LAGRANGE_HEXAHEDRON:72,VTK_LAGRANGE_WEDGE:73,VTK_LAGRANGE_PYRAMID:74,VTK_NUMBER_OF_CELL_TYPES:75},Wa=["vtkEmptyCell","vtkVertex","vtkPolyVertex","vtkLine","vtkPolyLine","vtkTriangle","vtkTriangleStrip","vtkPolygon","vtkPixel","vtkQuad","vtkTetra","vtkVoxel","vtkHexahedron","vtkWedge","vtkPyramid","vtkPentagonalPrism","vtkHexagonalPrism","UnknownClass","UnknownClass","UnknownClass","UnknownClass","vtkQuadraticEdge","vtkQuadraticTriangle","vtkQuadraticQuad","vtkQuadraticTetra","vtkQuadraticHexahedron","vtkQuadraticWedge","vtkQuadraticPyramid","vtkBiQuadraticQuad","vtkTriQuadraticHexahedron","vtkQuadraticLinearQuad","vtkQuadraticLinearWedge","vtkBiQuadraticQuadraticWedge","vtkBiQuadraticQuadraticHexahedron","vtkBiQuadraticTriangle","vtkCubicLine","vtkQuadraticPolygon","UnknownClass","UnknownClass","UnknownClass","UnknownClass","vtkConvexPointSet","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","vtkParametricCurve","vtkParametricSurface","vtkParametricTriSurface","vtkParametricQuadSurface","vtkParametricTetraRegion","vtkParametricHexRegion","UnknownClass","UnknownClass","UnknownClass","vtkHigherOrderEdge","vtkHigherOrderTriangle","vtkHigherOrderQuad","vtkHigherOrderPolygon","vtkHigherOrderTetrahedron","vtkHigherOrderWedge","vtkHigherOrderPyramid","vtkHigherOrderHexahedron"];function $s(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function d1(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?$s(Object(r),!0).forEach(function(n){K(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):$s(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function O1(t){return t<Wa.length?Wa[t]:"UnknownClass"}function S1(t){return Wa.findIndex(t)}function C1(t){return t<Z.VTK_QUADRATIC_EDGE||t===Z.VTK_CONVEX_POINT_SET||t===Z.VTK_POLYHEDRON}function w1(t){return t===Z.VTK_TRIANGLE_STRIP||t===Z.VTK_POLY_LINE||t===Z.VTK_POLY_VERTEX}var E1={getClassNameFromTypeId:O1,getTypeIdFromClassName:S1,isLinear:C1,hasSubCells:w1};function M1(t,e){e.classHierarchy.push("vtkCellTypes"),t.allocate=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:512,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3;e.size=r>0?r:1,e.extend=n>0?n:1,e.maxId=-1,e.typeArray=new Uint8Array(r),e.locationArray=new Uint32Array(r)},t.insertCell=function(r,n,a){e.typeArray[r]=n,e.locationArray[r]=a,r>e.maxId&&(e.maxId=r)},t.insertNextCell=function(r,n){return t.insertCell(++e.maxId,r,n),e.maxId},t.setCellTypes=function(r,n,a){e.size=r,e.typeArray=n,e.locationArray=a,e.maxId=r-1},t.getCellLocation=function(r){return e.locationArray[r]},t.deleteCell=function(r){e.typeArray[r]=Z.VTK_EMPTY_CELL},t.getNumberOfTypes=function(){return e.maxId+1},t.isType=function(r){for(var n=t.getNumberOfTypes(),a=0;a<n;++a)if(r===t.getCellType(a))return!0;return!1},t.insertNextType=function(r){return t.insertNextCell(r,-1)},t.getCellType=function(r){return e.typeArray[r]},t.reset=function(){e.maxId=-1},t.deepCopy=function(r){t.allocate(r.getSize(),r.getExtend()),e.typeArray.set(r.getTypeArray()),e.locationArray.set(r.getLocationArray()),e.maxId=r.getMaxId()}}var D1={size:0,maxId:-1,extend:1e3};function Hu(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,D1,r),d.obj(t,e),d.get(t,e,["size","maxId","extend"]),d.getArray(t,e,["typeArray","locationArray"]),M1(t,e)}var b1=d.newInstance(Hu,"vtkCellTypes"),L1=d1({newInstance:b1,extend:Hu},E1),R1={NO_INTERSECTION:0,YES_INTERSECTION:1,ON_LINE:2},Pu={IntersectionState:R1};function Ws(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function zs(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ws(Object(r),!0).forEach(function(n){K(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ws(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var dn=Pu.IntersectionState;function qt(t,e,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,a={t:Number.MIN_VALUE,distance:0},i=[],s;i[0]=r[0]-e[0],i[1]=r[1]-e[1],i[2]=r[2]-e[2];var f=i[0]*(t[0]-e[0])+i[1]*(t[1]-e[1])+i[2]*(t[2]-e[2]),o=j(i,i),u=1e-5*f;return o!==0&&(a.t=f/o),u<0&&(u=-u),-u<o&&o<u||o<=0||a.t<0?s=e:a.t>1?s=r:(s=i,i[0]=e[0]+a.t*i[0],i[1]=e[1]+a.t*i[1],i[2]=e[2]+a.t*i[2]),n&&(n[0]=s[0],n[1]=s[1],n[2]=s[2]),a.distance=Je(s,t),a}function Ku(t,e,r,n,a,i){var s=[],f=[],o=[];a[0]=0,i[0]=0,yt(e,t,s),yt(n,r,f),yt(r,t,o);var u=[j(s,s),-j(s,f),-j(s,f),j(f,f)],c=[];if(c[0]=j(s,o),c[1]=-j(f,o),nh(u,c,2)===0){for(var g=Number.MAX_VALUE,v=[t,e,r,n],p=[r,r,t,t],l=[n,n,e,e],y=[i[0],i[0],a[0],a[0]],h=[a[0],a[0],i[0],i[0]],T,x=0;x<4;x++)T=qt(v[x],p[x],l[x]),T.distance<g&&(g=T.distance,y[x]=T.t,h[x]=x%2);return dn.ON_LINE}return a[0]=c[0],i[0]=c[1],a[0]>=0&&a[0]<=1&&i[0]>=0&&i[0]<=1?dn.YES_INTERSECTION:dn.NO_INTERSECTION}var V1={distanceToLine:qt,intersection:Ku};function k1(t,e){e.classHierarchy.push("vtkLine");function r(n){return n>=0&&n<=1}t.getCellDimension=function(){return 1},t.intersectWithLine=function(n,a,i,s,f){var o={intersect:0,t:Number.MAX_VALUE,subId:0,betweenPoints:null};f[1]=0,f[2]=0;var u=[],c=[],g=[];e.points.getPoint(0,c),e.points.getPoint(1,g);var v=[],p=[],l=Ku(n,a,c,g,v,p);if(o.t=v[0],o.betweenPoints=r(o.t),f[0]=p[0],l===dn.YES_INTERSECTION){for(var y=0;y<3;y++)s[y]=c[y]+f[0]*(g[y]-c[y]),u[y]=n[y]+o.t*(a[y]-n[y]);if(Je(s,u)<=i*i)return o.intersect=1,o}else{var h;if(o.t<0)return h=qt(n,c,g,s),h.distance<=i*i&&(o.t=0,o.intersect=1,o.betweenPoints=!0),o;if(o.t>1)return h=qt(a,c,g,s),h.distance<=i*i&&(o.t=1,o.intersect=1,o.betweenPoints=!0),o;if(f[0]<0)return f[0]=0,h=qt(c,n,a,s),o.t=h.t,h.distance<=i*i&&(o.intersect=1),o;if(f[0]>1)return f[0]=1,h=qt(g,n,a,s),o.t=h.t,h.distance<=i*i&&(o.intersect=1),o}return o},t.evaluateLocation=function(n,a,i){var s=[],f=[];e.points.getPoint(0,s),e.points.getPoint(1,f);for(var o=0;o<3;o++)a[o]=s[o]+n[0]*(f[o]-s[o]);i[0]=1-n[0],i[1]=n[0]}}var B1={};function Xu(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,B1,r),mn.extend(t,e,r),k1(t,e)}var U1=d.newInstance(Xu,"vtkLine"),Be=zs(zs({newInstance:U1,extend:Xu},V1),Pu);function N1(t,e){e.classHierarchy.push("vtkPointSet"),e.points?e.points=ze(e.points):e.points=Fn.newInstance(),t.getNumberOfPoints=function(){return e.points.getNumberOfPoints()},t.getBounds=function(){return e.points.getBounds()},t.computeBounds=function(){t.getBounds()};var r=t.shallowCopy;t.shallowCopy=function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;r(n,a),e.points=Fn.newInstance(),e.points.shallowCopy(n.getPoints())}}var F1={};function Yu(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,F1,r),Wn.extend(t,e,r),d.setGet(t,e,["points"]),N1(t,e)}var m1=d.newInstance(Yu,"vtkPointSet"),G1={newInstance:m1,extend:Yu};function js(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function _1(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?js(Object(r),!0).forEach(function(n){K(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):js(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function wi(t,e,r,n){var a=r[0]-e[0],i=r[1]-e[1],s=r[2]-e[2],f=t[0]-e[0],o=t[1]-e[1],u=t[2]-e[2];n[0]=i*u-s*o,n[1]=s*f-a*u,n[2]=a*o-i*f}function Gn(t,e,r,n){wi(t,e,r,n);var a=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);a!==0&&(n[0]/=a,n[1]/=a,n[2]/=a)}function A1(t,e,r,n,a,i){var s=arguments.length>6&&arguments[6]!==void 0?arguments[6]:1e-6,f=!1,o=[],u=[],c=[],g=[],v=[];Gn(t,e,r,g),Gn(n,a,i,v);var p=-j(g,t),l=-j(v,n),y=[j(v,t)+l,j(v,e)+l,j(v,r)+l];if(y[0]*y[1]>s&&y[0]*y[2]>s)return{intersect:!1,coplanar:f,pt1:o,pt2:u,surfaceId:c};var h=[j(g,n)+p,j(g,a)+p,j(g,i)+p];if(h[0]*h[1]>s&&h[0]*h[2]>s)return{intersect:!1,coplanar:f,pt1:o,pt2:u,surfaceId:c};if(Math.abs(g[0]-v[0])<1e-9&&Math.abs(g[1]-v[1])<1e-9&&Math.abs(g[2]-v[2])<1e-9&&Math.abs(p-l)<1e-9)return f=!0,{intersect:!1,coplanar:f,pt1:o,pt2:u,surfaceId:c};var T=[t,e,r],x=[n,a,i],S=j(g,v),O=(p-l*S)/(S*S-1),C=(l-p*S)/(S*S-1),w=[O*g[0]+C*v[0],O*g[1]+C*v[1],O*g[2]+C*v[2]],E=si(g,v,[]);Vn(E);for(var M=0,L=0,b=[],D=[],V=50,B=50,R=0;R<3;R++){var N=R,U=(R+1)%3,G=rr.intersectWithLine(T[N],T[U],n,v);G.intersection&&G.t>0-s&&G.t<1+s&&(G.t<1+s&&G.t>1-s&&(V=M),b[M++]=j(G.x,E)-j(w,E));var m=rr.intersectWithLine(x[N],x[U],t,g);m.intersection&&m.t>0-s&&m.t<1+s&&(m.t<1+s&&m.t>1-s&&(B=L),D[L++]=j(m.x,E)-j(w,E))}if(M>2){M--;var F=b[2];b[2]=b[V],b[V]=F}if(L>2){L--;var I=D[2];D[2]=D[B],D[B]=I}if(M!==2||L!==2)return{intersect:!1,coplanar:f,pt1:o,pt2:u,surfaceId:c};if(Number.isNaN(b[0])||Number.isNaN(b[1])||Number.isNaN(D[0])||Number.isNaN(D[1]))return{intersect:!1,coplanar:f,pt1:o,pt2:u,surfaceId:c};if(b[0]>b[1]){var xe=b[1];b[1]=b[0],b[0]=xe}if(D[0]>D[1]){var se=D[1];D[1]=D[0],D[0]=se}var oe,fe;return b[1]<D[0]||D[1]<b[0]?{intersect:!1,coplanar:f,pt1:o,pt2:u,surfaceId:c}:(b[0]<D[0]?b[1]<D[1]?(c[0]=2,c[1]=1,oe=D[0],fe=b[1]):(c[0]=2,c[1]=2,oe=D[0],fe=D[1]):b[1]<D[1]?(c[0]=1,c[1]=1,oe=b[0],fe=b[1]):(c[0]=1,c[1]=2,oe=b[0],fe=D[1]),vs(w,E,oe,o),vs(w,E,fe,u),{intersect:!0,coplanar:f,pt1:o,pt2:u,surfaceId:c})}var $1={computeNormalDirection:wi,computeNormal:Gn,intersectWithTriangle:A1};function W1(t,e){e.classHierarchy.push("vtkTriangle"),t.getCellDimension=function(){return 2},t.intersectWithLine=function(r,n,a,i,s){var f={subId:0,t:Number.MAX_VALUE,intersect:0,betweenPoints:!1};s[2]=0;var o=[],u=a*a,c=[],g=[],v=[];e.points.getPoint(0,c),e.points.getPoint(1,g),e.points.getPoint(2,v);var p=[],l=[];if(Gn(c,g,v,p),p[0]!==0||p[1]!==0||p[2]!==0){var y=rr.intersectWithLine(r,n,c,p);if(f.betweenPoints=y.betweenPoints,f.t=y.t,i[0]=y.x[0],i[1]=y.x[1],i[2]=y.x[2],!y.intersection)return s[0]=0,s[1]=0,f.intersect=0,f;var h=t.evaluatePosition(i,o,s,l);if(h.evaluation>=0)return h.dist2<=u?(f.intersect=1,f):(f.intersect=h.evaluation,f)}var T=Je(c,g),x=Je(g,v),S=Je(v,c);e.line||(e.line=Be.newInstance()),T>x&&T>S?(e.line.getPoints().setPoint(0,c),e.line.getPoints().setPoint(1,g)):x>S&&x>T?(e.line.getPoints().setPoint(0,g),e.line.getPoints().setPoint(1,v)):(e.line.getPoints().setPoint(0,v),e.line.getPoints().setPoint(1,c));var O=e.line.intersectWithLine(r,n,a,i,s);if(f.betweenPoints=O.betweenPoints,f.t=O.t,O.intersect){for(var C=[],w=[],E=[],M=0;M<3;M++)C[M]=c[M]-v[M],w[M]=g[M]-v[M],E[M]=i[M]-v[M];return s[0]=j(E,C)/S,s[1]=j(E,w)/x,f.intersect=1,f}return s[0]=0,s[1]=0,f.intersect=0,f},t.evaluatePosition=function(r,n,a,i){var s={subId:0,dist2:0,evaluation:-1},f,o,u=[],c=[],g=[],v=[],p,l=[],y=[],h=[],T=0,x=0,S=[],O,C,w,E=[],M=[],L=[],b=[];s.subId=0,a[2]=0,e.points.getPoint(1,u),e.points.getPoint(2,c),e.points.getPoint(0,g),wi(u,c,g,v),rr.generalizedProjectPoint(r,u,v,b);var D=0;for(f=0;f<3;f++)v[f]<0?p=-v[f]:p=v[f],p>D&&(D=p,x=f);for(o=0,f=0;f<3;f++)f!==x&&(S[o++]=f);for(f=0;f<2;f++)l[f]=b[S[f]]-g[S[f]],y[f]=u[S[f]]-g[S[f]],h[f]=c[S[f]]-g[S[f]];if(T=xn(y,h),T===0)return a[0]=0,a[1]=0,s.evaluation=-1,s;if(a[0]=xn(l,h)/T,a[1]=xn(y,l)/T,i[0]=1-(a[0]+a[1]),i[1]=a[0],i[2]=a[1],i[0]>=0&&i[0]<=1&&i[1]>=0&&i[1]<=1&&i[2]>=0&&i[2]<=1)n&&(s.dist2=Je(b,r),n[0]=b[0],n[1]=b[1],n[2]=b[2]),s.evaluation=1;else{var V;if(n){if(i[1]<0&&i[2]<0)for(O=Je(r,g),C=Be.distanceToLine(r,u,g,V,M),w=Be.distanceToLine(r,g,c,V,L),O<C?(s.dist2=O,E=g):(s.dist2=C,E=M),w<s.dist2&&(s.dist2=w,E=L),f=0;f<3;f++)n[f]=E[f];else if(i[2]<0&&i[0]<0)for(O=Je(r,u),C=Be.distanceToLine(r,u,g,V,M),w=Be.distanceToLine(r,u,c,V,L),O<C?(s.dist2=O,E=u):(s.dist2=C,E=M),w<s.dist2&&(s.dist2=w,E=L),f=0;f<3;f++)n[f]=E[f];else if(i[1]<0&&i[0]<0)for(O=Je(r,c),C=Be.distanceToLine(r,c,g,V,M),w=Be.distanceToLine(r,u,c,V,L),O<C?(s.dist2=O,E=c):(s.dist2=C,E=M),w<s.dist2&&(s.dist2=w,E=L),f=0;f<3;f++)n[f]=E[f];else if(i[0]<0){var B=Be.distanceToLine(r,u,c,n);s.dist2=B.distance}else if(i[1]<0){var R=Be.distanceToLine(r,c,g,n);s.dist2=R.distance}else if(i[2]<0){var N=Be.distanceToLine(r,u,g,n);s.dist2=N.distance}}s.evaluation=0}return s},t.evaluateLocation=function(r,n,a){var i=[],s=[],f=[];e.points.getPoint(0,i),e.points.getPoint(1,s),e.points.getPoint(2,f);for(var o=1-r[0]-r[1],u=0;u<3;u++)n[u]=i[u]*o+s[u]*r[0]+f[u]*r[1];a[0]=o,a[1]=r[0],a[2]=r[1]},t.getParametricDistance=function(r){var n,a=0,i=[];i[0]=r[0],i[1]=r[1],i[2]=1-r[0]-r[1];for(var s=0;s<3;s++)i[s]<0?n=-i[s]:i[s]>1?n=i[s]-1:n=0,n>a&&(a=n);return a}}var z1={};function Iu(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,z1,r),mn.extend(t,e,r),W1(t,e)}var j1=d.newInstance(Iu,"vtkTriangle"),H1=_1({newInstance:j1,extend:Iu},$1),fa=["verts","lines","polys","strips"],gr,Hs=d.vtkWarningMacro,P1=(gr={},K(gr,Z.VTK_LINE,Be),K(gr,Z.VTK_POLY_LINE,Be),K(gr,Z.VTK_TRIANGLE,H1),gr);function K1(t,e){e.classHierarchy.push("vtkPolyData");function r(a){return a.replace(/(?:^\w|[A-Z]|\b\w)/g,function(i){return i.toUpperCase()}).replace(/\s+/g,"")}fa.forEach(function(a){t["getNumberOf".concat(r(a))]=function(){return e[a].getNumberOfCells()},e[a]?e[a]=ze(e[a]):e[a]=As.newInstance()}),t.getNumberOfCells=function(){return fa.reduce(function(a,i){return a+e[i].getNumberOfCells()},0)};var n=t.shallowCopy;t.shallowCopy=function(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;n(a,i),fa.forEach(function(s){e[s]=As.newInstance(),e[s].shallowCopy(a.getReferenceByName(s))})},t.buildCells=function(){var a=t.getNumberOfVerts(),i=t.getNumberOfLines(),s=t.getNumberOfPolys(),f=t.getNumberOfStrips(),o=a+i+s+f,u=new Uint8Array(o),c=u,g=new Uint32Array(o),v=g;if(a){var p=0;e.verts.getCellSizes().forEach(function(T,x){v[x]=p,c[x]=T>1?Z.VTK_POLY_VERTEX:Z.VTK_VERTEX,p+=T+1}),v=v.subarray(a),c=c.subarray(a)}if(i){var l=0;e.lines.getCellSizes().forEach(function(T,x){v[x]=l,c[x]=T>2?Z.VTK_POLY_LINE:Z.VTK_LINE,T===1&&Hs("Building VTK_LINE ",x," with only one point, but VTK_LINE needs at least two points. Check the input."),l+=T+1}),v=v.subarray(i),c=c.subarray(i)}if(s){var y=0;e.polys.getCellSizes().forEach(function(T,x){switch(v[x]=y,T){case 3:c[x]=Z.VTK_TRIANGLE;break;case 4:c[x]=Z.VTK_QUAD;break;default:c[x]=Z.VTK_POLYGON;break}T<3&&Hs("Building VTK_TRIANGLE ",x," with less than three points, but VTK_TRIANGLE needs at least three points. Check the input."),y+=T+1}),v+=v.subarray(s),c+=c.subarray(s)}if(f){var h=0;c.fill(Z.VTK_TRIANGLE_STRIP,0,f),e.strips.getCellSizes().forEach(function(T,x){v[x]=h,h+=T+1})}e.cells=L1.newInstance(),e.cells.setCellTypes(o,u,g)},t.buildLinks=function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;e.cells===void 0&&t.buildCells(),e.links=x1.newInstance(),a>0?e.links.allocate(a):e.links.allocate(t.getPoints().getNumberOfPoints()),e.links.buildLinks(t)},t.getCellType=function(a){return e.cells.getCellType(a)},t.getCellPoints=function(a){var i=t.getCellType(a),s=null;switch(i){case Z.VTK_VERTEX:case Z.VTK_POLY_VERTEX:s=e.verts;break;case Z.VTK_LINE:case Z.VTK_POLY_LINE:s=e.lines;break;case Z.VTK_TRIANGLE:case Z.VTK_QUAD:case Z.VTK_POLYGON:s=e.polys;break;case Z.VTK_TRIANGLE_STRIP:s=e.strips;break;default:return s=null,{type:0,cellPointIds:null}}var f=e.cells.getCellLocation(a),o=s.getCell(f);return{cellType:i,cellPointIds:o}},t.getPointCells=function(a){return e.links.getCells(a)},t.getCellEdgeNeighbors=function(a,i,s){var f=e.links.getLink(i),o=e.links.getLink(s);return f.cells.filter(function(u){return u!==a&&o.cells.indexOf(u)!==-1})},t.getCell=function(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,s=t.getCellPoints(a),f=i||P1[s.cellType].newInstance();return f.initialize(t.getPoints(),s.cellPointIds),f}}var X1={};function Qu(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,X1,r),G1.extend(t,e,r),d.get(t,e,["cells","links"]),d.setGet(t,e,["verts","lines","polys","strips"]),K1(t,e)}var Y1=d.newInstance(Qu,"vtkPolyData"),Lr={newInstance:Y1,extend:Qu};function Ps(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function I1(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ps(Object(r),!0).forEach(function(n){K(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ps(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Q1(t,e){e.classHierarchy.push("vtkTexture"),t.imageLoaded=function(){e.image.removeEventListener("load",t.imageLoaded),e.imageLoaded=!0,t.modified()},t.setJsImageData=function(r){e.jsImageData!==r&&(r!==null&&(t.setInputData(null),t.setInputConnection(null),e.image=null,e.canvas=null),e.jsImageData=r,e.imageLoaded=!0,t.modified())},t.setCanvas=function(r){e.canvas!==r&&(r!==null&&(t.setInputData(null),t.setInputConnection(null),e.image=null,e.jsImageData=null),e.canvas=r,t.modified())},t.setImage=function(r){e.image!==r&&(r!==null&&(t.setInputData(null),t.setInputConnection(null),e.canvas=null,e.jsImageData=null),e.image=r,e.imageLoaded=!1,r.complete?t.imageLoaded():r.addEventListener("load",t.imageLoaded),t.modified())},t.getDimensionality=function(){var r=0,n=0,a=1;if(t.getInputData()){var i=t.getInputData();r=i.getDimensions()[0],n=i.getDimensions()[1],a=i.getDimensions()[2]}e.jsImageData&&(r=e.jsImageData.width,n=e.jsImageData.height),e.canvas&&(r=e.canvas.width,n=e.canvas.height),e.image&&(r=e.image.width,n=e.image.height);var s=(r>1)+(n>1)+(a>1);return s},t.getInputAsJsImageData=function(){if(!e.imageLoaded||t.getInputData())return null;if(e.jsImageData)return e.jsImageData();if(e.canvas){var r=e.canvas.getContext("2d"),n=r.getImageData(0,0,e.canvas.width,e.canvas.height);return n}if(e.image){var a=document.createElement("canvas");a.width=e.image.width,a.height=e.image.height;var i=a.getContext("2d");i.translate(0,a.height),i.scale(1,-1),i.drawImage(e.image,0,0,e.image.width,e.image.height);var s=i.getImageData(0,0,a.width,a.height);return s}return null}}var q1=function(e,r,n,a){for(var i=[1,2,1],s=4,f=i,o=s,u=e.length/(r*n),c=r,g=n,v=e,p=[v],l=0;l<a;l++){var y=re(v);c/=2,g/=2,v=new Uint8ClampedArray(c*g*u);for(var h=u*c,T=0,x=0;x<v.length;x+=u){x%h===0&&(T+=2*u*c);for(var S=0;S<u;S++){var O=y[T+S];O+=y[T+u+S],O+=y[T-2*h+S],O+=y[T-2*h+u+S],O/=4,v[x+S]=O}T+=2*u}for(var C=re(v),w=0;w<v.length;w+=u)for(var E=0;E<u;E++){for(var M=-(f.length-1)/2,L=o,b=0,D=0;D<f.length;D++){var V=w+E+M*u,B=V%h-(w+E)%h;B>u&&(V+=h),B<-u&&(V-=h),C[V]?b+=C[V]*f[D]:L-=f[D],M+=1}v[w+E]=b/L}C=re(v);for(var R=0;R<v.length;R+=u)for(var N=0;N<u;N++){for(var U=-(f.length-1)/2,G=o,m=0,F=0;F<f.length;F++){var I=R+N+U*h;C[I]?m+=C[I]*f[F]:G-=f[F],U+=1}v[R+N]=m/G}p.push(v)}return p},Z1={image:null,canvas:null,jsImageData:null,imageLoaded:!1,repeat:!1,interpolate:!1,edgeClamp:!1,mipLevel:0,resizable:!1};function qu(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Z1,r),d.obj(t,e),d.algo(t,e,6,0),d.get(t,e,["canvas","image","jsImageData","imageLoaded"]),d.setGet(t,e,["repeat","edgeClamp","interpolate","mipLevel"]),Q1(t,e)}var J1=d.newInstance(qu,"vtkTexture"),eT={generateMipmaps:q1},Hn=I1({newInstance:J1,extend:qu},eT);function Ks(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function yr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ks(Object(r),!0).forEach(function(n){K(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ks(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var tT=[[-1,0,0],[1,0,0],[0,-1,0],[0,1,0],[0,0,-1],[0,0,1]],Xs=[[8,7,11,3],[9,1,10,5],[4,9,0,8],[2,11,6,10],[0,3,2,1],[4,5,6,7]],tn=[[0,1],[1,3],[2,3],[0,2],[4,5],[5,7],[6,7],[4,6],[0,4],[1,5],[3,7],[2,6]],Ys=[0,1,0,1,0,1,0,1,2,2,2,2],te=[[1,2],[1,2],[0,2],[0,2],[0,1],[0,1]],_=new Float64Array(3),rn=new Float64Array(3),X=new Float64Array(3),Vt=new Float64Array(3),wt=new Float64Array(3),nn=new Float64Array(3),ua=new Float64Array(16);function ca(t,e){t.strokeStyle=e.strokeColor,t.lineWidth=e.strokeSize,t.fillStyle=e.fontColor,t.font="".concat(e.fontStyle," ").concat(e.fontSize,"px ").concat(e.fontFamily)}function rT(t,e){e.classHierarchy.push("vtkCubeAxesActorHelper"),t.setRenderable=function(r){e.renderable!==r&&(e.renderable=r,e.tmActor.addTexture(e.renderable.getTmTexture()),e.tmActor.setProperty(r.getProperty()),e.tmActor.setParentProp(r),t.modified())},t.createPolyDataForOneLabel=function(r,n,a,i,s,f,o){var u=e.renderable.get_tmAtlas().get(r);if(!!u){var c=e.renderable.getTextPolyData().getPoints().getData(),g=e.lastSize;_[0]=c[n*3],_[1]=c[n*3+1],_[2]=c[n*3+2],Le(X,_,a),X[0]+=.1,Le(rn,X,i),Yt(wt,rn,_),X[0]-=.1,X[1]+=.1,Le(rn,X,i),Yt(nn,rn,_);for(var v=0;v<3;v++)wt[v]/=.5*.1*g[0],nn[v]/=.5*.1*g[1];var p=o.ptIdx,l=o.cellIdx;_[0]=c[n*3],_[1]=c[n*3+1],_[2]=c[n*3+2],s[0]<-.5?pt(X,wt,s[0]*f-u.width):s[0]>.5?pt(X,wt,s[0]*f):pt(X,wt,s[0]*f-u.width/2),vr(_,_,X),pt(X,nn,s[1]*f-u.height/2),vr(_,_,X),o.points[p*3]=_[0],o.points[p*3+1]=_[1],o.points[p*3+2]=_[2],o.tcoords[p*2]=u.tcoords[0],o.tcoords[p*2+1]=u.tcoords[1],p++,pt(X,wt,u.width),vr(_,_,X),o.points[p*3]=_[0],o.points[p*3+1]=_[1],o.points[p*3+2]=_[2],o.tcoords[p*2]=u.tcoords[2],o.tcoords[p*2+1]=u.tcoords[3],p++,pt(X,nn,u.height),vr(_,_,X),o.points[p*3]=_[0],o.points[p*3+1]=_[1],o.points[p*3+2]=_[2],o.tcoords[p*2]=u.tcoords[4],o.tcoords[p*2+1]=u.tcoords[5],p++,pt(X,wt,u.width),Yt(_,_,X),o.points[p*3]=_[0],o.points[p*3+1]=_[1],o.points[p*3+2]=_[2],o.tcoords[p*2]=u.tcoords[6],o.tcoords[p*2+1]=u.tcoords[7],p++,o.polys[l*4]=3,o.polys[l*4+1]=p-4,o.polys[l*4+2]=p-3,o.polys[l*4+3]=p-2,l++,o.polys[l*4]=3,o.polys[l*4+1]=p-4,o.polys[l*4+2]=p-2,o.polys[l*4+3]=p-1,o.ptIdx+=4,o.cellIdx+=2}},t.updateTexturePolyData=function(){var r=e.camera.getCompositeProjectionMatrix(e.lastAspectRatio,-1,1);Se(r,r);var n=e.renderable.getTextValues().length,a=n*4,i=n*2,s=new Float64Array(a*3),f=new Uint16Array(i*4),o=new Float32Array(a*2);At(ua,r);for(var u={ptIdx:0,cellIdx:0,polys:f,points:s,tcoords:o},c=0,g=0,v=0,p=e.renderable.getTextPolyData().getPoints().getData(),l=e.renderable.getTextValues();c<p.length/3;){_[0]=p[c*3],_[1]=p[c*3+1],_[2]=p[c*3+2],Le(X,_,r),_[0]=p[c*3+3],_[1]=p[c*3+4],_[2]=p[c*3+5],Le(Vt,_,r),Yt(X,X,Vt);var y=[X[0],X[1]];Zl(y),t.createPolyDataForOneLabel(l[g],c,r,ua,y,e.renderable.getAxisTitlePixelOffset(),u),c+=2,g++;for(var h=0;h<e.renderable.getTickCounts()[v];h++)t.createPolyDataForOneLabel(l[g],c,r,ua,y,e.renderable.getTickLabelPixelOffset(),u),c++,g++;v++}var T=ve.newInstance({numberOfComponents:2,values:o,name:"TextureCoordinates"});e.tmPolyData.getPointData().setTCoords(T),e.tmPolyData.getPoints().setData(s,3),e.tmPolyData.getPoints().modified(),e.tmPolyData.getPolys().setData(f,1),e.tmPolyData.getPolys().modified(),e.tmPolyData.modified()},t.updateAPISpecificData=function(r,n,a){(e.lastSize[0]!==r[0]||e.lastSize[1]!==r[1])&&(e.lastSize[0]=r[0],e.lastSize[1]=r[1],e.lastAspectRatio=r[0]/r[1],e.forceUpdate=!0),e.camera=n,t.updateTexturePolyData()}}var nT=d.newInstance(function(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{renderable:null};Object.assign(e,{},r),d.obj(t,e),e.tmPolyData=Lr.newInstance(),e.tmMapper=ar.newInstance(),e.tmMapper.setInputData(e.tmPolyData),e.tmActor=nr.newInstance({parentProp:t}),e.tmActor.setMapper(e.tmMapper),d.setGet(t,e,["renderable"]),d.get(t,e,["lastSize","lastAspectRatio","axisTextStyle","tickTextStyle","tmActor","ticks"]),e.forceUpdate=!1,e.lastRedrawTime={},d.obj(e.lastRedrawTime,{mtime:0}),e.lastRebuildTime={},d.obj(e.lastRebuildTime,{mtime:0}),e.lastSize=[-1,-1],e.lastTickBounds=[],rT(t,e)},"vtkCubeAxesActorHelper");function aT(t,e){e.classHierarchy.push("vtkCubeAxesActor"),t.setCamera=function(n){e.camera!==n&&(e.cameraModifiedSub&&(e.cameraModifiedSub.unsubscribe(),e.cameraModifiedSub=null),e.camera=n,n&&(e.cameraModifiedSub=n.onModified(t.update)),t.update(),t.modified())},t.computeFacesToDraw=function(){var n=e.camera.getViewMatrix();Se(n,n);for(var a=!1,i=Oe.getDiagonalLength(e.dataBounds),s=Math.sin(e.faceVisibilityAngle*Math.PI/180),f=0;f<6;f++){var o=!1,u=Math.floor(f/2),c=(u+1)%3,g=(u+2)%3;e.dataBounds[c*2]!==e.dataBounds[c*2+1]&&e.dataBounds[g*2]!==e.dataBounds[g*2+1]&&(_[u]=e.dataBounds[f]-.1*i*tT[f][u],_[c]=.5*(e.dataBounds[c*2]+e.dataBounds[c*2+1]),_[g]=.5*(e.dataBounds[g*2]+e.dataBounds[g*2+1]),Le(X,_,n),_[u]=e.dataBounds[f],Le(Vt,_,n),Yt(X,Vt,X),Ra(X,X),o=X[2]>s,e.camera.getParallelProjection()||(Ra(Vt,Vt),o=yf(Vt,X)>s)),o!==e.lastFacesToDraw[f]&&(e.lastFacesToDraw[f]=o,a=!0)}return a},t.updatePolyData=function(n,a,i){var s=0,f=0;s+=8;for(var o=0,u=0;u<12;u++)a[u]>0&&o++;if(f+=o,e.gridLines)for(var c=0;c<6;c++)n[c]&&(s+=i[te[c][0]].length*2+i[te[c][1]].length*2,f+=i[te[c][0]].length+i[te[c][1]].length);for(var g=new Float64Array(s*3),v=new Uint32Array(f*3),p=0,l=0,y=0;y<2;y++)for(var h=0;h<2;h++)for(var T=0;T<2;T++)g[p*3]=e.dataBounds[T],g[p*3+1]=e.dataBounds[2+h],g[p*3+2]=e.dataBounds[4+y],p++;for(var x=0;x<12;x++)a[x]>0&&(v[l*3]=2,v[l*3+1]=tn[x][0],v[l*3+2]=tn[x][1],l++);if(e.gridLines){for(var S=0;S<6;S++)if(n[S]){for(var O=Math.floor(S/2),C=i[te[S][0]],w=0;w<C.length;w++)g[p*3+O]=e.dataBounds[S],g[p*3+te[S][0]]=C[w],g[p*3+te[S][1]]=e.dataBounds[te[S][1]*2],p++,g[p*3+O]=e.dataBounds[S],g[p*3+te[S][0]]=C[w],g[p*3+te[S][1]]=e.dataBounds[te[S][1]*2+1],p++,v[l*3]=2,v[l*3+1]=p-2,v[l*3+2]=p-1,l++;C=i[te[S][1]];for(var E=0;E<C.length;E++)g[p*3+O]=e.dataBounds[S],g[p*3+te[S][1]]=C[E],g[p*3+te[S][0]]=e.dataBounds[te[S][0]*2],p++,g[p*3+O]=e.dataBounds[S],g[p*3+te[S][1]]=C[E],g[p*3+te[S][0]]=e.dataBounds[te[S][0]*2+1],p++,v[l*3]=2,v[l*3+1]=p-2,v[l*3+2]=p-1,l++}}e.polyData.getPoints().setData(g,3),e.polyData.getPoints().modified(),e.polyData.getLines().setData(v,1),e.polyData.getLines().modified(),e.polyData.modified()},t.updateTextData=function(n,a,i,s){for(var f=0,o=0;o<12;o++)a[o]===1&&(f+=2,f+=i[Ys[o]].length);for(var u=e.polyData.getPoints().getData(),c=new Float64Array(f*3),g=0,v=0,p=0,l=0;l<6;l++)if(n[l])for(var y=0;y<4;y++){var h=Xs[l][y];if(a[h]===1){var T=Ys[h],x=tn[h][0]*3,S=tn[h][1]*3;c[g*3]=.5*(u[x]+u[S]),c[g*3+1]=.5*(u[x+1]+u[S+1]),c[g*3+2]=.5*(u[x+2]+u[S+2]),g++;var O=Math.floor(l/2);c[g*3+O]=e.dataBounds[l],c[g*3+te[l][0]]=.5*(e.dataBounds[te[l][0]*2]+e.dataBounds[te[l][0]*2+1]),c[g*3+te[l][1]]=.5*(e.dataBounds[te[l][1]*2]+e.dataBounds[te[l][1]*2+1]),g++,e.textValues[v]=e.axisLabels[T],v++;var C=(T+1)%3,w=(T+2)%3,E=i[T],M=s[T];e.tickCounts[p]=E.length;for(var L=0;L<E.length;L++)c[g*3+T]=E[L],c[g*3+C]=u[x+C],c[g*3+w]=u[x+w],g++,e.textValues[v]=M[L],v++;p++}}e.textPolyData.getPoints().setData(c,3),e.textPolyData.modified()},t.update=function(){if(!!e.camera){for(var n=t.computeFacesToDraw(),a=e.lastFacesToDraw,i=!1,s=0;s<6;s++)e.dataBounds[s]!==e.lastTickBounds[s]&&(i=!0,e.lastTickBounds[s]=e.dataBounds[s]);if(n||i||e.forceUpdate){for(var f=new Array(12).fill(0),o=0;o<6;o++)if(a[o])for(var u=0;u<4;u++)f[Xs[o][u]]++;for(var c=[],g=[],v=0;v<3;v++){var p=ii().domain([e.dataBounds[v*2],e.dataBounds[v*2+1]]);c[v]=p.ticks(5);var l=p.tickFormat(5);g[v]=c[v].map(l)}t.updatePolyData(a,f,c),t.updateTextData(a,f,c,g),(i||e.forceUpdate)&&t.updateTextureAtlas(g)}e.forceUpdate=!1}},t.updateTextureAtlas=function(n){e.tmContext.textBaseline="bottom",e.tmContext.textAlign="left",e._tmAtlas.clear();for(var a=0,i=1,s=0;s<3;s++){if(!e._tmAtlas.has(e.axisLabels[s])){ca(e.tmContext,e.axisTextStyle);var f=e.tmContext.measureText(e.axisLabels[s]),o={height:f.actualBoundingBoxAscent+2,startingHeight:i,width:f.width+2,textStyle:e.axisTextStyle};e._tmAtlas.set(e.axisLabels[s],o),i+=o.height,a<o.width&&(a=o.width)}ca(e.tmContext,e.tickTextStyle);for(var u=0;u<n[s].length;u++)if(!e._tmAtlas.has(n[s][u])){var c=e.tmContext.measureText(n[s][u]),g={height:c.actualBoundingBoxAscent+2,startingHeight:i,width:c.width+2,textStyle:e.tickTextStyle};e._tmAtlas.set(n[s][u],g),i+=g.height,a<g.width&&(a=g.width)}}a=$e(a),i=$e(i),e._tmAtlas.forEach(function(v){v.tcoords=[0,(i-v.startingHeight-v.height)/i,v.width/a,(i-v.startingHeight-v.height)/i,v.width/a,(i-v.startingHeight)/i,0,(i-v.startingHeight)/i]}),e.tmCanvas.width=a,e.tmCanvas.height=i,e.tmContext.textBaseline="bottom",e.tmContext.textAlign="left",e.tmContext.clearRect(0,0,a,i),e._tmAtlas.forEach(function(v,p){ca(e.tmContext,v.textStyle),e.tmContext.fillText(p,1,v.startingHeight+v.height-1)}),e.tmTexture.setCanvas(e.tmCanvas),e.tmTexture.modified()},t.onModified(function(){e.forceUpdate=!0,t.update()}),t.setTickTextStyle=function(n){e.tickTextStyle=yr(yr({},e.tickTextStyle),n),t.modified()},t.setAxisTextStyle=function(n){e.axisTextStyle=yr(yr({},e.axisTextStyle),n),t.modified()},t.get_tmAtlas=function(){return e._tmAtlas},t.getBounds=function(){return t.update(),Oe.setBounds(e.bounds,e.gridActor.getBounds()),Oe.scaleAboutCenter(e.bounds,e.boundsScaleFactor,e.boundsScaleFactor,e.boundsScaleFactor),e.bounds};var r=d.chain(t.setProperty,e.gridActor.setProperty);t.setProperty=function(n){return r(n)[0]}}function iT(t){return yr({boundsScaleFactor:1.3,camera:null,dataBounds:re(Oe.INIT_BOUNDS),faceVisibilityAngle:8,gridLines:!0,axisLabels:null,axisTitlePixelOffset:35,axisTextStyle:{fontColor:"white",fontStyle:"normal",fontSize:18,fontFamily:"serif"},tickLabelPixelOffset:12,tickTextStyle:{fontColor:"white",fontStyle:"normal",fontSize:14,fontFamily:"serif"}},t)}function Zu(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,iT(r)),nr.extend(t,e,r),e.lastFacesToDraw=[!1,!1,!1,!1,!1,!1],e.axisLabels=["X-Axis","Y-Axis","Z-Axis"],e.tickCounts=[],e.textValues=[],e.lastTickBounds=[],e.tmCanvas=document.createElement("canvas"),e.tmContext=e.tmCanvas.getContext("2d"),e._tmAtlas=new Map,e.tmTexture=Hn.newInstance(),e.tmTexture.setInterpolate(!1),t.getProperty().setDiffuse(0),t.getProperty().setAmbient(1),e.gridMapper=ar.newInstance(),e.polyData=Lr.newInstance(),e.gridMapper.setInputData(e.polyData),e.gridActor=nr.newInstance(),e.gridActor.setMapper(e.gridMapper),e.gridActor.setProperty(t.getProperty()),e.gridActor.setParentProp(t),e.textPolyData=Lr.newInstance(),d.setGet(t,e,["axisTitlePixelOffset","boundsScaleFactor","faceVisibilityAngle","gridLines","tickLabelPixelOffset"]),d.setGetArray(t,e,["dataBounds"],6),d.setGetArray(t,e,["axisLabels"],3),d.get(t,e,["axisTextStyle","tickTextStyle","camera","tmTexture","textValues","textPolyData","tickCounts","gridActor"]),aT(t,e)}var sT=d.newInstance(Zu,"vtkCubeAxesActor"),Ju={newInstance:sT,extend:Zu,newCubeAxesActorHelper:nT};function oT(t,e){e.classHierarchy.push("vtkOpenGLCubeAxesActor"),t.buildPass=function(r){r&&(e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getParent(),e.CubeAxesActorHelper.getRenderable()||e.CubeAxesActorHelper.setRenderable(e.renderable),t.prepareNodes(),t.addMissingNode(e.CubeAxesActorHelper.getTmActor()),t.addMissingNode(e.renderable.getGridActor()),t.removeUnusedNodes())},t.opaquePass=function(r,n){if(r){var a=e._openGLRenderer?e._openGLRenderer.getRenderable().getActiveCamera():null,i=e._openGLRenderer.getTiledSizeAndOrigin();e.CubeAxesActorHelper.updateAPISpecificData([i.usize,i.vsize],a,e._openGLRenderWindow.getRenderable())}}}var fT={};function uT(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,fT,r),ie.extend(t,e,r),e.CubeAxesActorHelper=Ju.newCubeAxesActorHelper(),oT(t,e)}var cT=ne(uT,"vtkOpenGLCubeAxesActor");He("vtkCubeAxesActor",cT);var Or={ARRAY_BUFFER:0,ELEMENT_ARRAY_BUFFER:1,TEXTURE_BUFFER:2},ec={ObjectType:Or};function Is(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Qs(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Is(Object(r),!0).forEach(function(n){K(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Is(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var On=ec.ObjectType,gT={};function vT(t,e){e.classHierarchy.push("vtkOpenGLBufferObject");function r(f){switch(f){case On.ELEMENT_ARRAY_BUFFER:return e.context.ELEMENT_ARRAY_BUFFER;case On.TEXTURE_BUFFER:if("TEXTURE_BUFFER"in e.context)return e.context.TEXTURE_BUFFER;case On.ARRAY_BUFFER:default:return e.context.ARRAY_BUFFER}}var n=null,a=null,i=!0,s="";t.getType=function(){return n},t.setType=function(f){n=f},t.getHandle=function(){return a},t.isReady=function(){return i===!1},t.generateBuffer=function(f){var o=r(f);return a===null&&(a=e.context.createBuffer(),n=f),r(n)===o},t.upload=function(f,o){var u=t.generateBuffer(o);return u?(e.context.bindBuffer(r(n),a),e.context.bufferData(r(n),f,e.context.STATIC_DRAW),i=!1,!0):(s="Trying to upload array buffer to incompatible buffer.",!1)},t.bind=function(){return a?(e.context.bindBuffer(r(n),a),!0):!1},t.release=function(){return a?(e.context.bindBuffer(r(n),null),!0):!1},t.releaseGraphicsResources=function(){a!==null&&(e.context.bindBuffer(r(n),null),e.context.deleteBuffer(a),a=null)},t.setOpenGLRenderWindow=function(f){e._openGLRenderWindow!==f&&(t.releaseGraphicsResources(),e._openGLRenderWindow=f,e.context=null,f&&(e.context=e._openGLRenderWindow.getContext()))},t.getError=function(){return s}}var pT={objectType:On.ARRAY_BUFFER,context:null};function tc(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,pT,r),d.obj(t,e),d.get(t,e,["_openGLRenderWindow"]),d.moveToProtected(t,e,["openGLRenderWindow"]),vT(t,e)}var lT=d.newInstance(tc),rc=Qs(Qs({newInstance:lT,extend:tc},gT),ec),qs=d.vtkErrorMacro;function hT(t,e){var r=new Float64Array(3);ap(r,e);var n=new Float64Array(16);return cf(n,Er(),t,r),n}function yT(t,e){return t===null||e===null?!1:!(Yi(t,[0,0,0])&&Yi(e,[1,1,1]))}function TT(t,e){e.classHierarchy.push("vtkOpenGLCellArrayBufferObject"),t.setType(Or.ARRAY_BUFFER),t.createVBO=function(r,n,a,i){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;if(!r.getData()||!r.getData().length)return e.elementCount=0,0;e.blockSize=3,e.vertexOffset=0,e.normalOffset=0,e.tCoordOffset=0,e.tCoordComponents=0,e.colorComponents=0,e.colorOffset=0,e.customData=[];var f=i.points.getData(),o=null,u=null,c=null,g=i.colors?i.colors.getNumberOfComponents():0,v=i.tcoords?i.tcoords.getNumberOfComponents():0;i.normals&&(e.normalOffset=4*e.blockSize,e.blockSize+=3,o=i.normals.getData()),i.customAttributes&&i.customAttributes.forEach(function(ue){ue&&(e.customData.push({data:ue.getData(),offset:4*e.blockSize,components:ue.getNumberOfComponents(),name:ue.getName()}),e.blockSize+=ue.getNumberOfComponents())}),i.tcoords&&(e.tCoordOffset=4*e.blockSize,e.tCoordComponents=v,e.blockSize+=v,u=i.tcoords.getData()),i.colors?(e.colorComponents=i.colors.getNumberOfComponents(),e.colorOffset=0,c=i.colors.getData(),e.colorBO||(e.colorBO=rc.newInstance()),e.colorBO.setOpenGLRenderWindow(e._openGLRenderWindow)):e.colorBO=null,e.stride=4*e.blockSize;var p=0,l=0,y=0,h=0,T=0,x=0,S,O={anythingToPoints:function(A,P,Q){for(var $=0;$<A;++$)S(P[Q+$])},linesToWireframe:function(A,P,Q){for(var $=0;$<A-1;++$)S(P[Q+$]),S(P[Q+$+1])},polysToWireframe:function(A,P,Q){if(A>2)for(var $=0;$<A;++$)S(P[Q+$]),S(P[Q+($+1)%A])},stripsToWireframe:function(A,P,Q){if(A>2){for(var $=0;$<A-1;++$)S(P[Q+$]),S(P[Q+$+1]);for(var Pe=0;Pe<A-2;Pe++)S(P[Q+Pe]),S(P[Q+Pe+2])}},polysToSurface:function(A,P,Q){for(var $=0;$<A-2;$++)S(P[Q+0]),S(P[Q+$+1]),S(P[Q+$+2])},stripsToSurface:function(A,P,Q){for(var $=0;$<A-2;$++)S(P[Q+$]),S(P[Q+$+1+$%2]),S(P[Q+$+1+($+1)%2])}},C={anythingToPoints:function(A,P){return A},linesToWireframe:function(A,P){return A>1?(A-1)*2:0},polysToWireframe:function(A,P){return A>2?A*2:0},stripsToWireframe:function(A,P){return A>2?A*4-6:0},polysToSurface:function(A,P){return A>2?(A-2)*3:0},stripsToSurface:function(A,P,Q){return A>2?(A-2)*3:0}},w=null,E=null;a===Fe.POINTS||n==="verts"?(w=O.anythingToPoints,E=C.anythingToPoints):a===Fe.WIREFRAME||n==="lines"?(w=O["".concat(n,"ToWireframe")],E=C["".concat(n,"ToWireframe")]):(w=O["".concat(n,"ToSurface")],E=C["".concat(n,"ToSurface")]);for(var M=r.getData(),L=M.length,b=0,D=0;D<L;)b+=E(M[D],M),D+=M[D]+1;var V=null,B=new Float32Array(b*e.blockSize);c&&(V=new Uint8Array(b*4));for(var R=0,N=0,U=0,G=0,m=0;m<3;++m){var F=i.points.getRange(m),I=F[1]-F[0];U+=I*I;var xe=.5*(F[1]+F[0]);G+=xe*xe}var se=U>0&&(Math.abs(G)/U>1e6||Math.abs(Math.log10(U))>3||U===0&&G>1e6);if(se){for(var oe=new Float64Array(3),fe=new Float64Array(3),J=0;J<3;++J){var de=i.points.getRange(J),qe=de[1]-de[0];oe[J]=.5*(de[1]+de[0]),fe[J]=qe>0?1/qe:1}t.setCoordShiftAndScale(oe,fe)}else e.coordShiftAndScaleEnabled===!0&&t.setCoordShiftAndScale(null,null);if(s)if(!s.points&&!s.cells)s.points=new Int32Array(b),s.cells=new Int32Array(b);else{var xt=new Int32Array(b+s.points.length);xt.set(s.points),s.points=xt;var $r=new Int32Array(b+s.cells.length);$r.set(s.cells),s.cells=$r}var ot=i.vertexOffset;S=function(A){if(s&&(s.points[ot]=A,s.cells[ot]=x+i.cellOffset),++ot,p=A*3,e.coordShiftAndScaleEnabled?(B[R++]=(f[p++]-e.coordShift[0])*e.coordScale[0],B[R++]=(f[p++]-e.coordShift[1])*e.coordScale[1],B[R++]=(f[p++]-e.coordShift[2])*e.coordScale[2]):(B[R++]=f[p++],B[R++]=f[p++],B[R++]=f[p++]),o!==null&&(i.haveCellNormals?l=(x+i.cellOffset)*3:l=A*3,B[R++]=o[l++],B[R++]=o[l++],B[R++]=o[l++]),e.customData.forEach(function(Q){T=A*Q.components;for(var $=0;$<Q.components;++$)B[R++]=Q.data[T++]}),u!==null){y=A*v;for(var P=0;P<v;++P)B[R++]=u[y++]}c!==null&&(i.haveCellScalars?h=(x+i.cellOffset)*g:h=A*g,V[N++]=c[h++],V[N++]=c[h++],V[N++]=c[h++],V[N++]=g===4?c[h++]:255)};for(var ft=0;ft<L;)w(M[ft],M,ft+1),ft+=M[ft]+1,x++;return e.elementCount=b,t.upload(B,Or.ARRAY_BUFFER),e.colorBO&&(e.colorBOStride=4,e.colorBO.upload(V,Or.ARRAY_BUFFER)),x},t.setCoordShiftAndScale=function(r,n){if(r!==null&&(r.constructor!==Float64Array||r.length!==3)){qs("Wrong type for coordShift, expected vec3 or null");return}if(n!==null&&(n.constructor!==Float64Array||n.length!==3)){qs("Wrong type for coordScale, expected vec3 or null");return}(e.coordShift===null||r===null||!Ii(r,e.coordShift))&&(e.coordShift=r),(e.coordScale===null||n===null||!Ii(n,e.coordScale))&&(e.coordScale=n),e.coordShiftAndScaleEnabled=yT(e.coordShift,e.coordScale),e.coordShiftAndScaleEnabled?e.inverseShiftAndScaleMatrix=hT(e.coordShift,e.coordScale):e.inverseShiftAndScaleMatrix=null}}var xT={elementCount:0,stride:0,colorBOStride:0,vertexOffset:0,normalOffset:0,tCoordOffset:0,tCoordComponents:0,colorOffset:0,colorComponents:0,tcoordBO:null,customData:[],coordShift:null,coordScale:null,coordShiftAndScaleEnabled:!1,inverseShiftAndScaleMatrix:null};function nc(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,xT,r),rc.extend(t,e,r),d.setGet(t,e,["colorBO","elementCount","stride","colorBOStride","vertexOffset","normalOffset","tCoordOffset","tCoordComponents","colorOffset","colorComponents","customData"]),d.get(t,e,["coordShift","coordScale","coordShiftAndScaleEnabled","inverseShiftAndScaleMatrix"]),TT(t,e)}var dT=d.newInstance(nc),OT={newInstance:dT,extend:nc},ST=d.vtkErrorMacro;function CT(t,e){e.classHierarchy.push("vtkShader"),t.compile=function(){var r=e.context.VERTEX_SHADER;if(!e.source||!e.source.length||e.shaderType==="Unknown")return!1;switch(e.handle!==0&&(e.context.deleteShader(e.handle),e.handle=0),e.shaderType){case"Fragment":r=e.context.FRAGMENT_SHADER;break;case"Vertex":default:r=e.context.VERTEX_SHADER;break}e.handle=e.context.createShader(r),e.context.shaderSource(e.handle,e.source),e.context.compileShader(e.handle);var n=e.context.getShaderParameter(e.handle,e.context.COMPILE_STATUS);if(!n){var a=e.context.getShaderInfoLog(e.handle);return ST("Error compiling shader '".concat(e.source,"': ").concat(a)),e.context.deleteShader(e.handle),e.handle=0,!1}return!0},t.cleanup=function(){e.shaderType==="Unknown"||e.handle===0||(e.context.deleteShader(e.handle),e.handle=0,e.dirty=!0)}}var wT={shaderType:"Unknown",source:"",error:"",handle:0,dirty:!1,context:null};function ac(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,wT,r),d.obj(t,e),d.setGet(t,e,["shaderType","source","error","handle","context"]),CT(t,e)}var ET=d.newInstance(ac,"vtkShader"),ga={newInstance:ET,extend:ac},Ke=d.vtkErrorMacro;function MT(t,e,r,n){var a=typeof r=="string"?r:r.join(`
`),i=n===!1?e:new RegExp(e,"g"),s=t.replace(i,a);return{replace:s!==a,result:s}}function DT(t,e){e.classHierarchy.push("vtkShaderProgram"),t.compileShader=function(){return e.vertexShader.compile()?e.fragmentShader.compile()?!t.attachShader(e.vertexShader)||!t.attachShader(e.fragmentShader)?(Ke(e.error),0):t.link()?(t.setCompiled(!0),1):(Ke("Links failed: ".concat(e.error)),0):(Ke(e.fragmentShader.getSource().split(`
`).map(function(r,n){return"".concat(n,": ").concat(r)}).join(`
`)),Ke(e.fragmentShader.getError()),0):(Ke(e.vertexShader.getSource().split(`
`).map(function(r,n){return"".concat(n,": ").concat(r)}).join(`
`)),Ke(e.vertexShader.getError()),0)},t.cleanup=function(){e.shaderType==="Unknown"||e.handle===0||(e.context.deleteShader(e.handle),e.handle=0)},t.bind=function(){return!e.linked&&!t.link()?!1:(e.context.useProgram(e.handle),t.setBound(!0),!0)},t.isBound=function(){return!!e.bound},t.release=function(){e.context.useProgram(null),t.setBound(!1)},t.setContext=function(r){e.vertexShader.setContext(r),e.fragmentShader.setContext(r),e.geometryShader.setContext(r)},t.link=function(){if(e.inked)return!0;if(e.handle===0)return e.error="Program has not been initialized, and/or does not have shaders.",!1;e.uniformLocs={},e.context.linkProgram(e.handle);var r=e.context.getProgramParameter(e.handle,e.context.LINK_STATUS);if(!r){var n=e.context.getProgramInfoLog(e.handle);return Ke("Error linking shader ".concat(n)),e.handle=0,!1}return t.setLinked(!0),e.attributeLocs={},!0},t.setUniformMatrix=function(r,n){var a=t.findUniform(r);if(a===-1)return e.error="Could not set uniform ".concat(r," . No such uniform."),!1;var i=new Float32Array(n);return e.context.uniformMatrix4fv(a,!1,i),!0},t.setUniformMatrix3x3=function(r,n){var a=t.findUniform(r);if(a===-1)return e.error="Could not set uniform ".concat(r," . No such uniform."),!1;var i=new Float32Array(n);return e.context.uniformMatrix3fv(a,!1,i),!0},t.setUniformf=function(r,n){var a=t.findUniform(r);return a===-1?(e.error="Could not set uniform ".concat(r," . No such uniform."),!1):(e.context.uniform1f(a,n),!0)},t.setUniformfv=function(r,n){var a=t.findUniform(r);return a===-1?(e.error="Could not set uniform ".concat(r," . No such uniform."),!1):(e.context.uniform1fv(a,n),!0)},t.setUniformi=function(r,n){var a=t.findUniform(r);return a===-1?(e.error="Could not set uniform ".concat(r," . No such uniform."),!1):(e.context.uniform1i(a,n),!0)},t.setUniformiv=function(r,n){var a=t.findUniform(r);return a===-1?(e.error="Could not set uniform ".concat(r," . No such uniform."),!1):(e.context.uniform1iv(a,n),!0)},t.setUniform2f=function(r,n,a){var i=t.findUniform(r);if(i===-1)return e.error="Could not set uniform ".concat(r," . No such uniform."),!1;if(a===void 0)throw new RangeError("Invalid number of values for array");return e.context.uniform2f(i,n,a),!0},t.setUniform2fv=function(r,n){var a=t.findUniform(r);return a===-1?(e.error="Could not set uniform ".concat(r," . No such uniform."),!1):(e.context.uniform2fv(a,n),!0)},t.setUniform2i=function(r,n,a){var i=t.findUniform(r);if(i===-1)return e.error="Could not set uniform ".concat(r," . No such uniform."),!1;if(a===void 0)throw new RangeError("Invalid number of values for array");return e.context.uniform2i(i,n,a),!0},t.setUniform2iv=function(r,n){var a=t.findUniform(r);return a===-1?(e.error="Could not set uniform ".concat(r," . No such uniform."),!1):(e.context.uniform2iv(a,n),!0)},t.setUniform3f=function(r,n,a,i){var s=t.findUniform(r);if(s===-1)return e.error="Could not set uniform ".concat(r," . No such uniform."),!1;if(i===void 0)throw new RangeError("Invalid number of values for array");return e.context.uniform3f(s,n,a,i),!0},t.setUniform3fArray=function(r,n){var a=t.findUniform(r);if(a===-1)return e.error="Could not set uniform ".concat(r," . No such uniform."),!1;if(!Array.isArray(n)||n.length!==3)throw new RangeError("Invalid number of values for array");return e.context.uniform3f(a,n[0],n[1],n[2]),!0},t.setUniform3fv=function(r,n){var a=t.findUniform(r);return a===-1?(e.error="Could not set uniform ".concat(r," . No such uniform."),!1):(e.context.uniform3fv(a,n),!0)},t.setUniform3i=function(r){var n=t.findUniform(r);if(n===-1)return e.error="Could not set uniform ".concat(r," . No such uniform."),!1;for(var a=arguments.length,i=new Array(a>1?a-1:0),s=1;s<a;s++)i[s-1]=arguments[s];var f=i;if(f.length===1&&Array.isArray(f[0])&&(f=f[0]),f.length!==3)throw new RangeError("Invalid number of values for array");return e.context.uniform3i(n,f[0],f[1],f[2]),!0},t.setUniform3iv=function(r,n){var a=t.findUniform(r);return a===-1?(e.error="Could not set uniform ".concat(r," . No such uniform."),!1):(e.context.uniform3iv(a,n),!0)},t.setUniform4f=function(r){var n=t.findUniform(r);if(n===-1)return e.error="Could not set uniform ".concat(r," . No such uniform."),!1;for(var a=arguments.length,i=new Array(a>1?a-1:0),s=1;s<a;s++)i[s-1]=arguments[s];var f=i;if(f.length===1&&Array.isArray(f[0])&&(f=f[0]),f.length!==4)throw new RangeError("Invalid number of values for array");return e.context.uniform4f(n,f[0],f[1],f[2],f[3]),!0},t.setUniform4fv=function(r,n){var a=t.findUniform(r);return a===-1?(e.error="Could not set uniform ".concat(r," . No such uniform."),!1):(e.context.uniform4fv(a,n),!0)},t.setUniform4i=function(r){var n=t.findUniform(r);if(n===-1)return e.error="Could not set uniform ".concat(r," . No such uniform."),!1;for(var a=arguments.length,i=new Array(a>1?a-1:0),s=1;s<a;s++)i[s-1]=arguments[s];var f=i;if(f.length===1&&Array.isArray(f[0])&&(f=f[0]),f.length!==4)throw new RangeError("Invalid number of values for array");return e.context.uniform4i(n,f[0],f[1],f[2],f[3]),!0},t.setUniform4iv=function(r,n){var a=t.findUniform(r);return a===-1?(e.error="Could not set uniform ".concat(r," . No such uniform."),!1):(e.context.uniform4iv(a,n),!0)},t.findUniform=function(r){if(!r||!e.linked)return-1;var n=e.uniformLocs[r];return n!==void 0?n:(n=e.context.getUniformLocation(e.handle,r),n===null?(e.error="Uniform ".concat(r," not found in current shader program."),e.uniformLocs[r]=-1,-1):(e.uniformLocs[r]=n,n))},t.isUniformUsed=function(r){if(!r)return!1;var n=e.uniformLocs[r];return n!==void 0?n!==null:e.linked?(n=e.context.getUniformLocation(e.handle,r),e.uniformLocs[r]=n,n!==null):(Ke("attempt to find uniform when the shader program is not linked"),!1)},t.isAttributeUsed=function(r){if(!r)return!1;if(r in e.attributeLocs)return!0;if(!e.linked)return Ke("attempt to find uniform when the shader program is not linked"),!1;var n=e.context.getAttribLocation(e.handle,r);return n===-1?!1:(e.attributeLocs[r]=n,!0)},t.attachShader=function(r){if(r.getHandle()===0)return e.error="Shader object was not initialized, cannot attach it.",!1;if(r.getShaderType()==="Unknown")return e.error="Shader object is of type Unknown and cannot be used.",!1;if(e.handle===0){var n=e.context.createProgram();if(n===0)return e.error="Could not create shader program.",!1;e.handle=n,e.linked=!1}return r.getShaderType()==="Vertex"&&(e.vertexShaderHandle!==0&&e.comntext.detachShader(e.handle,e.vertexShaderHandle),e.vertexShaderHandle=r.getHandle()),r.getShaderType()==="Fragment"&&(e.fragmentShaderHandle!==0&&e.context.detachShader(e.handle,e.fragmentShaderHandle),e.fragmentShaderHandle=r.getHandle()),e.context.attachShader(e.handle,r.getHandle()),t.setLinked(!1),!0},t.detachShader=function(r){if(r.getHandle()===0)return e.error="shader object was not initialized, cannot attach it.",!1;if(r.getShaderType()==="Unknown")return e.error="Shader object is of type Unknown and cannot be used.",!1;switch(e.handle===0&&(e.error="This shader program has not been initialized yet."),r.getShaderType()){case"Vertex":return e.vertexShaderHandle!==r.getHandle()?(e.error="The supplied shader was not attached to this program.",!1):(e.context.detachShader(e.handle,r.getHandle()),e.vertexShaderHandle=0,e.linked=!1,!0);case"Fragment":return e.fragmentShaderHandle!==r.getHandle()?(e.error="The supplied shader was not attached to this program.",!1):(e.context.detachShader(e.handle,r.getHandle()),e.fragmentShaderHandle=0,e.linked=!1,!0);default:return!1}},t.setContext=function(r){e.context=r,e.vertexShader.setContext(r),e.fragmentShader.setContext(r),e.geometryShader.setContext(r)},t.setLastCameraMTime=function(r){e.lastCameraMTime=r}}var bT={vertexShaderHandle:0,fragmentShaderHandle:0,geometryShaderHandle:0,vertexShader:null,fragmentShader:null,geometryShader:null,linked:!1,bound:!1,compiled:!1,error:"",handle:0,numberOfOutputs:0,attributesLocs:null,uniformLocs:null,md5Hash:0,context:null,lastCameraMTime:null};function ic(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,bT,r),e.attributesLocs={},e.uniformLocs={},e.vertexShader=ga.newInstance(),e.vertexShader.setShaderType("Vertex"),e.fragmentShader=ga.newInstance(),e.fragmentShader.setShaderType("Fragment"),e.geometryShader=ga.newInstance(),e.geometryShader.setShaderType("Geometry"),d.obj(t,e),d.get(t,e,["lastCameraMTime"]),d.setGet(t,e,["error","handle","compiled","bound","md5Hash","vertexShader","fragmentShader","geometryShader","linked"]),DT(t,e)}var LT=d.newInstance(ic,"vtkShaderProgram"),k={newInstance:LT,extend:ic,substitute:MT};function RT(t,e){e.classHierarchy.push("vtkOpenGLVertexArrayObject"),t.exposedMethod=function(){},t.initialize=function(){e.instancingExtension=null,e._openGLRenderWindow.getWebgl2()||(e.instancingExtension=e.context.getExtension("ANGLE_instanced_arrays")),!e.forceEmulation&&e._openGLRenderWindow&&e._openGLRenderWindow.getWebgl2()?(e.extension=null,e.supported=!0,e.handleVAO=e.context.createVertexArray()):(e.extension=e.context.getExtension("OES_vertex_array_object"),!e.forceEmulation&&e.extension?(e.supported=!0,e.handleVAO=e.extension.createVertexArrayOES()):e.supported=!1)},t.isReady=function(){return e.handleVAO!==0||e.supported===!1},t.bind=function(){if(t.isReady()||t.initialize(),t.isReady()&&e.supported)e.extension?e.extension.bindVertexArrayOES(e.handleVAO):e.context.bindVertexArray(e.handleVAO);else if(t.isReady())for(var r=e.context,n=0;n<e.buffers.length;++n){var a=e.buffers[n];e.context.bindBuffer(r.ARRAY_BUFFER,a.buffer);for(var i=0;i<a.attributes.length;++i)for(var s=a.attributes[i],f=s.isMatrix?s.size:1,o=0;o<f;++o)r.enableVertexAttribArray(s.index+o),r.vertexAttribPointer(s.index+o,s.size,s.type,s.normalize,s.stride,s.offset+s.stride*o/s.size),s.divisor>0&&(e.instancingExtension?e.instancingExtension.vertexAttribDivisorANGLE(s.index+o,1):r.vertexAttribDivisor(s.index+o,1))}},t.release=function(){if(t.isReady()&&e.supported)e.extension?e.extension.bindVertexArrayOES(null):e.context.bindVertexArray(null);else if(t.isReady())for(var r=e.context,n=0;n<e.buffers.length;++n){var a=e.buffers[n];e.context.bindBuffer(r.ARRAY_BUFFER,a.buffer);for(var i=0;i<a.attributes.length;++i)for(var s=a.attributes[i],f=s.isMatrix?s.size:1,o=0;o<f;++o)r.enableVertexAttribArray(s.index+o),r.vertexAttribPointer(s.index+o,s.size,s.type,s.normalize,s.stride,s.offset+s.stride*o/s.size),s.divisor>0&&(e.instancingExtension?e.instancingExtension.vertexAttribDivisorANGLE(s.index+o,0):r.vertexAttribDivisor(s.index+o,0)),r.disableVertexAttribArray(s.index+o)}},t.shaderProgramChanged=function(){t.release(),e.handleVAO&&(e.extension?e.extension.deleteVertexArrayOES(e.handleVAO):e.context.deleteVertexArray(e.handleVAO)),e.handleVAO=0,e.handleProgram=0},t.releaseGraphicsResources=function(){t.shaderProgramChanged(),e.handleVAO&&(e.extension?e.extension.deleteVertexArrayOES(e.handleVAO):e.context.deleteVertexArray(e.handleVAO)),e.handleVAO=0,e.supported=!0,e.handleProgram=0},t.addAttributeArray=function(r,n,a,i,s,f,o,u){return t.addAttributeArrayWithDivisor(r,n,a,i,s,f,o,u,0,!1)},t.addAttributeArrayWithDivisor=function(r,n,a,i,s,f,o,u,c,g){if(!r||!r.isBound()||n.getHandle()===0||n.getType()!==Or.ARRAY_BUFFER||(e.handleProgram===0&&(e.handleProgram=r.getHandle()),t.isReady()||t.initialize(),!t.isReady()||e.handleProgram!==r.getHandle()))return!1;var v=e.context,p={};if(p.name=a,p.index=v.getAttribLocation(e.handleProgram,a),p.offset=i,p.stride=s,p.type=f,p.size=o,p.normalize=u,p.isMatrix=g,p.divisor=c,p.Index===-1)return!1;if(n.bind(),v.enableVertexAttribArray(p.index),v.vertexAttribPointer(p.index,p.size,p.type,p.normalize,p.stride,p.offset),c>0&&(e.instancingExtension?e.instancingExtension.vertexAttribDivisorANGLE(p.index,1):v.vertexAttribDivisor(p.index,1)),p.buffer=n.getHandle(),!e.supported){for(var l=!1,y=0;y<e.buffers.length;++y){var h=e.buffers[y];if(h.buffer===p.buffer){l=!0;for(var T=!1,x=0;x<h.attributes.length;++x){var S=h.attributes[x];S.name===a&&(T=!0,h.attributes[x]=p)}T||h.attributes.push(p)}}l||e.buffers.push({buffer:p.buffer,attributes:[p]})}return!0},t.addAttributeMatrixWithDivisor=function(r,n,a,i,s,f,o,u,c){var g=t.addAttributeArrayWithDivisor(r,n,a,i,s,f,o,u,c,!0);if(!g)return g;for(var v=e.context,p=v.getAttribLocation(e.handleProgram,a),l=1;l<o;l++)v.enableVertexAttribArray(p+l),v.vertexAttribPointer(p+l,o,f,u,s,i+s*l/o),c>0&&(e.instancingExtension?e.instancingExtension.vertexAttribDivisorANGLE(p+l,1):v.vertexAttribDivisor(p+l,1));return!0},t.removeAttributeArray=function(r){if(!t.isReady()||e.handleProgram===0)return!1;if(!e.supported)for(var n=0;n<e.buffers.length;++n)for(var a=e.buffers[n],i=0;i<a.attributes.length;++i){var s=a.attributes[i];if(s.name===r)return a.attributes.splice(i,1),a.attributes.length||e.buffers.splice(n,1),!0}return!0},t.setOpenGLRenderWindow=function(r){e._openGLRenderWindow!==r&&(t.releaseGraphicsResources(),e._openGLRenderWindow=r,e.context=null,r&&(e.context=e._openGLRenderWindow.getContext()))}}var VT={forceEmulation:!1,handleVAO:0,handleProgram:0,supported:!0,buffers:null,context:null};function sc(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,VT,r),e.buffers=[],d.obj(t,e),d.get(t,e,["supported"]),d.setGet(t,e,["forceEmulation"]),RT(t,e)}var kT=d.newInstance(sc,"vtkOpenGLVertexArrayObject"),BT={newInstance:kT,extend:sc},lt={Start:0,Points:0,Lines:1,Tris:2,TriStrips:3,TrisEdges:4,TriStripsEdges:5,End:6};function UT(t,e){e.classHierarchy.push("vtkOpenGLHelper"),t.setOpenGLRenderWindow=function(r){e.context=r.getContext(),e.program.setContext(e.context),e.VAO.setOpenGLRenderWindow(r),e.CABO.setOpenGLRenderWindow(r)},t.releaseGraphicsResources=function(r){e.VAO.releaseGraphicsResources(),e.CABO.releaseGraphicsResources(),e.CABO.setElementCount(0)},t.drawArrays=function(r,n,a,i){if(e.CABO.getElementCount()){var s=t.getOpenGLMode(a),f=t.haveWideLines(r,n),o=e.context,u=o.getParameter(o.DEPTH_WRITEMASK);e.pointPicking&&o.depthMask(!1);var c=s===o.LINES;c&&f?(t.updateShaders(r,n,i),o.drawArraysInstanced(s,0,e.CABO.getElementCount(),2*Math.ceil(n.getProperty().getLineWidth()))):(o.lineWidth(n.getProperty().getLineWidth()),t.updateShaders(r,n,i),o.drawArrays(s,0,e.CABO.getElementCount()),o.lineWidth(1));var g=(s===o.POINTS?1:0)||(s===o.LINES?2:3);return e.pointPicking&&o.depthMask(u),e.CABO.getElementCount()/g}return 0},t.getOpenGLMode=function(r){if(e.pointPicking)return e.context.POINTS;var n=e.primitiveType;return r===Fe.POINTS||n===lt.Points?e.context.POINTS:r===Fe.WIREFRAME||n===lt.Lines||n===lt.TrisEdges||n===lt.TriStripsEdges?e.context.LINES:e.context.TRIANGLES},t.haveWideLines=function(r,n){return n.getProperty().getLineWidth()>1?!(e.CABO.getOpenGLRenderWindow()&&e.CABO.getOpenGLRenderWindow().getHardwareMaximumLineWidth()>=n.getProperty().getLineWidth()):!1},t.getNeedToRebuildShaders=function(r,n,a){return!!(a.getNeedToRebuildShaders(t,r,n)||t.getProgram()===0||t.getShaderSourceTime().getMTime()<a.getMTime()||t.getShaderSourceTime().getMTime()<n.getMTime())},t.updateShaders=function(r,n,a){if(t.getNeedToRebuildShaders(r,n,a)){var i={Vertex:null,Fragment:null,Geometry:null};a.buildShaders(i,r,n);var s=e.CABO.getOpenGLRenderWindow().getShaderCache().readyShaderProgramArray(i.Vertex,i.Fragment,i.Geometry);s!==t.getProgram()&&(t.setProgram(s),t.getVAO().releaseGraphicsResources()),t.getShaderSourceTime().modified()}else e.CABO.getOpenGLRenderWindow().getShaderCache().readyShaderProgram(t.getProgram());t.getVAO().bind(),a.setMapperShaderParameters(t,r,n),a.setPropertyShaderParameters(t,r,n),a.setCameraShaderParameters(t,r,n),a.setLightingShaderParameters(t,r,n),a.invokeShaderCallbacks(t,r,n)},t.setMapperShaderParameters=function(r,n,a){if(t.haveWideLines(r,n)){t.getProgram().setUniform2f("viewportSize",a.usize,a.vsize);var i=parseFloat(n.getProperty().getLineWidth()),s=i/2;t.getProgram().setUniformf("lineWidthStepSize",i/Math.ceil(i)),t.getProgram().setUniformf("halfLineWidth",s)}e.primitiveType===lt.Points||n.getProperty().getRepresentation()===Fe.POINTS?t.getProgram().setUniformf("pointSize",n.getProperty().getPointSize()):e.pointPicking&&t.getProgram().setUniformf("pointSize",t.getPointPickingPrimitiveSize())},t.replaceShaderPositionVC=function(r,n,a){var i=r.Vertex;i=k.substitute(i,"//VTK::PositionVC::Dec",["//VTK::PositionVC::Dec","uniform float pointSize;"]).result,i=k.substitute(i,"//VTK::PositionVC::Impl",["//VTK::PositionVC::Impl","  gl_PointSize = pointSize;"],!1).result,t.getOpenGLMode(a.getProperty().getRepresentation())===e.context.LINES&&t.haveWideLines(n,a)&&(i=k.substitute(i,"//VTK::PositionVC::Dec",["//VTK::PositionVC::Dec","uniform vec2 viewportSize;","uniform float lineWidthStepSize;","uniform float halfLineWidth;"]).result,i=k.substitute(i,"//VTK::PositionVC::Impl",["//VTK::PositionVC::Impl"," if (halfLineWidth > 0.0)","   {","   float offset = float(gl_InstanceID / 2) * lineWidthStepSize - halfLineWidth;","   vec4 tmpPos = gl_Position;","   vec3 tmpPos2 = tmpPos.xyz / tmpPos.w;","   tmpPos2.x = tmpPos2.x + 2.0 * mod(float(gl_InstanceID), 2.0) * offset / viewportSize[0];","   tmpPos2.y = tmpPos2.y + 2.0 * mod(float(gl_InstanceID + 1), 2.0) * offset / viewportSize[1];","   gl_Position = vec4(tmpPos2.xyz * tmpPos.w, tmpPos.w);","   }"]).result),r.Vertex=i},t.getPointPickingPrimitiveSize=function(){return e.primitiveType===lt.Points?2:e.primitiveType===lt.Lines?4:6}}var NT={context:null,program:null,shaderSourceTime:null,VAO:null,attributeUpdateTime:null,CABO:null,primitiveType:0,pointPicking:!1};function oc(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,NT,r),d.obj(t,e),e.shaderSourceTime={},d.obj(e.shaderSourceTime),e.attributeUpdateTime={},d.obj(e.attributeUpdateTime),d.setGet(t,e,["program","shaderSourceTime","VAO","attributeUpdateTime","CABO","primitiveType","pointPicking"]),e.program=k.newInstance(),e.VAO=BT.newInstance(),e.CABO=OT.newInstance(),UT(t,e)}var FT=d.newInstance(oc),Gr={newInstance:FT,extend:oc,primTypes:lt},mT={CLAMP_TO_EDGE:0,REPEAT:1,MIRRORED_REPEAT:2},GT={NEAREST:0,LINEAR:1,NEAREST_MIPMAP_NEAREST:2,NEAREST_MIPMAP_LINEAR:3,LINEAR_MIPMAP_NEAREST:4,LINEAR_MIPMAP_LINEAR:5},Ei={Wrap:mT,Filter:GT},fc=new Float32Array(1),_T=new Int32Array(fc.buffer);function AT(t){fc[0]=t;var e=_T[0],r=e>>16&32768,n=e>>12&2047,a=e>>23&255;return a<103?r:a>142?(r|=31744,r|=(a===255?0:1)&&e&8388607,r):a<113?(n|=2048,r|=(n>>114-a)+(n>>113-a&1),r):(r|=a-112<<10|n>>1,r+=n&1,r)}function $T(t){var e=(t&32768)>>15,r=(t&31744)>>10,n=t&1023;return r===0?(e?-1:1)*Math.pow(2,-14)*(n/Math.pow(2,10)):r===31?n?NaN:(e?-1:1)*(1/0):(e?-1:1)*Math.pow(2,r-15)*(1+n/Math.pow(2,10))}var bt={fromHalf:$T,toHalf:AT};function Zs(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function WT(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Zs(Object(r),!0).forEach(function(n){K(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Zs(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var tt=Ei.Wrap,he=Ei.Filter,H=ve.VtkDataTypes,va=_t,Ht=Y,zT=Ya;function jT(t,e){e.classHierarchy.push("vtkOpenGLTexture"),t.render=function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;if(o?e._openGLRenderWindow=o:(e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getParent()),e.context=e._openGLRenderWindow.getContext(),e.renderable.getInterpolate()?(e.generateMipmap?t.setMinificationFilter(he.LINEAR_MIPMAP_LINEAR):t.setMinificationFilter(he.LINEAR),t.setMagnificationFilter(he.LINEAR)):(t.setMinificationFilter(he.NEAREST),t.setMagnificationFilter(he.NEAREST)),e.renderable.getRepeat()&&(t.setWrapR(tt.REPEAT),t.setWrapS(tt.REPEAT),t.setWrapT(tt.REPEAT)),e.renderable.getInputData()&&e.renderable.setImage(null),!e.handle||e.renderable.getMTime()>e.textureBuildTime.getMTime()){if(e.renderable.getImage()!==null&&(e.renderable.getInterpolate()&&(e.generateMipmap=!0,t.setMinificationFilter(he.LINEAR_MIPMAP_LINEAR)),e.renderable.getImage()&&e.renderable.getImageLoaded()&&(t.create2DFromImage(e.renderable.getImage()),t.activate(),t.sendParameters(),e.textureBuildTime.modified())),e.renderable.getCanvas()!==null){e.renderable.getInterpolate()&&(e.generateMipmap=!0,t.setMinificationFilter(he.LINEAR_MIPMAP_LINEAR));var u=e.renderable.getCanvas();t.create2DFromRaw(u.width,u.height,4,H.UNSIGNED_CHAR,u,!0),t.activate(),t.sendParameters(),e.textureBuildTime.modified()}if(e.renderable.getJsImageData()!==null){var c=e.renderable.getJsImageData();e.renderable.getInterpolate()&&(e.generateMipmap=!0,t.setMinificationFilter(he.LINEAR_MIPMAP_LINEAR)),t.create2DFromRaw(c.width,c.height,4,H.UNSIGNED_CHAR,c.data,!0),t.activate(),t.sendParameters(),e.textureBuildTime.modified()}var g=e.renderable.getInputData(0);if(g&&g.getPointData().getScalars()){for(var v=g.getExtent(),p=g.getPointData().getScalars(),l=[],y=0;y<e.renderable.getNumberOfInputPorts();++y){var h=e.renderable.getInputData(y),T=h?h.getPointData().getScalars().getData():null;T&&l.push(T)}e.renderable.getInterpolate()&&p.getNumberOfComponents()===4&&(e.generateMipmap=!0,t.setMinificationFilter(he.LINEAR_MIPMAP_LINEAR)),l.length%6===0?t.createCubeFromRaw(v[1]-v[0]+1,v[3]-v[2]+1,p.getNumberOfComponents(),p.getDataType(),l):t.create2DFromRaw(v[1]-v[0]+1,v[3]-v[2]+1,p.getNumberOfComponents(),p.getDataType(),p.getData()),t.activate(),t.sendParameters(),e.textureBuildTime.modified()}}e.handle&&t.activate()},t.destroyTexture=function(){t.deactivate(),e.context&&e.handle&&e.context.deleteTexture(e.handle),e.handle=0,e.numberOfDimensions=0,e.target=0,e.components=0,e.width=0,e.height=0,e.depth=0,t.resetFormatAndType()},t.createTexture=function(){e.handle||(e.handle=e.context.createTexture(),e.target&&(e.context.bindTexture(e.target,e.handle),e.context.texParameteri(e.target,e.context.TEXTURE_MIN_FILTER,t.getOpenGLFilterMode(e.minificationFilter)),e.context.texParameteri(e.target,e.context.TEXTURE_MAG_FILTER,t.getOpenGLFilterMode(e.magnificationFilter)),e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_S,t.getOpenGLWrapMode(e.wrapS)),e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_T,t.getOpenGLWrapMode(e.wrapT)),e._openGLRenderWindow.getWebgl2()&&e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_R,t.getOpenGLWrapMode(e.wrapR)),e.context.bindTexture(e.target,null)))},t.getTextureUnit=function(){return e._openGLRenderWindow?e._openGLRenderWindow.getTextureUnitForTexture(t):-1},t.activate=function(){e._openGLRenderWindow.activateTexture(t),t.bind()},t.deactivate=function(){e._openGLRenderWindow&&e._openGLRenderWindow.deactivateTexture(t)},t.releaseGraphicsResources=function(o){o&&e.handle&&(o.activateTexture(t),o.deactivateTexture(t),e.context.deleteTexture(e.handle),e.handle=0,e.numberOfDimensions=0,e.target=0,e.internalFormat=0,e.format=0,e.openGLDataType=0,e.components=0,e.width=0,e.height=0,e.depth=0),e.shaderProgram&&(e.shaderProgram.releaseGraphicsResources(o),e.shaderProgram=null)},t.bind=function(){e.context.bindTexture(e.target,e.handle),e.autoParameters&&t.getMTime()>e.sendParametersTime.getMTime()&&t.sendParameters()},t.isBound=function(){var o=!1;if(e.context&&e.handle){var u=0;switch(e.target){case e.context.TEXTURE_2D:u=e.context.TEXTURE_BINDING_2D;break;default:zT("impossible case");break}var c=e.context.getIntegerv(u);o=c===e.handle}return o},t.sendParameters=function(){e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_S,t.getOpenGLWrapMode(e.wrapS)),e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_T,t.getOpenGLWrapMode(e.wrapT)),e._openGLRenderWindow.getWebgl2()&&e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_R,t.getOpenGLWrapMode(e.wrapR)),e.context.texParameteri(e.target,e.context.TEXTURE_MIN_FILTER,t.getOpenGLFilterMode(e.minificationFilter)),e.context.texParameteri(e.target,e.context.TEXTURE_MAG_FILTER,t.getOpenGLFilterMode(e.magnificationFilter)),e._openGLRenderWindow.getWebgl2()&&(e.context.texParameteri(e.target,e.context.TEXTURE_BASE_LEVEL,e.baseLevel),e.context.texParameteri(e.target,e.context.TEXTURE_MAX_LEVEL,e.maxLevel)),e.sendParametersTime.modified()},t.getInternalFormat=function(o,u){return e._forceInternalFormat||(e.internalFormat=t.getDefaultInternalFormat(o,u)),e.internalFormat||va("Unable to find suitable internal format for T=".concat(o," NC= ").concat(u)),e.internalFormat},t.getDefaultInternalFormat=function(o,u){var c=0;return c=e._openGLRenderWindow.getDefaultTextureInternalFormat(o,u,e.oglNorm16Ext,e.useHalfFloat),c||(c||(va("Unsupported internal texture type!"),va("Unable to find suitable internal format for T=".concat(o," NC= ").concat(u))),c)},t.setInternalFormat=function(o){e._forceInternalFormat=!0,o!==e.internalFormat&&(e.internalFormat=o,t.modified())},t.getFormat=function(o,u){return e.format=t.getDefaultFormat(o,u),e.format},t.getDefaultFormat=function(o,u){if(e._openGLRenderWindow.getWebgl2())switch(u){case 1:return e.context.RED;case 2:return e.context.RG;case 3:return e.context.RGB;case 4:return e.context.RGBA;default:return e.context.RGB}else switch(u){case 1:return e.context.LUMINANCE;case 2:return e.context.LUMINANCE_ALPHA;case 3:return e.context.RGB;case 4:return e.context.RGBA;default:return e.context.RGB}},t.resetFormatAndType=function(){e.format=0,e.internalFormat=0,e._forceInternalFormat=!1,e.openGLDataType=0},t.getDefaultDataType=function(o){if(e._openGLRenderWindow.getWebgl2())switch(o){case H.UNSIGNED_CHAR:return e.context.UNSIGNED_BYTE;case(e.oglNorm16Ext&&!e.useHalfFloat&&H.SHORT):return e.context.SHORT;case(e.oglNorm16Ext&&!e.useHalfFloat&&H.UNSIGNED_SHORT):return e.context.UNSIGNED_SHORT;case(e.useHalfFloat&&H.SHORT):return e.context.HALF_FLOAT;case(e.useHalfFloat&&H.UNSIGNED_SHORT):return e.context.HALF_FLOAT;case H.FLOAT:case H.VOID:default:return e.context.FLOAT}switch(o){case H.UNSIGNED_CHAR:return e.context.UNSIGNED_BYTE;case H.FLOAT:case H.VOID:default:if(e.context.getExtension("OES_texture_float")&&e.context.getExtension("OES_texture_float_linear"))return e.context.FLOAT;{var u=e.context.getExtension("OES_texture_half_float");if(u&&e.context.getExtension("OES_texture_half_float_linear"))return u.HALF_FLOAT_OES}return e.context.UNSIGNED_BYTE}},t.getOpenGLDataType=function(o){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return(!e.openGLDataType||u)&&(e.openGLDataType=t.getDefaultDataType(o)),e.openGLDataType},t.getShiftAndScale=function(){var o=0,u=1;switch(e.openGLDataType){case e.context.BYTE:u=127.5,o=u-128;break;case e.context.UNSIGNED_BYTE:u=255,o=0;break;case e.context.SHORT:u=32767.5,o=u-32768;break;case e.context.UNSIGNED_SHORT:u=65536,o=0;break;case e.context.INT:u=21474836475e-1,o=u-2147483648;break;case e.context.UNSIGNED_INT:u=4294967295,o=0;break;case e.context.FLOAT:}return{shift:o,scale:u}},t.getOpenGLFilterMode=function(o){switch(o){case he.NEAREST:return e.context.NEAREST;case he.LINEAR:return e.context.LINEAR;case he.NEAREST_MIPMAP_NEAREST:return e.context.NEAREST_MIPMAP_NEAREST;case he.NEAREST_MIPMAP_LINEAR:return e.context.NEAREST_MIPMAP_LINEAR;case he.LINEAR_MIPMAP_NEAREST:return e.context.LINEAR_MIPMAP_NEAREST;case he.LINEAR_MIPMAP_LINEAR:return e.context.LINEAR_MIPMAP_LINEAR;default:return e.context.NEAREST}},t.getOpenGLWrapMode=function(o){switch(o){case tt.CLAMP_TO_EDGE:return e.context.CLAMP_TO_EDGE;case tt.REPEAT:return e.context.REPEAT;case tt.MIRRORED_REPEAT:return e.context.MIRRORED_REPEAT;default:return e.context.CLAMP_TO_EDGE}};function r(o,u){var c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,g=[],v=e.width*e.height*e.components;if(c&&(v*=e.depth),o!==H.FLOAT&&e.openGLDataType===e.context.FLOAT)for(var p=0;p<u.length;p++)if(u[p]){var l=u[p].length>v?u[p].subarray(0,v):u[p];g.push(new Float32Array(l))}else g.push(null);if(o!==H.UNSIGNED_CHAR&&e.openGLDataType===e.context.UNSIGNED_BYTE)for(var y=0;y<u.length;y++)if(u[y]){var h=u[y].length>v?u[y].subarray(0,v):u[y];g.push(new Uint8Array(h))}else g.push(null);var T=!1;if(e._openGLRenderWindow.getWebgl2())T=e.openGLDataType===e.context.HALF_FLOAT;else{var x=e.context.getExtension("OES_texture_half_float");T=x&&e.openGLDataType===x.HALF_FLOAT_OES}if(T)for(var S=0;S<u.length;S++)if(u[S]){for(var O=new Uint16Array(v),C=0;C<v;C++)O[C]=bt.toHalf(u[S][C]);g.push(O)}else g.push(null);if(g.length===0)for(var w=0;w<u.length;w++)g.push(u[w]);return g}function n(o){if(e._openGLRenderWindow.getWebgl2())return o;var u=[],c=e.width,g=e.height,v=e.components;if(o&&(!qr(c)||!qr(g)))for(var p=e.context.getExtension("OES_texture_half_float"),l=$e(c),y=$e(g),h=l*y*e.components,T=0;T<o.length;T++)if(o[T]!==null){var x=null,S=g/y,O=c/l,C=!1;e.openGLDataType===e.context.FLOAT?x=new Float32Array(h):p&&e.openGLDataType===p.HALF_FLOAT_OES?(x=new Uint16Array(h),C=!0):x=new Uint8Array(h);for(var w=0;w<y;w++){var E=w*l*v,M=w*S,L=Math.floor(M),b=Math.ceil(M);b>=g&&(b=g-1);var D=M-L,V=1-D;L=L*c*v,b=b*c*v;for(var B=0;B<l;B++){var R=B*v,N=B*O,U=Math.floor(N),G=Math.ceil(N);G>=c&&(G=c-1);var m=N-U;U*=v,G*=v;for(var F=0;F<v;F++)C?x[E+R+F]=bt.toHalf(bt.fromHalf(o[T][L+U+F])*V*(1-m)+bt.fromHalf(o[T][L+G+F])*V*m+bt.fromHalf(o[T][b+U+F])*D*(1-m)+bt.fromHalf(o[T][b+G+F])*D*m):x[E+R+F]=o[T][L+U+F]*V*(1-m)+o[T][L+G+F]*V*m+o[T][b+U+F]*D*(1-m)+o[T][b+G+F]*D*m}}u.push(x),e.width=l,e.height=y}else u.push(null);if(u.length===0)for(var I=0;I<o.length;I++)u.push(o[I]);return u}function a(o){if(e._openGLRenderWindow){if(e.resizable)return!1;if(e._openGLRenderWindow.getWebgl2()){var u=e._openGLRenderWindow.getGLInformations();return!(u.RENDERER.value.match(/WebKit/gi)&&navigator.platform.match(/Mac/gi)&&e.oglNorm16Ext&&(o===H.UNSIGNED_SHORT||o===H.SHORT))}return!1}return!1}t.create2DFromRaw=function(o,u,c,g,v){var p=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1;if(t.getOpenGLDataType(g,!0),t.getInternalFormat(g,c),t.getFormat(g,c),!e.internalFormat||!e.format||!e.openGLDataType)return Ht("Failed to determine texture parameters."),!1;e.target=e.context.TEXTURE_2D,e.components=c,e.width=o,e.height=u,e.depth=1,e.numberOfDimensions=2,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind();var l=[v],y=r(g,l),h=n(y);return e.context.pixelStorei(e.context.UNPACK_FLIP_Y_WEBGL,p),e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1),a(g)?(e.context.texStorage2D(e.target,1,e.internalFormat,e.width,e.height),h[0]!=null&&e.context.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.openGLDataType,h[0])):e.context.texImage2D(e.target,0,e.internalFormat,e.width,e.height,0,e.format,e.openGLDataType,h[0]),e.generateMipmap&&e.context.generateMipmap(e.target),p&&e.context.pixelStorei(e.context.UNPACK_FLIP_Y_WEBGL,!1),t.deactivate(),!0},t.createCubeFromRaw=function(o,u,c,g,v){if(t.getOpenGLDataType(g),t.getInternalFormat(g,c),t.getFormat(g,c),!e.internalFormat||!e.format||!e.openGLDataType)return Ht("Failed to determine texture parameters."),!1;e.target=e.context.TEXTURE_CUBE_MAP,e.components=c,e.width=o,e.height=u,e.depth=1,e.numberOfDimensions=2,e._openGLRenderWindow.activateTexture(t),e.maxLevel=v.length/6-1,t.createTexture(),t.bind();for(var p=r(g,v),l=n(p),y=[],h=e.width,T=e.height,x=0;x<l.length;x++){x%6===0&&x!==0&&(h/=2,T/=2),y[x]=Br(g,T*h*e.components);for(var S=0;S<T;++S){var O=S*h*e.components,C=(T-S-1)*h*e.components;y[x].set(l[x].slice(C,C+h*e.components),O)}}e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1),a(g)&&e.context.texStorage2D(e.target,6,e.internalFormat,e.width,e.height);for(var w=0;w<6;w++)for(var E=0,M=e.width,L=e.height;M>=1&&L>=1;){var b=null;E<=e.maxLevel&&(b=y[6*E+w]),e._openGLRenderWindow.getWebgl2()&&!e.resizable?b!=null&&e.context.texSubImage2D(e.context.TEXTURE_CUBE_MAP_POSITIVE_X+w,E,0,0,M,L,e.format,e.openGLDataType,b):e.context.texImage2D(e.context.TEXTURE_CUBE_MAP_POSITIVE_X+w,E,e.internalFormat,M,L,0,e.format,e.openGLDataType,b),E++,M/=2,L/=2}return t.deactivate(),!0},t.createDepthFromRaw=function(o,u,c,g){return t.getOpenGLDataType(c),e.format=e.context.DEPTH_COMPONENT,e._openGLRenderWindow.getWebgl2()?c===H.FLOAT?e.internalFormat=e.context.DEPTH_COMPONENT32F:e.internalFormat=e.context.DEPTH_COMPONENT16:e.internalFormat=e.context.DEPTH_COMPONENT,!e.internalFormat||!e.format||!e.openGLDataType?(Ht("Failed to determine texture parameters."),!1):(e.target=e.context.TEXTURE_2D,e.components=1,e.width=o,e.height=u,e.depth=1,e.numberOfDimensions=2,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind(),e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1),a(c)?(e.context.texStorage2D(e.target,1,e.internalFormat,e.width,e.height),g!=null&&e.context.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.openGLDataType,g)):e.context.texImage2D(e.target,0,e.internalFormat,e.width,e.height,0,e.format,e.openGLDataType,g),e.generateMipmap&&e.context.generateMipmap(e.target),t.deactivate(),!0)},t.create2DFromImage=function(o){if(t.getOpenGLDataType(H.UNSIGNED_CHAR),t.getInternalFormat(H.UNSIGNED_CHAR,4),t.getFormat(H.UNSIGNED_CHAR,4),!e.internalFormat||!e.format||!e.openGLDataType)return Ht("Failed to determine texture parameters."),!1;e.target=e.context.TEXTURE_2D,e.components=4,e.depth=1,e.numberOfDimensions=2,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind(),e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1);var u=!e._openGLRenderWindow.getWebgl2()&&(!qr(o.width)||!qr(o.height)),c=document.createElement("canvas");c.width=u?$e(o.width):o.width,c.height=u?$e(o.height):o.height,e.width=c.width,e.height=c.height;var g=c.getContext("2d");g.translate(0,c.height),g.scale(1,-1),g.drawImage(o,0,0,o.width,o.height,0,0,c.width,c.height);var v=c;return a(H.UNSIGNED_CHAR)?(e.context.texStorage2D(e.target,1,e.internalFormat,e.width,e.height),v!=null&&e.context.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.openGLDataType,v)):e.context.texImage2D(e.target,0,e.internalFormat,e.width,e.height,0,e.format,e.openGLDataType,v),e.generateMipmap&&e.context.generateMipmap(e.target),t.deactivate(),!0};function i(o,u,c){for(var g=[],v=[],p=0;p<o;++p){var l=Cu.fastComputeRange(c,p,o);g[p]=l.min,v[p]=l.max}for(var y=[],h=[],T=0;T<o;++T)g[T]===v[T]&&(v[T]=g[T]+1),y[T]=g[T],h[T]=v[T]-g[T];return{scale:h,offset:y}}function s(o,u){for(var c=0;c<o.length;c++){var g=o[c],v=u[c]+g;if(g<-2048||g>2048||v<-2048||v>2048)return!1}return!0}function f(o,u,c,g){t.getOpenGLDataType(o);var v=!1;if(e._openGLRenderWindow.getWebgl2())v=e.openGLDataType===e.context.HALF_FLOAT;else{var p=e.context.getExtension("OES_texture_half_float");v=p&&e.openGLDataType===p.HALF_FLOAT_OES}return!(!v||!s(u,c)&&!g)}t.create3DFromRaw=function(o,u,c,g,v,p){if(t.getOpenGLDataType(v),t.getInternalFormat(v,g),t.getFormat(v,g),!e.internalFormat||!e.format||!e.openGLDataType)return Ht("Failed to determine texture parameters."),!1;e.target=e.context.TEXTURE_3D,e.components=g,e.width=o,e.height=u,e.depth=c,e.numberOfDimensions=3,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind();var l=[p],y=!0,h=r(v,l,y),T=n(h);return a(v)?(e.context.texStorage3D(e.target,1,e.internalFormat,e.width,e.height,e.depth),T[0]!=null&&e.context.texSubImage3D(e.target,0,0,0,0,e.width,e.height,e.depth,e.format,e.openGLDataType,T[0])):e.context.texImage3D(e.target,0,e.internalFormat,e.width,e.height,e.depth,0,e.format,e.openGLDataType,T[0]),e.generateMipmap&&e.context.generateMipmap(e.target),t.deactivate(),!0},t.create3DFilterableFromRaw=function(o,u,c,g,v,p){for(var l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:!1,y=o*u*c,h=[],T=[],x=0;x<g;++x)h[x]=0,T[x]=1;e.volumeInfo={scale:T,offset:h,width:o,height:u,depth:c};var S=i(g,y,p),O=S.offset,C=S.scale;if(e.volumeInfo.dataComputedScale=C,e.volumeInfo.dataComputedOffset=O,e.useHalfFloat=f(v,O,C,l),e.useHalfFloat||t.getOpenGLDataType(v,!0),e._openGLRenderWindow.getWebgl2()){if(e.oglNorm16Ext&&!e.useHalfFloat&&v===H.SHORT){for(var w=0;w<g;++w)e.volumeInfo.scale[w]=32767;return t.create3DFromRaw(o,u,c,g,v,p)}if(e.oglNorm16Ext&&!e.useHalfFloat&&v===H.UNSIGNED_SHORT){for(var E=0;E<g;++E)e.volumeInfo.scale[E]=65535;return t.create3DFromRaw(o,u,c,g,v,p)}if(v===H.FLOAT||e.useHalfFloat&&(v===H.SHORT||v===H.UNSIGNED_SHORT))return t.create3DFromRaw(o,u,c,g,v,p);if(v===H.UNSIGNED_CHAR){for(var M=0;M<g;++M)e.volumeInfo.scale[M]=255;return t.create3DFromRaw(o,u,c,g,v,p)}var L=new Float32Array(y*g);e.volumeInfo.offset=O,e.volumeInfo.scale=C;for(var b=0,D=C.map(function(Wr){return 1/Wr}),V=0;V<y;V++)for(var B=0;B<g;B++)L[b]=(p[b]-O[B])*D[B],b++;return t.create3DFromRaw(o,u,c,g,H.FLOAT,L)}var R=i(g,y,p),N=function(or,fr,ur,zr,jr){or[fr]=ur},U=H.UNSIGNED_CHAR;if(v===H.UNSIGNED_CHAR)for(var G=0;G<g;++G)R.offset[G]=0,R.scale[G]=255;else e.context.getExtension("OES_texture_float")&&e.context.getExtension("OES_texture_float_linear")?(U=H.FLOAT,N=function(or,fr,ur,zr,jr){or[fr]=(ur-zr)/jr}):(U=H.UNSIGNED_CHAR,N=function(or,fr,ur,zr,jr){or[fr]=255*(ur-zr)/jr});if(t.getOpenGLDataType(U),t.getInternalFormat(U,g),t.getFormat(U,g),!e.internalFormat||!e.format||!e.openGLDataType)return Ht("Failed to determine texture parameters."),!1;e.target=e.context.TEXTURE_2D,e.components=g,e.depth=1,e.numberOfDimensions=2;var m=e.context.getParameter(e.context.MAX_TEXTURE_SIZE);m>4096&&(U===H.FLOAT||g>=3)&&(m=4096);var F=1,I=1;y>m*m&&(F=Math.ceil(Math.sqrt(y/(m*m))),I=F);var xe=Math.sqrt(y)/F;xe=$e(xe);var se=Math.floor(xe*F/o),oe=Math.ceil(c/se),fe=$e(u*oe/I);e.width=xe,e.height=fe,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind(),e.volumeInfo.xreps=se,e.volumeInfo.yreps=oe,e.volumeInfo.xstride=F,e.volumeInfo.ystride=I,e.volumeInfo.offset=R.offset,e.volumeInfo.scale=R.scale;var J,de=xe*fe*g;U===H.FLOAT?J=new Float32Array(de):J=new Uint8Array(de);for(var qe=0,xt=Math.floor(o/F),$r=Math.floor(u/I),ot=0;ot<oe;ot++)for(var ft=Math.min(se,c-ot*se),ue=g*(e.width-ft*Math.floor(o/F)),A=0;A<$r;A++){for(var P=0;P<ft;P++)for(var Q=g*((ot*se+P)*o*u+I*A*o),$=0;$<xt;$++)for(var Pe=0;Pe<g;Pe++)N(J,qe,p[Q+F*$*g+Pe],R.offset[Pe],R.scale[Pe]),qe++;qe+=ue}return e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1),a(U)?(e.context.texStorage2D(e.target,1,e.internalFormat,e.width,e.height),J!=null&&e.context.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.openGLDataType,J)):e.context.texImage2D(e.target,0,e.internalFormat,e.width,e.height,0,e.format,e.openGLDataType,J),t.deactivate(),!0},t.setOpenGLRenderWindow=function(o){e._openGLRenderWindow!==o&&(t.releaseGraphicsResources(),e._openGLRenderWindow=o,e.context=null,o&&(e.context=e._openGLRenderWindow.getContext()))},t.getMaximumTextureSize=function(o){return o&&o.isCurrent()?o.getIntegerv(o.MAX_TEXTURE_SIZE):-1}}var HT={_openGLRenderWindow:null,_forceInternalFormat:!1,context:null,handle:0,sendParametersTime:null,textureBuildTime:null,numberOfDimensions:0,target:0,format:0,openGLDataType:0,components:0,width:0,height:0,depth:0,autoParameters:!0,wrapS:tt.CLAMP_TO_EDGE,wrapT:tt.CLAMP_TO_EDGE,wrapR:tt.CLAMP_TO_EDGE,minificationFilter:he.NEAREST,magnificationFilter:he.NEAREST,minLOD:-1e3,maxLOD:1e3,baseLevel:0,maxLevel:1e3,generateMipmap:!1,useHalfFloat:!0,oglNorm16Ext:null};function uc(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,HT,r),ie.extend(t,e,r),e.sendParametersTime={},be(e.sendParametersTime,{mtime:0}),e.textureBuildTime={},be(e.textureBuildTime,{mtime:0}),_n(t,e,["format","openGLDataType"]),we(t,e,["keyMatrixTime","minificationFilter","magnificationFilter","wrapS","wrapT","wrapR","generateMipmap","oglNorm16Ext"]),je(t,e,["width","height","volumeInfo","components","handle","target"]),qa(t,e,["openGLRenderWindow"]),jT(t,e)}var cc=ne(uc,"vtkOpenGLTexture"),Pn=WT({newInstance:cc,extend:uc},Ei);He("vtkTexture",cc);var PT=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkPolyDataVS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/

attribute vec4 vertexMC;

// frag position in VC
//VTK::PositionVC::Dec

// optional normal declaration
//VTK::Normal::Dec

// extra lighting parameters
//VTK::Light::Dec

// Texture coordinates
//VTK::TCoord::Dec

// material property values
//VTK::Color::Dec

// clipping plane vars
//VTK::Clip::Dec

// camera and actor matrix values
//VTK::Camera::Dec

// Apple Bug
//VTK::PrimID::Dec

// picking support
//VTK::Picking::Dec

void main()
{
  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Clip::Impl

  //VTK::PrimID::Impl

  //VTK::PositionVC::Impl

  //VTK::Light::Impl

  //VTK::Picking::Impl
}
`,KT=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkPolyDataFS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/
// Template for the polydata mappers fragment shader

uniform int PrimitiveIDOffset;

// VC position of this fragment
//VTK::PositionVC::Dec

// optional color passed in from the vertex shader, vertexColor
//VTK::Color::Dec

// optional surface normal declaration
//VTK::Normal::Dec

// extra lighting parameters
//VTK::Light::Dec

// Texture coordinates
//VTK::TCoord::Dec

// picking support
//VTK::Picking::Dec

// Depth Peeling Support
//VTK::DepthPeeling::Dec

// clipping plane vars
//VTK::Clip::Dec

// the output of this shader
//VTK::Output::Dec

// Apple Bug
//VTK::PrimID::Dec

// handle coincident offsets
//VTK::Coincident::Dec

//VTK::ZBuffer::Dec

void main()
{
  // VC position of this fragment. This should not branch/return/discard.
  //VTK::PositionVC::Impl

  // Place any calls that require uniform flow (e.g. dFdx) here.
  //VTK::UniformFlow::Impl

  // Set gl_FragDepth here (gl_FragCoord.z by default)
  //VTK::Depth::Impl

  // Early depth peeling abort:
  //VTK::DepthPeeling::PreColor

  // Apple Bug
  //VTK::PrimID::Impl

  //VTK::Clip::Impl

  //VTK::Color::Impl

  // Generate the normal if we are not passed in one
  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Light::Impl

  if (gl_FragData[0].a <= 0.0)
    {
    discard;
    }

  //VTK::DepthPeeling::Impl

  //VTK::Picking::Impl

  // handle coincident offsets
  //VTK::Coincident::Impl

  //VTK::ZBuffer::Impl

  //VTK::RenderPassFragmentShader::Impl
}
`;function XT(t,e){t.replaceShaderCoincidentOffset=function(r,n,a){var i=t.getCoincidentParameters(n,a);if(i&&(i.factor!==0||i.offset!==0)){var s=r.Fragment;s=k.substitute(s,"//VTK::Coincident::Dec",["uniform float cfactor;","uniform float coffset;"]).result,e.context.getExtension("EXT_frag_depth")&&(i.factor!==0?(s=k.substitute(s,"//VTK::UniformFlow::Impl",["float cscale = length(vec2(dFdx(gl_FragCoord.z),dFdy(gl_FragCoord.z)));","//VTK::UniformFlow::Impl"],!1).result,s=k.substitute(s,"//VTK::Depth::Impl","gl_FragDepthEXT = gl_FragCoord.z + cfactor*cscale + 0.000016*coffset;").result):s=k.substitute(s,"//VTK::Depth::Impl","gl_FragDepthEXT = gl_FragCoord.z + 0.000016*coffset;").result),e._openGLRenderWindow.getWebgl2()&&(i.factor!==0?(s=k.substitute(s,"//VTK::UniformFlow::Impl",["float cscale = length(vec2(dFdx(gl_FragCoord.z),dFdy(gl_FragCoord.z)));","//VTK::UniformFlow::Impl"],!1).result,s=k.substitute(s,"//VTK::Depth::Impl","gl_FragDepth = gl_FragCoord.z + cfactor*cscale + 0.000016*coffset;").result):s=k.substitute(s,"//VTK::Depth::Impl","gl_FragDepth = gl_FragCoord.z + 0.000016*coffset;").result),r.Fragment=s}}}var gc={implementReplaceShaderCoincidentOffset:XT};function Js(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function eo(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Js(Object(r),!0).forEach(function(n){K(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Js(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var pa=Wn.FieldAssociations,ce=Gr.primTypes,Pt=Fr.Representation,to=Fr.Shading,an=ar.ScalarMode,ro=Pn.Filter,no=Pn.Wrap,Et=Y,YT={type:"StartEvent"},IT={type:"EndEvent"},QT=Nr.CoordinateSystem;function qT(t){var e=t.getSelector();return e?e.getCurrentPass():Ee.MIN_KNOWN_PASS-1}function ZT(t,e){e.classHierarchy.push("vtkOpenGLPolyDataMapper"),t.buildPass=function(n){n&&(e.currentRenderPass=null,e.openGLActor=t.getFirstAncestorOfType("vtkOpenGLActor"),e._openGLRenderer=e.openGLActor.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getParent(),e.openGLCamera=e._openGLRenderer.getViewNodeFor(e._openGLRenderer.getRenderable().getActiveCamera()))},t.translucentPass=function(n,a){n&&(e.currentRenderPass=a,t.render())},t.zBufferPass=function(n){n&&(e.haveSeenDepthRequest=!0,e.renderDepth=!0,t.render(),e.renderDepth=!1)},t.opaqueZBufferPass=function(n){return t.zBufferPass(n)},t.opaquePass=function(n){n&&t.render()},t.render=function(){var n=e._openGLRenderWindow.getContext();if(e.context!==n){e.context=n;for(var a=ce.Start;a<ce.End;a++)e.primitives[a].setOpenGLRenderWindow(e._openGLRenderWindow)}var i=e.openGLActor.getRenderable(),s=e._openGLRenderer.getRenderable();t.renderPiece(s,i)},t.buildShaders=function(n,a,i){t.getShaderTemplate(n,a,i),e.lastRenderPassShaderReplacement=e.currentRenderPass?e.currentRenderPass.getShaderReplacement():null,e.lastRenderPassShaderReplacement&&e.lastRenderPassShaderReplacement(n);var s=e.renderable.getViewSpecificProperties().OpenGL,f=null;if(s&&(f=s.ShaderReplacements),f)for(var o=0;o<f.length;o++){var u=f[o];if(u.replaceFirst){var c=u.shaderType,g=n[c],v=k.substitute(g,u.originalValue,u.replacementValue,u.replaceAll);n[c]=v.result}}if(t.replaceShaderValues(n,a,i),f)for(var p=0;p<f.length;p++){var l=f[p];if(!l.replaceFirst){var y=l.shaderType,h=n[y],T=k.substitute(h,l.originalValue,l.replacementValue,l.replaceAll);n[y]=T.result}}},t.getShaderTemplate=function(n,a,i){var s=e.renderable.getViewSpecificProperties().OpenGL,f=PT;if(s){var o=s.VertexShaderCode;o!==void 0&&o!==""&&(f=o)}n.Vertex=f;var u=KT;if(s){var c=s.FragmentShaderCode;c!==void 0&&c!==""&&(u=c)}n.Fragment=u;var g="";if(s){var v=s.GeometryShaderCode;v!==void 0&&(g=v)}n.Geometry=g},t.replaceShaderColor=function(n,a,i){var s=n.Vertex,f=n.Geometry,o=n.Fragment,u=e.lastBoundBO.getReferenceByName("lastLightComplexity"),c=["uniform float ambient;","uniform float diffuse;","uniform float specular;","uniform float opacityUniform; // the fragment opacity","uniform vec3 ambientColorUniform;","uniform vec3 diffuseColorUniform;"];u&&(c=c.concat(["uniform vec3 specularColorUniform;","uniform float specularPowerUniform;"]));var g=["vec3 ambientColor;","  vec3 diffuseColor;","  float opacity;"];u&&(g=g.concat(["  vec3 specularColor;","  float specularPower;"])),g=g.concat(["  ambientColor = ambientColorUniform;","  diffuseColor = diffuseColorUniform;","  opacity = opacityUniform;"]),u&&(g=g.concat(["  specularColor = specularColorUniform;","  specularPower = specularPowerUniform;"])),e.lastBoundBO.getCABO().getColorComponents()!==0&&!e.drawingEdges&&(c=c.concat(["varying vec4 vertexColorVSOutput;"]),s=k.substitute(s,"//VTK::Color::Dec",["attribute vec4 scalarColor;","varying vec4 vertexColorVSOutput;"]).result,s=k.substitute(s,"//VTK::Color::Impl",["vertexColorVSOutput =  scalarColor;"]).result,f=k.substitute(f,"//VTK::Color::Dec",["in vec4 vertexColorVSOutput[];","out vec4 vertexColorGSOutput;"]).result,f=k.substitute(f,"//VTK::Color::Impl",["vertexColorGSOutput = vertexColorVSOutput[i];"]).result),e.lastBoundBO.getCABO().getColorComponents()!==0&&!e.drawingEdges?o=k.substitute(o,"//VTK::Color::Impl",g.concat(["  diffuseColor = vertexColorVSOutput.rgb;","  ambientColor = vertexColorVSOutput.rgb;","  opacity = opacity*vertexColorVSOutput.a;"])).result:e.renderable.getInterpolateScalarsBeforeMapping()&&e.renderable.getColorCoordinates()&&!e.drawingEdges?o=k.substitute(o,"//VTK::Color::Impl",g.concat(["  vec4 texColor = texture2D(texture1, tcoordVCVSOutput.st);","  diffuseColor = texColor.rgb;","  ambientColor = texColor.rgb;","  opacity = opacity*texColor.a;"])).result:(i.getBackfaceProperty()&&!e.drawingEdges&&(c=c.concat(["uniform float opacityUniformBF; // the fragment opacity","uniform float ambientIntensityBF; // the material ambient","uniform float diffuseIntensityBF; // the material diffuse","uniform vec3 ambientColorUniformBF; // ambient material color","uniform vec3 diffuseColorUniformBF; // diffuse material color"]),u?(c=c.concat(["uniform float specularIntensityBF; // the material specular intensity","uniform vec3 specularColorUniformBF; // intensity weighted color","uniform float specularPowerUniformBF;"]),g=g.concat(["if (gl_FrontFacing == false) {","  ambientColor = ambientIntensityBF * ambientColorUniformBF;","  diffuseColor = diffuseIntensityBF * diffuseColorUniformBF;","  specularColor = specularIntensityBF * specularColorUniformBF;","  specularPower = specularPowerUniformBF;","  opacity = opacityUniformBF; }"])):g=g.concat(["if (gl_FrontFacing == false) {","  ambientColor = ambientIntensityBF * ambientColorUniformBF;","  diffuseColor = diffuseIntensityBF * diffuseColorUniformBF;","  opacity = opacityUniformBF; }"])),e.haveCellScalars&&!e.drawingEdges&&(c=c.concat(["uniform samplerBuffer texture1;"])),o=k.substitute(o,"//VTK::Color::Impl",g).result),o=k.substitute(o,"//VTK::Color::Dec",c).result,n.Vertex=s,n.Geometry=f,n.Fragment=o},t.replaceShaderLight=function(n,a,i){var s=n.Fragment,f="",o=e.lastBoundBO.getReferenceByName("lastLightComplexity"),u=e.lastBoundBO.getReferenceByName("lastLightCount"),c=[];switch(o){case 0:s=k.substitute(s,"//VTK::Light::Impl",["  gl_FragData[0] = vec4(ambientColor * ambient + diffuseColor * diffuse, opacity);","  //VTK::Light::Impl"],!1).result;break;case 1:s=k.substitute(s,"//VTK::Light::Impl",["  float df = max(0.0, normalVCVSOutput.z);","  float sf = pow(df, specularPower);","  vec3 diffuseL = df * diffuseColor;","  vec3 specularL = sf * specularColor;","  gl_FragData[0] = vec4(ambientColor * ambient + diffuseL * diffuse + specularL * specular, opacity);","  //VTK::Light::Impl"],!1).result;break;case 2:for(var g=0;g<u;++g)c=c.concat(["uniform vec3 lightColor".concat(g,";"),"uniform vec3 lightDirectionVC".concat(g,"; // normalized"),"uniform vec3 lightHalfAngleVC".concat(g,"; // normalized")]);s=k.substitute(s,"//VTK::Light::Dec",c).result,c=["vec3 diffuseL = vec3(0,0,0);","  vec3 specularL = vec3(0,0,0);","  float df;"];for(var v=0;v<u;++v)c=c.concat(["  df = max(0.0, dot(normalVCVSOutput, -lightDirectionVC".concat(v,"));"),"  diffuseL += ((df".concat(f,") * lightColor").concat(v,");"),"  if (dot(normalVCVSOutput, lightDirectionVC".concat(v,") < 0.0)"),"    {","    float sf = pow( max(0.0, dot(lightHalfAngleVC".concat(v,",normalVCVSOutput)), specularPower);"),"    specularL += ((sf".concat(f,") * lightColor").concat(v,");"),"    }"]);c=c.concat(["  diffuseL = diffuseL * diffuseColor;","  specularL = specularL * specularColor;","  gl_FragData[0] = vec4(ambientColor * ambient + diffuseL * diffuse + specularL * specular, opacity);","  //VTK::Light::Impl"]),s=k.substitute(s,"//VTK::Light::Impl",c,!1).result;break;case 3:for(var p=0;p<u;++p)c=c.concat(["uniform vec3 lightColor".concat(p,";"),"uniform vec3 lightDirectionVC".concat(p,"; // normalized"),"uniform vec3 lightHalfAngleVC".concat(p,"; // normalized"),"uniform vec3 lightPositionVC".concat(p,";"),"uniform vec3 lightAttenuation".concat(p,";"),"uniform float lightConeAngle".concat(p,";"),"uniform float lightExponent".concat(p,";"),"uniform int lightPositional".concat(p,";")]);s=k.substitute(s,"//VTK::Light::Dec",c).result,c=["vec3 diffuseL = vec3(0,0,0);","  vec3 specularL = vec3(0,0,0);","  vec3 vertLightDirectionVC;","  float attenuation;","  float df;"];for(var l=0;l<u;++l)c=c.concat(["  attenuation = 1.0;","  if (lightPositional".concat(l," == 0)"),"    {","      vertLightDirectionVC = lightDirectionVC".concat(l,";"),"    }","  else","    {","    vertLightDirectionVC = vertexVC.xyz - lightPositionVC".concat(l,";"),"    float distanceVC = length(vertLightDirectionVC);","    vertLightDirectionVC = normalize(vertLightDirectionVC);","    attenuation = 1.0 /","      (lightAttenuation".concat(l,".x"),"       + lightAttenuation".concat(l,".y * distanceVC"),"       + lightAttenuation".concat(l,".z * distanceVC * distanceVC);"),"    // per OpenGL standard cone angle is 90 or less for a spot light","    if (lightConeAngle".concat(l," <= 90.0)"),"      {","      float coneDot = dot(vertLightDirectionVC, lightDirectionVC".concat(l,");"),"      // if inside the cone","      if (coneDot >= cos(radians(lightConeAngle".concat(l,")))"),"        {","        attenuation = attenuation * pow(coneDot, lightExponent".concat(l,");"),"        }","      else","        {","        attenuation = 0.0;","        }","      }","    }","    df = max(0.0, attenuation*dot(normalVCVSOutput, -vertLightDirectionVC));","    diffuseL += ((df".concat(f,") * lightColor").concat(l,");"),"    if (dot(normalVCVSOutput, vertLightDirectionVC) < 0.0)","      {","      float sf = attenuation*pow( max(0.0, dot(lightHalfAngleVC".concat(l,",normalVCVSOutput)), specularPower);"),"    specularL += ((sf".concat(f,") * lightColor").concat(l,");"),"    }"]);c=c.concat(["  diffuseL = diffuseL * diffuseColor;","  specularL = specularL * specularColor;","  gl_FragData[0] = vec4(ambientColor * ambient + diffuseL * diffuse + specularL * specular, opacity);","  //VTK::Light::Impl"]),s=k.substitute(s,"//VTK::Light::Impl",c,!1).result;break;default:Et("bad light complexity")}n.Fragment=s},t.replaceShaderNormal=function(n,a,i){var s=e.lastBoundBO.getReferenceByName("lastLightComplexity");if(s>0){var f=n.Vertex,o=n.Geometry,u=n.Fragment;e.lastBoundBO.getCABO().getNormalOffset()?(f=k.substitute(f,"//VTK::Normal::Dec",["attribute vec3 normalMC;","uniform mat3 normalMatrix;","varying vec3 normalVCVSOutput;"]).result,f=k.substitute(f,"//VTK::Normal::Impl",["normalVCVSOutput = normalMatrix * normalMC;"]).result,o=k.substitute(o,"//VTK::Normal::Dec",["in vec3 normalVCVSOutput[];","out vec3 normalVCGSOutput;"]).result,o=k.substitute(o,"//VTK::Normal::Impl",["normalVCGSOutput = normalVCVSOutput[i];"]).result,u=k.substitute(u,"//VTK::Normal::Dec",["varying vec3 normalVCVSOutput;"]).result,u=k.substitute(u,"//VTK::Normal::Impl",["vec3 normalVCVSOutput = normalize(normalVCVSOutput);","  if (gl_FrontFacing == false) { normalVCVSOutput = -normalVCVSOutput; }"]).result):e.haveCellNormals?(u=k.substitute(u,"//VTK::Normal::Dec",["uniform mat3 normalMatrix;","uniform samplerBuffer textureN;"]).result,u=k.substitute(u,"//VTK::Normal::Impl",["vec3 normalVCVSOutput = normalize(normalMatrix *","    texelFetchBuffer(textureN, gl_PrimitiveID + PrimitiveIDOffset).xyz);","  if (gl_FrontFacing == false) { normalVCVSOutput = -normalVCVSOutput; }"]).result):e.lastBoundBO.getOpenGLMode(i.getProperty().getRepresentation())===e.context.LINES?(u=k.substitute(u,"//VTK::UniformFlow::Impl",["  vec3 fdx = dFdx(vertexVC.xyz);","  vec3 fdy = dFdy(vertexVC.xyz);","  //VTK::UniformFlow::Impl"]).result,u=k.substitute(u,"//VTK::Normal::Impl",["vec3 normalVCVSOutput;","  if (abs(fdx.x) > 0.0)","    { fdx = normalize(fdx); normalVCVSOutput = normalize(cross(vec3(fdx.y, -fdx.x, 0.0), fdx)); }","  else { fdy = normalize(fdy); normalVCVSOutput = normalize(cross(vec3(fdy.y, -fdy.x, 0.0), fdy));}"]).result):(u=k.substitute(u,"//VTK::Normal::Dec",["uniform int cameraParallel;"]).result,u=k.substitute(u,"//VTK::UniformFlow::Impl",["  vec3 fdx = dFdx(vertexVC.xyz);","  vec3 fdy = dFdy(vertexVC.xyz);","  //VTK::UniformFlow::Impl"]).result,u=k.substitute(u,"//VTK::Normal::Impl",["  fdx = normalize(fdx);","  fdy = normalize(fdy);","  vec3 normalVCVSOutput = normalize(cross(fdx,fdy));","  if (cameraParallel == 1 && normalVCVSOutput.z < 0.0) { normalVCVSOutput = -1.0*normalVCVSOutput; }","  if (cameraParallel == 0 && dot(normalVCVSOutput,vertexVC.xyz) > 0.0) { normalVCVSOutput = -1.0*normalVCVSOutput; }"]).result),n.Vertex=f,n.Geometry=o,n.Fragment=u}},t.replaceShaderPositionVC=function(n,a,i){e.lastBoundBO.replaceShaderPositionVC(n,a,i);var s=n.Vertex,f=n.Geometry,o=n.Fragment,u=e.lastBoundBO.getReferenceByName("lastLightComplexity");u>0?(s=k.substitute(s,"//VTK::PositionVC::Dec",["varying vec4 vertexVCVSOutput;"]).result,s=k.substitute(s,"//VTK::PositionVC::Impl",["vertexVCVSOutput = MCVCMatrix * vertexMC;","  gl_Position = MCPCMatrix * vertexMC;"]).result,s=k.substitute(s,"//VTK::Camera::Dec",["uniform mat4 MCPCMatrix;","uniform mat4 MCVCMatrix;"]).result,f=k.substitute(f,"//VTK::PositionVC::Dec",["in vec4 vertexVCVSOutput[];","out vec4 vertexVCGSOutput;"]).result,f=k.substitute(f,"//VTK::PositionVC::Impl",["vertexVCGSOutput = vertexVCVSOutput[i];"]).result,o=k.substitute(o,"//VTK::PositionVC::Dec",["varying vec4 vertexVCVSOutput;"]).result,o=k.substitute(o,"//VTK::PositionVC::Impl",["vec4 vertexVC = vertexVCVSOutput;"]).result):(s=k.substitute(s,"//VTK::Camera::Dec",["uniform mat4 MCPCMatrix;"]).result,s=k.substitute(s,"//VTK::PositionVC::Impl",["  gl_Position = MCPCMatrix * vertexMC;"]).result),n.Vertex=s,n.Geometry=f,n.Fragment=o},t.replaceShaderTCoord=function(n,a,i){if(e.lastBoundBO.getCABO().getTCoordOffset()){var s=n.Vertex,f=n.Geometry,o=n.Fragment;if(e.drawingEdges)return;s=k.substitute(s,"//VTK::TCoord::Impl","tcoordVCVSOutput = tcoordMC;").result;var u=e.openGLActor.getActiveTextures(),c=2,g=2;if(u&&u.length>0&&(c=u[0].getComponents(),u[0].getTarget()===e.context.TEXTURE_CUBE_MAP&&(g=3)),e.renderable.getColorTextureMap()&&(c=e.renderable.getColorTextureMap().getPointData().getScalars().getNumberOfComponents(),g=2),g===2){if(s=k.substitute(s,"//VTK::TCoord::Dec","attribute vec2 tcoordMC; varying vec2 tcoordVCVSOutput;").result,f=k.substitute(f,"//VTK::TCoord::Dec",["in vec2 tcoordVCVSOutput[];","out vec2 tcoordVCGSOutput;"]).result,f=k.substitute(f,"//VTK::TCoord::Impl","tcoordVCGSOutput = tcoordVCVSOutput[i];").result,o=k.substitute(o,"//VTK::TCoord::Dec",["varying vec2 tcoordVCVSOutput;","uniform sampler2D texture1;"]).result,u&&u.length>=1)switch(c){case 1:o=k.substitute(o,"//VTK::TCoord::Impl",["  vec4 tcolor = texture2D(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.r;","  diffuseColor = diffuseColor*tcolor.r;"]).result;break;case 2:o=k.substitute(o,"//VTK::TCoord::Impl",["  vec4 tcolor = texture2D(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.r;","  diffuseColor = diffuseColor*tcolor.r;","  opacity = opacity * tcolor.g;"]).result;break;default:o=k.substitute(o,"//VTK::TCoord::Impl",["  vec4 tcolor = texture2D(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.rgb;","  diffuseColor = diffuseColor*tcolor.rgb;","  opacity = opacity * tcolor.a;"]).result}}else switch(s=k.substitute(s,"//VTK::TCoord::Dec","attribute vec3 tcoordMC; varying vec3 tcoordVCVSOutput;").result,f=k.substitute(f,"//VTK::TCoord::Dec",["in vec3 tcoordVCVSOutput[];","out vec3 tcoordVCGSOutput;"]).result,f=k.substitute(f,"//VTK::TCoord::Impl","tcoordVCGSOutput = tcoordVCVSOutput[i];").result,o=k.substitute(o,"//VTK::TCoord::Dec",["varying vec3 tcoordVCVSOutput;","uniform samplerCube texture1;"]).result,c){case 1:o=k.substitute(o,"//VTK::TCoord::Impl",["  vec4 tcolor = textureCube(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.r;","  diffuseColor = diffuseColor*tcolor.r;"]).result;break;case 2:o=k.substitute(o,"//VTK::TCoord::Impl",["  vec4 tcolor = textureCube(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.r;","  diffuseColor = diffuseColor*tcolor.r;","  opacity = opacity * tcolor.g;"]).result;break;default:o=k.substitute(o,"//VTK::TCoord::Impl",["  vec4 tcolor = textureCube(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.rgb;","  diffuseColor = diffuseColor*tcolor.rgb;","  opacity = opacity * tcolor.a;"]).result}n.Vertex=s,n.Geometry=f,n.Fragment=o}},t.replaceShaderClip=function(n,a,i){var s=n.Vertex,f=n.Fragment;if(e.renderable.getNumberOfClippingPlanes()){var o=e.renderable.getNumberOfClippingPlanes();s=k.substitute(s,"//VTK::Clip::Dec",["uniform int numClipPlanes;","uniform vec4 clipPlanes[".concat(o,"];"),"varying float clipDistancesVSOutput[".concat(o,"];")]).result,s=k.substitute(s,"//VTK::Clip::Impl",["for (int planeNum = 0; planeNum < ".concat(o,"; planeNum++)"),"    {","    if (planeNum >= numClipPlanes)","        {","        break;","        }","    clipDistancesVSOutput[planeNum] = dot(clipPlanes[planeNum], vertexMC);","    }"]).result,f=k.substitute(f,"//VTK::Clip::Dec",["uniform int numClipPlanes;","varying float clipDistancesVSOutput[".concat(o,"];")]).result,f=k.substitute(f,"//VTK::Clip::Impl",["for (int planeNum = 0; planeNum < ".concat(o,"; planeNum++)"),"    {","    if (planeNum >= numClipPlanes)","        {","        break;","        }","    if (clipDistancesVSOutput[planeNum] < 0.0) discard;","    }"]).result}n.Vertex=s,n.Fragment=f},t.getCoincidentParameters=function(n,a){var i={factor:0,offset:0},s=a.getProperty();if(e.renderable.getResolveCoincidentTopology()||s.getEdgeVisibility()&&s.getRepresentation()===Pt.SURFACE){var f=e.lastBoundBO.getPrimitiveType();f===ce.Points||s.getRepresentation()===Pt.POINTS?i=e.renderable.getCoincidentTopologyPointOffsetParameter():f===ce.Lines||s.getRepresentation()===Pt.WIREFRAME?i=e.renderable.getCoincidentTopologyLineOffsetParameters():(f===ce.Tris||f===ce.TriStrips)&&(i=e.renderable.getCoincidentTopologyPolygonOffsetParameters()),(f===ce.TrisEdges||f===ce.TriStripsEdges)&&(i=e.renderable.getCoincidentTopologyPolygonOffsetParameters(),i.factor/=2,i.offset/=2)}var o=e._openGLRenderer.getSelector();return o&&o.getFieldAssociation()===pa.FIELD_ASSOCIATION_POINTS&&(i.offset-=2),i},t.replaceShaderPicking=function(n,a,i){var s=n.Fragment,f=n.Vertex;if(s=k.substitute(s,"//VTK::Picking::Dec",["uniform int picking;","//VTK::Picking::Dec"]).result,!!e._openGLRenderer.getSelector()){switch((e.lastSelectionState===Ee.ID_LOW24||e.lastSelectionState===Ee.ID_HIGH24)&&(f=k.substitute(f,"//VTK::Picking::Dec",[`flat out int vertexIDVSOutput;
`,`uniform int VertexIDOffset;
`]).result,f=k.substitute(f,"//VTK::Picking::Impl",`  vertexIDVSOutput = gl_VertexID + VertexIDOffset;
`).result,s=k.substitute(s,"//VTK::Picking::Dec",`flat in int vertexIDVSOutput;
`).result,s=k.substitute(s,"//VTK::Picking::Impl",["  int idx = vertexIDVSOutput;","//VTK::Picking::Impl"]).result),e.lastSelectionState){case Ee.ID_LOW24:s=k.substitute(s,"//VTK::Picking::Impl","  gl_FragData[0] = vec4(float(idx%256)/255.0, float((idx/256)%256)/255.0, float((idx/65536)%256)/255.0, 1.0);").result;break;case Ee.ID_HIGH24:s=k.substitute(s,"//VTK::Picking::Impl","  gl_FragData[0] = vec4(float(idx)/255.0, 0.0, 0.0, 1.0);").result;break;default:s=k.substitute(s,"//VTK::Picking::Dec","uniform vec3 mapperIndex;").result,s=k.substitute(s,"//VTK::Picking::Impl","  gl_FragData[0] = picking != 0 ? vec4(mapperIndex,1.0) : gl_FragData[0];").result}n.Fragment=s,n.Vertex=f}},t.replaceShaderValues=function(n,a,i){if(t.replaceShaderColor(n,a,i),t.replaceShaderNormal(n,a,i),t.replaceShaderLight(n,a,i),t.replaceShaderTCoord(n,a,i),t.replaceShaderPicking(n,a,i),t.replaceShaderClip(n,a,i),t.replaceShaderCoincidentOffset(n,a,i),t.replaceShaderPositionVC(n,a,i),e.haveSeenDepthRequest){var s=n.Fragment;s=k.substitute(s,"//VTK::ZBuffer::Dec","uniform int depthRequest;").result,s=k.substitute(s,"//VTK::ZBuffer::Impl",["if (depthRequest == 1) {","float iz = floor(gl_FragCoord.z*65535.0 + 0.1);","float rf = floor(iz/256.0)/255.0;","float gf = mod(iz,256.0)/255.0;","gl_FragData[0] = vec4(rf, gf, 0.0, 1.0); }"]).result,n.Fragment=s}},t.getNeedToRebuildShaders=function(n,a,i){var s=0,f=0,o=n.getPrimitiveType(),u=e.currentInput,c=!1,g=u.getPointData().getNormals(),v=u.getCellData().getNormals(),p=i.getProperty().getInterpolation()===to.FLAT,l=i.getProperty().getRepresentation(),y=n.getOpenGLMode(l,o);if((y===e.context.TRIANGLES||v&&!g||!p&&g||!p&&y===e.context.LINES)&&(c=!0),i.getProperty().getLighting()&&c){s=0;for(var h=a.getLightsByReference(),T=0;T<h.length;++T){var x=h[T],S=x.getSwitch();S>0&&(f++,s===0&&(s=1)),s===1&&(f>1||x.getIntensity()!==1||!x.lightTypeIsHeadLight())&&(s=2),s<3&&x.getPositional()&&(s=3)}}var O=!1,C=e.lastBoundBO.getReferenceByName("lastLightComplexity"),w=e.lastBoundBO.getReferenceByName("lastLightCount");return(C!==s||w!==f)&&(e.lastBoundBO.set({lastLightComplexity:s},!0),e.lastBoundBO.set({lastLightCount:f},!0),O=!0),(!e.currentRenderPass&&e.lastRenderPassShaderReplacement||e.currentRenderPass&&e.currentRenderPass.getShaderReplacement()!==e.lastRenderPassShaderReplacement)&&(O=!0),e.lastHaveSeenDepthRequest!==e.haveSeenDepthRequest||n.getShaderSourceTime().getMTime()<e.renderable.getMTime()||n.getShaderSourceTime().getMTime()<e.currentInput.getMTime()||n.getShaderSourceTime().getMTime()<e.selectionStateChanged.getMTime()||O?(e.lastHaveSeenDepthRequest=e.haveSeenDepthRequest,!0):!1},t.invokeShaderCallbacks=function(n,a,i){var s=e.renderable.getViewSpecificProperties().ShadersCallbacks;s&&s.forEach(function(f){f.callback(f.userData,n,a,i)})},t.setMapperShaderParameters=function(n,a,i){if(n.getProgram().isUniformUsed("PrimitiveIDOffset")&&n.getProgram().setUniformi("PrimitiveIDOffset",e.primitiveIDOffset),n.getProgram().isUniformUsed("VertexIDOffset")&&n.getProgram().setUniformi("VertexIDOffset",e.vertexIDOffset),n.getCABO().getElementCount()&&(e.VBOBuildTime.getMTime()>n.getAttributeUpdateTime().getMTime()||n.getShaderSourceTime().getMTime()>n.getAttributeUpdateTime().getMTime())){var s=e.lastBoundBO.getReferenceByName("lastLightComplexity");n.getProgram().isAttributeUsed("vertexMC")&&(n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"vertexMC",n.getCABO().getVertexOffset(),n.getCABO().getStride(),e.context.FLOAT,3,!1)||Et("Error setting vertexMC in shader VAO.")),n.getProgram().isAttributeUsed("normalMC")&&n.getCABO().getNormalOffset()&&s>0?n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"normalMC",n.getCABO().getNormalOffset(),n.getCABO().getStride(),e.context.FLOAT,3,!1)||Et("Error setting normalMC in shader VAO."):n.getVAO().removeAttributeArray("normalMC"),e.renderable.getCustomShaderAttributes().forEach(function(w,E){n.getProgram().isAttributeUsed("".concat(w,"MC"))&&(n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"".concat(w,"MC"),n.getCABO().getCustomData()[E].offset,n.getCABO().getStride(),e.context.FLOAT,n.getCABO().getCustomData()[E].components,!1)||Et("Error setting ".concat(w,"MC in shader VAO.")))}),n.getProgram().isAttributeUsed("tcoordMC")&&n.getCABO().getTCoordOffset()?n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"tcoordMC",n.getCABO().getTCoordOffset(),n.getCABO().getStride(),e.context.FLOAT,n.getCABO().getTCoordComponents(),!1)||Et("Error setting tcoordMC in shader VAO."):n.getVAO().removeAttributeArray("tcoordMC"),n.getProgram().isAttributeUsed("scalarColor")&&n.getCABO().getColorComponents()?n.getVAO().addAttributeArray(n.getProgram(),n.getCABO().getColorBO(),"scalarColor",n.getCABO().getColorOffset(),n.getCABO().getColorBOStride(),e.context.UNSIGNED_BYTE,4,!0)||Et("Error setting scalarColor in shader VAO."):n.getVAO().removeAttributeArray("scalarColor"),n.getAttributeUpdateTime().modified()}if(e.renderable.getNumberOfClippingPlanes()){var f=e.renderable.getNumberOfClippingPlanes(),o=[],u=n.getCABO().getCoordShiftAndScaleEnabled(),c=u?n.getCABO().getInverseShiftAndScaleMatrix():null,g=c?Qe(e.tmpMat4,i.getMatrix()):i.getMatrix();c&&(Se(g,g),nt(g,g,c),Se(g,g));for(var v=0;v<f;v++){var p=[];e.renderable.getClippingPlaneInDataCoords(g,v,p);for(var l=0;l<4;l++)o.push(p[l])}n.getProgram().setUniformi("numClipPlanes",f),n.getProgram().setUniform4fv("clipPlanes",o)}e.internalColorTexture&&n.getProgram().isUniformUsed("texture1")&&n.getProgram().setUniformi("texture1",e.internalColorTexture.getTextureUnit());var y=e.openGLActor.getActiveTextures();if(y)for(var h=0;h<y.length;++h){var T=y[h],x=T.getTextureUnit(),S="texture".concat(x+1);n.getProgram().isUniformUsed(S)&&n.getProgram().setUniformi(S,x)}if(e.haveSeenDepthRequest&&n.getProgram().setUniformi("depthRequest",e.renderDepth?1:0),n.getProgram().isUniformUsed("coffset")){var O=t.getCoincidentParameters(a,i);n.getProgram().setUniformf("coffset",O.offset),n.getProgram().isUniformUsed("cfactor")&&n.getProgram().setUniformf("cfactor",O.factor)}n.setMapperShaderParameters(a,i,e._openGLRenderer.getTiledSizeAndOrigin());var C=e._openGLRenderer.getSelector();n.getProgram().setUniform3fArray("mapperIndex",C?C.getPropColorValue():[0,0,0]),n.getProgram().setUniformi("picking",C?C.getCurrentPass()+1:0)},t.setLightingShaderParameters=function(n,a,i){var s=e.lastBoundBO.getReferenceByName("lastLightComplexity");if(!(s<2)){for(var f=n.getProgram(),o=0,u=a.getLightsByReference(),c=0;c<u.length;++c){var g=u[c],v=g.getSwitch();if(v>0){var p=g.getColorByReference(),l=g.getIntensity();e.lightColor[0]=p[0]*l,e.lightColor[1]=p[1]*l,e.lightColor[2]=p[2]*l;var y=g.getDirection(),h=a.getActiveCamera().getViewMatrix(),T=re(y);g.lightTypeIsSceneLight()&&(T[0]=h[0]*y[0]+h[1]*y[1]+h[2]*y[2],T[1]=h[4]*y[0]+h[5]*y[1]+h[6]*y[2],T[2]=h[8]*y[0]+h[9]*y[1]+h[10]*y[2],Vn(T)),e.lightDirection[0]=T[0],e.lightDirection[1]=T[1],e.lightDirection[2]=T[2],e.lightHalfAngle[0]=-e.lightDirection[0],e.lightHalfAngle[1]=-e.lightDirection[1],e.lightHalfAngle[2]=-e.lightDirection[2]+1,Vn(e.lightDirection),f.setUniform3fArray("lightColor".concat(o),e.lightColor),f.setUniform3fArray("lightDirectionVC".concat(o),e.lightDirection),f.setUniform3fArray("lightHalfAngleVC".concat(o),e.lightHalfAngle),o++}}if(!(s<3)){var x=a.getActiveCamera(),S=x.getViewMatrix();Se(S,S),o=0;for(var O=0;O<u.length;++O){var C=u[O],w=C.getSwitch();if(w>0){var E=C.getTransformedPosition(),M=new Float64Array(3);Le(M,E,S),f.setUniform3fArray("lightAttenuation".concat(o),C.getAttenuationValuesByReference()),f.setUniformi("lightPositional".concat(o),C.getPositional()),f.setUniformf("lightExponent".concat(o),C.getExponent()),f.setUniformf("lightConeAngle".concat(o),C.getConeAngle()),f.setUniform3fArray("lightPositionVC".concat(o),[M[0],M[1],M[2]]),o++}}}}};function r(n,a,i){return a.identity(i),n.reduce(function(s,f,o){return o===0?f?a.copy(s,f):a.identity(s):f?a.multiply(s,s,f):s},i)}t.setCameraShaderParameters=function(n,a,i){var s=n.getProgram(),f=e.openGLCamera.getKeyMatrices(a),o=a.getActiveCamera(),u=e.openGLCamera.getKeyMatrixTime().getMTime(),c=s.getLastCameraMTime(),g=n.getCABO().getCoordShiftAndScaleEnabled(),v=g?n.getCABO().getInverseShiftAndScaleMatrix():null,p=i.getIsIdentity(),l=p?{mcwc:null,normalMatrix:null}:e.openGLActor.getKeyMatrices();if(i.getCoordinateSystem()===QT.DISPLAY){var y=e._openGLRenderer.getTiledSizeAndOrigin();ge(e.tmpMat4),e.tmpMat4[0]=2/y.usize,e.tmpMat4[12]=-1,e.tmpMat4[5]=2/y.vsize,e.tmpMat4[13]=-1,nt(e.tmpMat4,e.tmpMat4,v),s.setUniformMatrix("MCPCMatrix",e.tmpMat4)}else s.setUniformMatrix("MCPCMatrix",r([f.wcpc,l.mcwc,v],La,e.tmpMat4));s.isUniformUsed("MCVCMatrix")&&s.setUniformMatrix("MCVCMatrix",r([f.wcvc,l.mcwc,v],La,e.tmpMat4)),s.isUniformUsed("normalMatrix")&&s.setUniformMatrix3x3("normalMatrix",r([f.normalMatrix,l.normalMatrix],M0,e.tmpMat3)),c!==u&&(s.isUniformUsed("cameraParallel")&&s.setUniformi("cameraParallel",o.getParallelProjection()),s.setLastCameraMTime(u)),p||s.setLastCameraMTime(0)},t.setPropertyShaderParameters=function(n,a,i){var s=n.getProgram(),f=i.getProperty(),o=f.getOpacity(),u=e.drawingEdges?f.getEdgeColorByReference():f.getAmbientColorByReference(),c=e.drawingEdges?f.getEdgeColorByReference():f.getDiffuseColorByReference(),g=e.drawingEdges?1:f.getAmbient(),v=e.drawingEdges?0:f.getDiffuse(),p=e.drawingEdges?0:f.getSpecular(),l=f.getSpecularPower();s.setUniformf("opacityUniform",o),s.setUniform3fArray("ambientColorUniform",u),s.setUniform3fArray("diffuseColorUniform",c),s.setUniformf("ambient",g),s.setUniformf("diffuse",v);var y=e.lastBoundBO.getReferenceByName("lastLightComplexity");if(!(y<1)){var h=f.getSpecularColorByReference();if(s.setUniform3fArray("specularColorUniform",h),s.setUniformf("specularPowerUniform",l),s.setUniformf("specular",p),s.isUniformUsed("ambientIntensityBF")){if(f=i.getBackfaceProperty(),o=f.getOpacity(),u=f.getAmbientColor(),g=f.getAmbient(),c=f.getDiffuseColor(),v=f.getDiffuse(),h=f.getSpecularColor(),p=f.getSpecular(),s.setUniformf("ambientIntensityBF",g),s.setUniformf("diffuseIntensityBF",v),s.setUniformf("opacityUniformBF",o),s.setUniform3fArray("ambientColorUniformBF",u),s.setUniform3fArray("diffuseColorUniformBF",c),y<1)return;s.setUniformf("specularIntensityBF",p),s.setUniform3fArray("specularColorUniformBF",h),s.setUniformf("specularPowerUniformBF",l)}}},t.updateMaximumPointCellIds=function(n,a){var i,s,f,o,u=e._openGLRenderer.getSelector();if(!!u){if((i=e.selectionWebGLIdsToVTKIds)!==null&&i!==void 0&&(s=i.points)!==null&&s!==void 0&&s.length){var c=e.selectionWebGLIdsToVTKIds.points.length;u.setMaximumPointId(c-1)}if((f=e.selectionWebGLIdsToVTKIds)!==null&&f!==void 0&&(o=f.cells)!==null&&o!==void 0&&o.length){var g=e.selectionWebGLIdsToVTKIds.cells.length;u.setMaximumCellId(g-1)}var v=u.getFieldAssociation();v===pa.FIELD_ASSOCIATION_POINTS&&(e.pointPicking=!0)}},t.renderPieceStart=function(n,a){e.primitiveIDOffset=0,e.vertexIDOffset=0;var i=qT(e._openGLRenderer);if(e.lastSelectionState!==i&&(e.selectionStateChanged.modified(),e.lastSelectionState=i),e._openGLRenderer.getSelector())switch(i){default:e._openGLRenderer.getSelector().renderProp(a)}t.updateBufferObjects(n,a),e.renderable.getColorTextureMap()&&e.internalColorTexture.activate(),e.lastBoundBO=null},t.renderPieceDraw=function(n,a){for(var i=a.getProperty().getRepresentation(),s=a.getProperty().getEdgeVisibility()&&i===Pt.SURFACE,f=e._openGLRenderer.getSelector(),o=f&&f.getFieldAssociation()===pa.FIELD_ASSOCIATION_POINTS&&(e.lastSelectionState===Ee.ID_LOW24||e.lastSelectionState===Ee.ID_HIGH24),u=ce.Start;u<ce.End;u++){e.primitives[u].setPointPicking(o);var c=e.primitives[u].getCABO();c.getElementCount()&&(e.drawingEdges=s&&(u===ce.TrisEdges||u===ce.TriStripsEdges),(!e.drawingEdges||!(e.renderDepth||e.lastSelectionState>=0))&&(e.lastBoundBO=e.primitives[u],e.primitiveIDOffset+=e.primitives[u].drawArrays(n,a,i,t),e.vertexIDOffset+=e.primitives[u].getCABO().getElementCount()))}},t.renderPieceFinish=function(n,a){e.LastBoundBO&&e.LastBoundBO.getVAO().release(),e.renderable.getColorTextureMap()&&e.internalColorTexture.deactivate()},t.renderPiece=function(n,a){if(t.invokeEvent(YT),e.renderable.getStatic()||e.renderable.update(),e.currentInput=e.renderable.getInputData(),t.invokeEvent(IT),!e.currentInput){Et("No input!");return}if(!(!e.currentInput.getPoints||!e.currentInput.getPoints().getNumberOfValues())){var i=e.context,s=a.getProperty().getBackfaceCulling(),f=a.getProperty().getFrontfaceCulling();!s&&!f?e._openGLRenderWindow.disableCullFace():f?(e._openGLRenderWindow.enableCullFace(),i.cullFace(i.FRONT)):(e._openGLRenderWindow.enableCullFace(),i.cullFace(i.BACK)),t.renderPieceStart(n,a),t.renderPieceDraw(n,a),t.renderPieceFinish(n,a)}},t.computeBounds=function(n,a){if(!t.getInput()){oi(e.bounds);return}e.bounds=t.getInput().getBounds()},t.updateBufferObjects=function(n,a){t.getNeedToRebuildBufferObjects(n,a)&&t.buildBufferObjects(n,a)},t.getNeedToRebuildBufferObjects=function(n,a){var i=e.VBOBuildTime.getMTime();return i<t.getMTime()||i<e.renderable.getMTime()||i<a.getMTime()||i<e.currentInput.getMTime()},t.buildBufferObjects=function(n,a){var i=e.currentInput;if(i!==null){e.renderable.mapScalars(i,1);var s=e.renderable.getColorMapColors();e.haveCellScalars=!1;var f=e.renderable.getScalarMode();e.renderable.getScalarVisibility()&&(f===an.USE_CELL_DATA||f===an.USE_CELL_FIELD_DATA||f===an.USE_FIELD_DATA||!i.getPointData().getScalars())&&f!==an.USE_POINT_FIELD_DATA&&s&&(e.haveCellScalars=!0);var o=a.getProperty().getInterpolation()!==to.FLAT?i.getPointData().getNormals():null;o===null&&i.getCellData().getNormals()&&(e.haveCellNormals=!0,o=i.getCellData().getNormals());var u=a.getProperty().getRepresentation(),c=i.getPointData().getTCoords();if(e.openGLActor.getActiveTextures()||(c=null),e.renderable.getColorCoordinates()){c=e.renderable.getColorCoordinates(),e.internalColorTexture||(e.internalColorTexture=Pn.newInstance({resizable:!0}));var g=e.internalColorTexture;g.setMinificationFilter(ro.NEAREST),g.setMagnificationFilter(ro.NEAREST),g.setWrapS(no.CLAMP_TO_EDGE),g.setWrapT(no.CLAMP_TO_EDGE),g.setOpenGLRenderWindow(e._openGLRenderWindow);var v=e.renderable.getColorTextureMap(),p=v.getExtent(),l=v.getPointData().getScalars();g.create2DFromRaw(p[1]-p[0]+1,p[3]-p[2]+1,l.getNumberOfComponents(),l.getDataType(),l.getData()),g.activate(),g.sendParameters(),g.deactivate()}var y="".concat(i.getMTime(),"A").concat(u,"B").concat(i.getMTime())+"C".concat(o?o.getMTime():1,"D").concat(s?s.getMTime():1)+"E".concat(a.getProperty().getEdgeVisibility())+"F".concat(c?c.getMTime():1);if(e.VBOBuildString!==y){var h=i.getPoints(),T={points:h,normals:o,tcoords:c,colors:s,cellOffset:0,vertexOffset:0,haveCellScalars:e.haveCellScalars,haveCellNormals:e.haveCellNormals,customAttributes:e.renderable.getCustomShaderAttributes().map(function(C){return i.getPointData().getArrayByName(C)})};e.renderable.getPopulateSelectionSettings()&&(e.selectionWebGLIdsToVTKIds={points:null,cells:null});for(var x=[{inRep:"verts",cells:i.getVerts()},{inRep:"lines",cells:i.getLines()},{inRep:"polys",cells:i.getPolys()},{inRep:"strips",cells:i.getStrips()},{inRep:"polys",cells:i.getPolys()},{inRep:"strips",cells:i.getStrips()}],S=a.getProperty().getEdgeVisibility()&&u===Pt.SURFACE,O=ce.Start;O<ce.End;O++)O!==ce.TrisEdges&&O!==ce.TriStripsEdges?(T.cellOffset+=e.primitives[O].getCABO().createVBO(x[O].cells,x[O].inRep,u,T,e.selectionWebGLIdsToVTKIds),T.vertexOffset+=e.primitives[O].getCABO().getElementCount()):S?e.primitives[O].getCABO().createVBO(x[O].cells,x[O].inRep,Pt.WIREFRAME,eo(eo({},T),{},{tcoords:null,colors:null,haveCellScalars:!1,haveCellNormals:!1})):e.primitives[O].releaseGraphicsResources();e.renderable.getPopulateSelectionSettings()&&(e.renderable.setSelectionWebGLIdsToVTKIds(e.selectionWebGLIdsToVTKIds),t.updateMaximumPointCellIds()),e.VBOBuildTime.modified(),e.VBOBuildString=y}}}}var JT={context:null,VBOBuildTime:0,VBOBuildString:null,primitives:null,primTypes:null,shaderRebuildString:null,tmpMat4:null,ambientColor:[],diffuseColor:[],specularColor:[],lightColor:[],lightHalfAngle:[],lightDirection:[],lastHaveSeenDepthRequest:!1,haveSeenDepthRequest:!1,lastSelectionState:Ee.MIN_KNOWN_PASS-1,selectionStateChanged:null,selectionWebGLIdsToVTKIds:null,pointPicking:!1};function e2(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,JT,r),ie.extend(t,e,r),gc.implementReplaceShaderCoincidentOffset(t,e,r),e.primitives=[],e.primTypes=ce,e.tmpMat3=$t(new Float64Array(9)),e.tmpMat4=ge(new Float64Array(16));for(var n=ce.Start;n<ce.End;n++)e.primitives[n]=Gr.newInstance(),e.primitives[n].setPrimitiveType(n),e.primitives[n].set({lastLightComplexity:0,lastLightCount:0,lastSelectionPass:!1},!0);we(t,e,["context"]),e.VBOBuildTime={},be(e.VBOBuildTime,{mtime:0}),e.selectionStateChanged={},be(e.selectionStateChanged,{mtime:0}),ZT(t,e)}var t2=ne(e2,"vtkOpenGLPolyDataMapper");He("vtkMapper",t2);var r2=Tt.ColorMode,Mt=Tt.ScalarMode,la=Tt.GetArray;function n2(t,e){e.classHierarchy.push("vtkMapper2D"),t.createDefaultLookupTable=function(){e.lookupTable=hr.newInstance()},t.getColorModeAsString=function(){return d.enumToString(r2,e.colorMode)},t.setColorModeToDefault=function(){return t.setColorMode(0)},t.setColorModeToMapScalars=function(){return t.setColorMode(1)},t.setColorModeToDirectScalars=function(){return t.setColorMode(2)},t.getScalarModeAsString=function(){return d.enumToString(Mt,e.scalarMode)},t.setScalarModeToDefault=function(){return t.setScalarMode(0)},t.setScalarModeToUsePointData=function(){return t.setScalarMode(1)},t.setScalarModeToUseCellData=function(){return t.setScalarMode(2)},t.setScalarModeToUsePointFieldData=function(){return t.setScalarMode(3)},t.setScalarModeToUseCellFieldData=function(){return t.setScalarMode(4)},t.setScalarModeToUseFieldData=function(){return t.setScalarMode(5)},t.getAbstractScalars=function(r,n,a,i,s){if(!r||!e.scalarVisibility)return{scalars:null,cellFLag:!1};var f=null,o=!1;if(n===Mt.DEFAULT)f=r.getPointData().getScalars(),f||(f=r.getCellData().getScalars(),o=!0);else if(n===Mt.USE_POINT_DATA)f=r.getPointData().getScalars();else if(n===Mt.USE_CELL_DATA)f=r.getCellData().getScalars(),o=!0;else if(n===Mt.USE_POINT_FIELD_DATA){var u=r.getPointData();a===la.BY_ID?f=u.getArrayByIndex(i):f=u.getArrayByName(s)}else if(n===Mt.USE_CELL_FIELD_DATA){var c=r.getCellData();o=!0,a===la.BY_ID?f=c.getArrayByIndex(i):f=c.getArrayByName(s)}else if(n===Mt.USE_FIELD_DATA){var g=r.getFieldData();a===la.BY_ID?f=g.getArrayByIndex(i):f=g.getArrayByName(s)}return{scalars:f,cellFlag:o}},t.getLookupTable=function(){return e.lookupTable||t.createDefaultLookupTable(),e.lookupTable},t.getMTime=function(){var r=e.mtime;if(e.lookupTable!==null){var n=e.lookupTable.getMTime();r=n>r?n:r}return r},t.mapScalars=function(r,n){var a=t.getAbstractScalars(r,e.scalarMode,e.arrayAccessMode,e.arrayId,e.colorByArrayName).scalars;if(!a){e.colorMapColors=null;return}var i="".concat(t.getMTime()).concat(a.getMTime()).concat(n);if(e.colorBuildString!==i){e.useLookupTableScalarRange||t.getLookupTable().setRange(e.scalarRange[0],e.scalarRange[1]);var s=t.getLookupTable();s&&(s.build(),e.colorMapColors=s.mapScalars(a,e.colorMode,e.fieldDataTupleId)),e.colorBuildString="".concat(t.getMTime()).concat(a.getMTime()).concat(n)}}}var a2={static:!1,lookupTable:null,scalarVisibility:!1,scalarRange:[0,1],useLookupTableScalarRange:!1,colorMode:0,scalarMode:0,arrayAccessMode:1,renderTime:0,colorByArrayName:null,transformCoordinate:null,viewSpecificProperties:null,customShaderAttributes:[]};function vc(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,a2,r),Mu.extend(t,e,r),d.get(t,e,["colorMapColors"]),d.setGet(t,e,["arrayAccessMode","colorByArrayName","colorMode","lookupTable","renderTime","scalarMode","scalarVisibility","static","transformCoordinate","useLookupTableScalarRange","viewSpecificProperties","customShaderAttributes"]),d.setGetArray(t,e,["scalarRange"],2),e.viewSpecificProperties||(e.viewSpecificProperties={}),n2(t,e)}var i2=d.newInstance(vc,"vtkMapper2D"),s2={newInstance:i2,extend:vc},o2=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkPolyData2DFS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/

uniform int PrimitiveIDOffset;

// Texture coordinates
//VTK::TCoord::Dec

// Scalar coloring
//VTK::Color::Dec

// Depth Peeling
//VTK::DepthPeeling::Dec

// picking support
//VTK::Picking::Dec

// the output of this shader
//VTK::Output::Dec

// Apple Bug
//VTK::PrimID::Dec

void main()
{
  // Apple Bug
  //VTK::PrimID::Impl

  //VTK::Color::Impl
  //VTK::TCoord::Impl

  //VTK::DepthPeeling::Impl
  //VTK::Picking::Impl

  if (gl_FragData[0].a <= 0.0)
    {
    discard;
    }
}
`,f2=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkPolyData2DVS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/

// all variables that represent positions or directions have a suffix
// indicating the coordinate system they are in. The possible values are
// MC - Model Coordinates
// WC - WC world coordinates
// VC - View Coordinates
// DC - Display Coordinates

in vec4 vertexWC;

// frag position in VC
//VTK::PositionVC::Dec

// material property values
//VTK::Color::Dec

// Texture coordinates
//VTK::TCoord::Dec

// Apple Bug
//VTK::PrimID::Dec

uniform mat4 WCVCMatrix;  // World to view matrix

void main()
{
  // Apple Bug
  //VTK::PrimID::Impl

  gl_Position = WCVCMatrix*vertexWC;

  //VTK::TCoord::Impl

  //VTK::Color::Impl

  //VTK::PositionVC::Impl
}
`,pc={BACKGROUND:0,FOREGROUND:1},lc={DisplayLocation:pc},_e=Gr.primTypes,sn=s2.ScalarMode,on=Y,u2={type:"StartEvent"},c2={type:"EndEvent"};function g2(t,e){e.classHierarchy.push("vtkOpenGLPolyDataMapper2D"),t.buildPass=function(n){n&&(e.openGLActor2D=t.getFirstAncestorOfType("vtkOpenGLActor2D"),e._openGLRenderer=e.openGLActor2D.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getParent(),e.openGLCamera=e._openGLRenderer.getViewNodeFor(e._openGLRenderer.getRenderable().getActiveCamera()))},t.overlayPass=function(n){n&&t.render()},t.getShaderTemplate=function(n,a,i){var s=e.renderable.getViewSpecificProperties().OpenGL,f=f2;if(s){var o=s.VertexShaderCode;o!==void 0&&o!==""&&(f=o)}n.Vertex=f;var u=o2;if(s){var c=s.FragmentShaderCode;c!==void 0&&c!==""&&(u=c)}n.Fragment=u;var g="";if(s){var v=s.GeometryShaderCode;v!==void 0&&(g=v)}n.Geometry=g},t.render=function(){var n=e._openGLRenderWindow.getContext();if(e.context!==n){e.context=n;for(var a=_e.Start;a<_e.End;a++)e.primitives[a].setOpenGLRenderWindow(e._openGLRenderWindow)}var i=e.openGLActor2D.getRenderable(),s=e._openGLRenderer.getRenderable();t.renderPiece(s,i)},t.renderPiece=function(n,a){if(t.invokeEvent(u2),e.renderable.getStatic()||e.renderable.update(),e.currentInput=e.renderable.getInputData(),t.invokeEvent(c2),!e.currentInput){on("No input!");return}!e.currentInput.getPoints||!e.currentInput.getPoints().getNumberOfValues()||(t.renderPieceStart(n,a),t.renderPieceDraw(n,a),t.renderPieceFinish(n,a))},t.renderPieceStart=function(n,a){if(e.primitiveIDOffset=0,e._openGLRenderer.getSelector())switch(e._openGLRenderer.getSelector().getCurrentPass()){default:e._openGLRenderer.getSelector().renderProp(a)}t.updateBufferObjects(n,a),e.lastBoundBO=null},t.getNeedToRebuildShaders=function(n,a,i){return n.getShaderSourceTime().getMTime()<e.renderable.getMTime()||n.getShaderSourceTime().getMTime()<e.currentInput.getMTime()},t.updateBufferObjects=function(n,a){t.getNeedToRebuildBufferObjects(n,a)&&t.buildBufferObjects(n,a)},t.getNeedToRebuildBufferObjects=function(n,a){var i=e.VBOBuildTime.getMTime();return!!(i<t.getMTime()||i<e._openGLRenderWindow.getMTime()||i<e.renderable.getMTime()||i<a.getMTime()||i<e.currentInput.getMTime()||e.renderable.getTransformCoordinate()&&i<n.getMTime())},t.buildBufferObjects=function(n,a){var i=e.currentInput;if(i!==null){e.renderable.mapScalars(i,a.getProperty().getOpacity());var s=e.renderable.getColorMapColors();e.haveCellScalars=!1;var f=e.renderable.getScalarMode();e.renderable.getScalarVisibility()&&(f===sn.USE_CELL_DATA||f===sn.USE_CELL_FIELD_DATA||f===sn.USE_FIELD_DATA||!i.getPointData().getScalars())&&f!==sn.USE_POINT_FIELD_DATA&&s&&(e.haveCellScalars=!0);var o=a.getProperty().getRepresentation(),u=i.getPointData().getTCoords();e.openGLActor2D.getActiveTextures()||(u=null);var c=e.renderable.getTransformCoordinate(),g=n.getRenderWindow().getViews()[0],v=g.getViewportSize(n),p="".concat(i.getMTime(),"A").concat(o,"B").concat(i.getMTime())+"C".concat(s?s.getMTime():1)+"D".concat(u?u.getMTime():1)+"E".concat(c?n.getMTime():1)+"F".concat(v);if(e.VBOBuildString!==p){var l=i.getPoints();if(c){var y=Fn.newInstance(),h=l.getNumberOfPoints();y.setNumberOfPoints(h);for(var T=[],x=0;x<h;++x){l.getPoint(x,T),c.setValue(T);var S=c.getComputedDoubleViewportValue(n);y.setPoint(x,S[0],S[1],0)}l=y}var O={points:l,tcoords:u,colors:s,cellOffset:0,haveCellScalars:e.haveCellSCalars,customAttributes:e.renderable.getCustomShaderAttributes().map(function(C){return i.getPointData().getArrayByName(C)})};O.cellOffset+=e.primitives[_e.Points].getCABO().createVBO(i.getVerts(),"verts",o,O),O.cellOffset+=e.primitives[_e.Lines].getCABO().createVBO(i.getLines(),"lines",o,O),O.cellOffset+=e.primitives[_e.Tris].getCABO().createVBO(i.getPolys(),"polys",o,O),O.cellOffset+=e.primitives[_e.TriStrips].getCABO().createVBO(i.getStrips(),"strips",o,O),e.VBOBuildTime.modified(),e.VBOBuildString=p}}},t.renderPieceDraw=function(n,a){var i=a.getProperty().getRepresentation(),s=e.context;s.depthMask(!0);for(var f=_e.Start;f<_e.End;f++){var o=e.primitives[f].getCABO();o.getElementCount()&&(e.lastBoundBO=e.primitives[f],e.primitiveIDOffset+=e.primitives[f].drawArrays(n,a,i,t))}},t.renderPieceFinish=function(n,a){e.lastBoundBO&&e.lastBoundBO.getVAO().release()},t.buildShaders=function(n,a,i){t.getShaderTemplate(n,a,i);var s=e.renderable.getViewSpecificProperties().OpenGL,f=null;if(s&&(f=s.ShaderReplacements),f)for(var o=0;o<f.length;o++){var u=f[o];if(u.replaceFirst){var c=u.shaderType,g=n[c],v=k.substitute(g,u.originalValue,u.replacementValue,u.replaceAll);n[c]=v.result}}if(t.replaceShaderValues(n,a,i),f)for(var p=0;p<f.length;p++){var l=f[p];if(!l.replaceFirst){var y=l.shaderType,h=n[y],T=k.substitute(h,l.originalValue,l.replacementValue,l.replaceAll);n[y]=T.result}}},t.replaceShaderValues=function(n,a,i){t.replaceShaderColor(n,a,i),t.replaceShaderTCoord(n,a,i),t.replaceShaderPicking(n,a,i),t.replaceShaderPositionVC(n,a,i)},t.replaceShaderColor=function(n,a,i){var s=n.Vertex,f=n.Geometry,o=n.Fragment;e.haveCellScalars&&(o=k.substitute(o,"//VTK::Color::Dec",["uniform samplerBuffer texture1;"]).result,o=k.substitute(o,"//VTK::Color::Impl",["gl_FragData[0] = texelFetchBuffer(texture1, gl_PrimitiveID + PrimitiveIDOffset);"]).result),e.lastBoundBO.getCABO().getColorComponents()!==0?(s=k.substitute(s,"//VTK::Color::Dec",["in vec4 diffuseColor;","out vec4 fcolorVSOutput;"]).result,s=k.substitute(s,"//VTK::Color::Impl",["fcolorVSOutput = diffuseColor;"]).result,f=k.substitute(f,"//VTK::Color::Dec",[`in vec4 fcolorVSOutput[];
`,"out vec4 fcolorGSOutput;"]).result,f=k.substitute(f,"//VTK::Color::Impl",["fcolorGSOutput = fcolorVSOutput[i];"]).result,o=k.substitute(o,"//VTK::Color::Dec",["in vec4 fcolorVSOutput;"]).result,o=k.substitute(o,"//VTK::Color::Impl",["gl_FragData[0] = fcolorVSOutput;"]).result):(o=k.substitute(o,"//VTK::Color::Dec",["uniform vec4 diffuseColor;"]).result,o=k.substitute(o,"//VTK::Color::Impl",["gl_FragData[0] = diffuseColor;"]).result),n.Vertex=s,n.Geometry=f,n.Fragment=o},t.replaceShaderTCoord=function(n,a,i){if(e.lastBoundBO.getCABO().getTCoordOffset()){var s=n.Vertex,f=n.Geometry,o=n.Fragment,u=e.lastBoundBO.getCABO().getTCoordComponents();u===1?(s=k.substitute(s,"//VTK::TCoord::Dec",["in float tcoordMC;","out float tcoordVCVSOutput;"]).result,s=k.substitute(s,"//VTK::TCoord::Impl",["tcoordVCVSOutput = tcoordMC;"]).result,f=k.substitute(f,"//VTK::TCoord::Dec",[`in float tcoordVCVSOutput[];
`,"out float tcoordVCGSOutput;"]).result,f=k.substitute(f,["//VTK::TCoord::Impl","tcoordVCGSOutput = tcoordVCVSOutput[i];"]).result,o=k.substitute(o,"//VTK::TCoord::Dec",["in float tcoordVCVSOutput;","uniform sampler2D texture1;"]).result,o=k.substitute(o,"//VTK::TCoord::Impl",["gl_FragData[0] = gl_FragData[0]*texture2D(texture1, vec2(tcoordVCVSOutput,0));"]).result):u===2&&(s=k.substitute(s,"//VTK::TCoord::Dec",["in vec2 tcoordMC;","out vec2 tcoordVCVSOutput;"]).result,s=k.substitute(s,"//VTK::TCoord::Impl",["tcoordVCVSOutput = tcoordMC;"]).result,f=k.substitute(f,"//VTK::TCoord::Dec",[`in vec2 tcoordVCVSOutput[];
`,"out vec2 tcoordVCGSOutput;"]).result,f=k.substitute(f,"//VTK::TCoord::Impl",["tcoordVCGSOutput = tcoordVCVSOutput[i];"]).result,o=k.substitute(o,"//VTK::TCoord::Dec",["in vec2 tcoordVCVSOutput;","uniform sampler2D texture1;"]).result,o=k.substitute(o,"//VTK::TCoord::Impl",["gl_FragData[0] = gl_FragData[0]*texture2D(texture1, tcoordVCVSOutput.st);"]).result),e.haveCellScalars&&(f=k.substitute(f,"//VTK::PrimID::Impl",["gl_PrimitiveID = gl_PrimitiveIDIn;"]).result),n.Vertex=s,n.Geometry=f,n.Fragment=o}},t.replaceShaderPicking=function(n,a,i){var s=n.Fragment;s=k.substitute(s,"//VTK::Picking::Dec",["uniform vec3 mapperIndex;","uniform int picking;"]).result,s=k.substitute(s,"//VTK::Picking::Impl","  gl_FragData[0] = picking != 0 ? vec4(mapperIndex,1.0) : gl_FragData[0];").result,n.Fragment=s},t.replaceShaderPositionVC=function(n,a,i){e.lastBoundBO.replaceShaderPositionVC(n,a,i)},t.invokeShaderCallbacks=function(n,a,i){var s=e.renderable.getViewSpecificProperties().ShadersCallbacks;s&&s.forEach(function(f){f.callback(f.userData,n,a,i)})},t.setMapperShaderParameters=function(n,a,i){if(n.getProgram().isUniformUsed("PrimitiveIDOffset")&&n.getProgram().setUniformi("PrimitiveIDOffset",e.primitiveIDOffset),n.getProgram().isAttributeUsed("vertexWC")&&(n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"vertexWC",n.getCABO().getVertexOffset(),n.getCABO().getStride(),e.context.FLOAT,3,!1)||on("Error setting vertexWC in shader VAO.")),n.getCABO().getElementCount()&&(e.VBOBuildTime.getMTime()>n.getAttributeUpdateTime().getMTime()||n.getShaderSourceTime().getMTime()>n.getAttributeUpdateTime().getMTime())){e.renderable.getCustomShaderAttributes().forEach(function(v,p){n.getProgram().isAttributeUsed("".concat(v,"MC"))&&(n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"".concat(v,"MC"),n.getCABO().getCustomData()[p].offset,n.getCABO().getStride(),e.context.FLOAT,n.getCABO().getCustomData()[p].components,!1)||on("Error setting ".concat(v,"MC in shader VAO.")))}),n.getProgram().isAttributeUsed("tcoordMC")&&n.getCABO().getTCoordOffset()?n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"tcoordMC",n.getCABO().getTCoordOffset(),n.getCABO().getStride(),e.context.FLOAT,n.getCABO().getTCoordComponents(),!1)||on("Error setting tcoordMC in shader VAO."):n.getVAO().removeAttributeArray("tcoordMC"),e.internalColorTexture&&n.getProgram().isUniformUsed("texture1")&&n.getProgram().setUniformi("texture1",e.internalColorTexture.getTextureUnit());var s=e.openGLActor2D.getActiveTextures();if(s)for(var f=0;f<s.length;++f){var o=s[f],u=o.getTextureUnit(),c="texture".concat(u+1);n.getProgram().isUniformUsed(c)&&n.getProgram().setUniformi(c,u)}n.setMapperShaderParameters(a,i,e._openGLRenderer.getTiledSizeAndOrigin());var g=e._openGLRenderer.getSelector();n.getProgram().setUniform3fArray("mapperIndex",g?g.getPropColorValue():[0,0,0]),n.getProgram().setUniformi("picking",g?g.getCurrentPass()+1:0)}},t.setPropertyShaderParameters=function(n,a,i){var s=e.renderable.getColorMapColors();if(!s||s.getNumberOfComponents()===0){var f=n.getProgram(),o=i.getProperty(),u=o.getOpacity(),c=o.getColor(),g=[c[0],c[1],c[2],u];f.setUniform4f("diffuseColor",g)}},t.setLightingShaderParameters=function(n,a,i){};function r(n,a,i){return a.identity(i),n.reduce(function(s,f,o){return o===0?f?a.copy(s,f):a.identity(s):f?a.multiply(s,s,f):s},i)}t.setCameraShaderParameters=function(n,a,i){var s=n.getProgram(),f=n.getCABO().getCoordShiftAndScaleEnabled(),o=f?n.getCABO().getInverseShiftAndScaleMatrix():null,u=a.getRenderWindow().getViews()[0],c=u.getViewportSize(a),g=a.getViewport(),v=i.getActualPositionCoordinate().getComputedDoubleViewportValue(a),p=[0,0,1,1],l=[0,0,1,1];if(l[0]=g[0]>=p[0]?g[0]:p[0],l[1]=g[1]>=p[1]?g[1]:p[1],l[2]=g[2]<=p[2]?g[2]:p[2],l[3]=g[3]<=p[3]?g[3]:p[3],!(l[0]>=l[2])&&!(l[1]>=l[3])){c[0]=Qr(c[0]*(l[2]-l[0])/(g[2]-g[0])),c[1]=Qr(c[1]*(l[3]-l[1])/(g[3]-g[1]));var y=e._openGLRenderer.getParent().getSize(),h=Qr(v[0]-(l[0]-g[0])*y[0]),T=Qr(v[1]-(l[1]-g[1])*y[1]),x=-h,S=-h+c[0],O=-T,C=-T+c[1];x===S&&(S=x+1),O===C&&(C=O+1);var w=ge(new Float64Array(16));w[0]=2/(S-x),w[1*4+1]=2/(C-O),w[0*4+3]=-1*(S+x)/(S-x),w[1*4+3]=-1*(C+O)/(C-O),w[2*4+2]=0,w[2*4+3]=i.getProperty().getDisplayLocation()===pc.FOREGROUND?-1:1,w[3*4+3]=1,Se(w,w),s.setUniformMatrix("WCVCMatrix",r([w,o],La,e.tmpMat4))}}}var v2={context:null,VBOBuildTime:0,VBOBuildString:null,primitives:null,primTypes:null,shaderRebuildString:null};function p2(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,v2,r),ie.extend(t,e,r),gc.implementReplaceShaderCoincidentOffset(t,e,r),e.primitives=[],e.primTypes=_e,e.tmpMat4=ge(new Float64Array(16));for(var n=_e.Start;n<_e.End;n++)e.primitives[n]=Gr.newInstance(),e.primitives[n].setPrimitiveType(n),e.primitives[n].set({lastLightComplexity:0,lastLightCount:0,lastSelectionPass:!1},!0);we(t,e,["context"]),e.VBOBuildTime={},be(e.VBOBuildTime,{mtime:0}),g2(t,e)}var l2=ne(p2,"vtkOpenGLPolyDataMapper2D");He("vtkMapper2D",l2);function ao(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function rt(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ao(Object(r),!0).forEach(function(n){K(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ao(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var h2=Uu.VectorMode;function ha(t,e){t.strokeStyle=e.strokeColor,t.lineWidth=e.strokeSize,t.fillStyle=e.fontColor,t.font="".concat(e.fontStyle," ").concat(e.fontSize,"px ").concat(e.fontFamily)}function hc(t,e){return function(r){var n=r.getLastSize(),a=Math.pow(n[0]/700,.8),i=Math.pow(n[1]/700,.8),s=Math.min(a,i),f=r.getAxisTextStyle(),o=r.getTickTextStyle();Object.assign(f,e.axisTextStyle),Object.assign(o,e.tickTextStyle),f.fontSize=Math.max(24*s,12),r.getLastAspectRatio()>1?o.fontSize=Math.max(20*s,10):o.fontSize=Math.max(16*s,10);var u=r.updateTextureAtlas();r.setTopTitle(!1);var c=r.getBoxSizeByReference();if(r.getLastAspectRatio()>1)r.setTickLabelPixelOffset(.3*o.fontSize),u.titleWidth<=u.tickWidth+r.getTickLabelPixelOffset()+.8*o.fontSize?(r.setTopTitle(!0),r.setAxisTitlePixelOffset(.2*o.fontSize),c[0]=2*(u.tickWidth+r.getTickLabelPixelOffset()+.8*o.fontSize)/n[0],r.setBoxPosition([.98-c[0],-.92])):(r.setAxisTitlePixelOffset(.2*o.fontSize),c[0]=2*(u.titleHeight+r.getAxisTitlePixelOffset()+u.tickWidth+r.getTickLabelPixelOffset()+.8*o.fontSize)/n[0],r.setBoxPosition([.99-c[0],-.92])),c[1]=Math.max(1.2,Math.min(1.84/i,1.84));else{r.setAxisTitlePixelOffset(1.2*o.fontSize),r.setTickLabelPixelOffset(.1*o.fontSize);var g=2*(.8*o.fontSize+u.titleHeight+r.getAxisTitlePixelOffset())/n[1],v=2*u.tickWidth/n[0];c[0]=Math.min(1.9,Math.max(1.4,1.4*v*(r.getTicks().length+3))),c[1]=g,r.setBoxPosition([-.5*c[0],-.97])}r.recomputeBarSegments(u)}}function yc(t,e){return function(r){var n=r.getLastTickBounds(),a=ii().domain([n[0],n[1]]),i=a.ticks(5),s=a.tickFormat(5);r.setTicks(i),r.setTickStrings(i.map(s))}}function y2(t,e){e.classHierarchy.push("vtkScalarBarActorHelper"),t.setRenderable=function(a){e.renderable!==a&&(e.renderable=a,e.barActor.setProperty(a.getProperty()),e.barActor.setParentProp(a),e.barActor.setCoordinateSystemToDisplay(),e.tmActor.setProperty(a.getProperty()),e.tmActor.setParentProp(a),e.tmActor.setCoordinateSystemToDisplay(),e.generateTicks=a.generateTicks,e.axisTextStyle=rt({},a.getAxisTextStyle()),e.tickTextStyle=rt({},a.getTickTextStyle()),t.modified())},t.updateAPISpecificData=function(a,i,s){(e.lastSize[0]!==a[0]||e.lastSize[1]!==a[1])&&(e.lastSize[0]=a[0],e.lastSize[1]=a[1],e.lastAspectRatio=a[0]/a[1],e.forceUpdate=!0);var f=e.renderable.getScalarsToColors();if(!(!f||!e.renderable.getVisibility())&&(e.barMapper.setLookupTable(f),e.camera=i,e.renderWindow=s,e.forceUpdate||Math.max(f.getMTime(),t.getMTime(),e.renderable.getMTime())>e.lastRebuildTime.getMTime())){var o=f.getMappingRange();if(e.lastTickBounds=re(o),e.renderable.getGenerateTicks()(t),e.renderable.getAutomated())e.renderable.getAutoLayout()(t);else{e.axisTextStyle=rt({},e.renderable.getAxisTextStyle()),e.tickTextStyle=rt({},e.renderable.getTickTextStyle()),e.barPosition=re(e.renderable.getBarPosition()),e.barSize=re(e.renderable.getBarSize()),e.boxPosition=re(e.renderable.getBoxPosition()),e.boxSize=re(e.renderable.getBoxSize()),e.axisTitlePixelOffset=e.renderable.getAxisTitlePixelOffset(),e.tickLabelPixelOffset=e.renderable.getTickLabelPixelOffset();var u=t.updateTextureAtlas();t.recomputeBarSegments(u)}t.updatePolyDataForLabels(),t.updatePolyDataForBarSegments(),e.lastRebuildTime.modified(),e.forceUpdate=!1}},t.updateTextureAtlas=function(){e.tmContext.textBaseline="bottom",e.tmContext.textAlign="left";var a={},i=new Map,s=0,f=1;ha(e.tmContext,e.axisTextStyle);var o=e.tmContext.measureText(e.renderable.getAxisLabel()),u={height:o.actualBoundingBoxAscent+2,startingHeight:f,width:o.width+2,textStyle:e.axisTextStyle};i.set(e.renderable.getAxisLabel(),u),f+=u.height,s=u.width,a.titleWidth=u.width,a.titleHeight=u.height,a.tickWidth=0,a.tickHeight=0,ha(e.tmContext,e.tickTextStyle);for(var c=[].concat(re(t.getTickStrings()),["NaN","Below","Above"]),g=0;g<c.length;g++)i.has(c[g])||(o=e.tmContext.measureText(c[g]),u={height:o.actualBoundingBoxAscent+2,startingHeight:f,width:o.width+2,textStyle:e.tickTextStyle},i.set(c[g],u),f+=u.height,s<u.width&&(s=u.width),a.tickWidth<u.width&&(a.tickWidth=u.width),a.tickHeight<u.height&&(a.tickHeight=u.height));return s=$e(s),f=$e(f),i.forEach(function(v){v.tcoords=[0,(f-v.startingHeight-v.height)/f,v.width/s,(f-v.startingHeight-v.height)/f,v.width/s,(f-v.startingHeight)/f,0,(f-v.startingHeight)/f]}),e.tmCanvas.width=s,e.tmCanvas.height=f,e.tmContext.textBaseline="bottom",e.tmContext.textAlign="left",e.tmContext.clearRect(0,0,s,f),i.forEach(function(v,p){ha(e.tmContext,v.textStyle),e.tmContext.fillText(p,1,v.startingHeight+v.height-1)}),e.tmTexture.setCanvas(e.tmCanvas),e.tmTexture.modified(),e._tmAtlas=i,a},t.computeBarSize=function(a){e.vertical=e.boxSize[1]>e.boxSize[0];var i=2*a.tickHeight/e.lastSize[1],s=[1,1];if(e.vertical){var f=2*(a.tickWidth+e.tickLabelPixelOffset)/e.lastSize[0];if(e.topTitle){var o=2*(a.titleHeight+e.axisTitlePixelOffset)/e.lastSize[1];e.barSize[0]=e.boxSize[0]-f,e.barSize[1]=e.boxSize[1]-o}else{var u=2*(a.titleHeight+e.axisTitlePixelOffset)/e.lastSize[0];e.barSize[0]=e.boxSize[0]-u-f,e.barSize[1]=e.boxSize[1]}e.barPosition[0]=e.boxPosition[0]+f,e.barPosition[1]=e.boxPosition[1],s[1]=i}else{var c=(2*a.tickWidth-8)/e.lastSize[0],g=2*(a.titleHeight+e.axisTitlePixelOffset)/e.lastSize[1];e.barSize[0]=e.boxSize[0],e.barPosition[0]=e.boxPosition[0],e.barSize[1]=e.boxSize[1]-g,e.barPosition[1]=e.boxPosition[1],s[0]=c}return s},t.recomputeBarSegments=function(a){var i,s,f,o,u=t.computeBarSize(a);e.barSegments=[];var c=[0,0],g=e.vertical?1:0,v=e.vertical?.01:.02;function p(h,T){e.barSegments.push({corners:[[].concat(c),[c[0]+u[0],c[1]],[c[0]+u[0],c[1]+u[1]],[c[0],c[1]+u[1]]],scalars:T,title:h}),c[g]+=u[g]+v}e.renderable.getDrawNanAnnotation()&&e.renderable.getScalarsToColors().getNanColor()&&p("NaN",[NaN,NaN,NaN,NaN]),e.renderable.getDrawBelowRangeSwatch()&&(i=(s=e.renderable.getScalarsToColors()).getUseBelowRangeColor)!==null&&i!==void 0&&i.call(s)&&p("Below",[-.1,-.1,-.1,-.1]);var l=(f=(o=e.renderable.getScalarsToColors()).getUseAboveRangeColor)===null||f===void 0?void 0:f.call(o);c[g]+=v;var y=u[g];u[g]=l?1-2*v-u[g]-c[g]:1-v-c[g],p("ticks",e.vertical?[0,0,.995,.995]:[0,.995,.995,0]),e.renderable.getDrawAboveRangeSwatch()&&l&&(u[g]=y,c[g]+=v,p("Above",[1.1,1.1,1.1,1.1]))};var r=new Float64Array(3);t.createPolyDataForOneLabel=function(a,i,s,f,o,u){var c=e._tmAtlas.get(a);if(!!c){var g=u.ptIdx,v=u.cellIdx;r[0]=(.5*i[0]+.5)*e.lastSize[0],r[1]=(.5*i[1]+.5)*e.lastSize[1],r[2]=i[2],r[0]+=o[0],r[1]+=o[1];var p=[],l=f==="vertical"?[1,0]:[0,1];f==="vertical"?(p[0]=c.width,p[1]=-c.height,s[0]==="middle"?r[1]-=c.width/2:s[0]==="right"&&(r[1]-=c.width),s[1]==="middle"?r[0]+=c.height/2:s[1]==="top"&&(r[0]+=c.height)):(p[0]=c.width,p[1]=c.height,s[0]==="middle"?r[0]-=c.width/2:s[0]==="right"&&(r[0]-=c.width),s[1]==="middle"?r[1]-=c.height/2:s[1]==="top"&&(r[1]-=c.height)),u.points[g*3]=r[0],u.points[g*3+1]=r[1],u.points[g*3+2]=r[2],u.tcoords[g*2]=c.tcoords[0],u.tcoords[g*2+1]=c.tcoords[1],g++,r[l[0]]+=p[0],u.points[g*3]=r[0],u.points[g*3+1]=r[1],u.points[g*3+2]=r[2],u.tcoords[g*2]=c.tcoords[2],u.tcoords[g*2+1]=c.tcoords[3],g++,r[l[1]]+=p[1],u.points[g*3]=r[0],u.points[g*3+1]=r[1],u.points[g*3+2]=r[2],u.tcoords[g*2]=c.tcoords[4],u.tcoords[g*2+1]=c.tcoords[5],g++,r[l[0]]-=p[0],u.points[g*3]=r[0],u.points[g*3+1]=r[1],u.points[g*3+2]=r[2],u.tcoords[g*2]=c.tcoords[6],u.tcoords[g*2+1]=c.tcoords[7],g++,u.polys[v*4]=3,u.polys[v*4+1]=g-4,u.polys[v*4+2]=g-3,u.polys[v*4+3]=g-2,v++,u.polys[v*4]=3,u.polys[v*4+1]=g-4,u.polys[v*4+2]=g-2,u.polys[v*4+3]=g-1,u.ptIdx+=4,u.cellIdx+=2}};var n=new Float64Array(3);t.updatePolyDataForLabels=function(){var a=t.getTickStrings().length+e.barSegments.length,i=a*4,s=a*2,f=new Float64Array(i*3),o=new Uint16Array(s*4),u=new Float32Array(i*2),c={ptIdx:0,cellIdx:0,polys:o,points:f,tcoords:u},g=e.vertical?0:1,v=e.vertical?1:0;n[2]=-.99;var p=e.vertical?["right","middle"]:["middle","bottom"],l=[0,1],y=[0,0];e.vertical?(y[0]=-e.tickLabelPixelOffset,e.topTitle?(n[0]=e.boxPosition[0]+.5*e.boxSize[0],n[1]=e.barPosition[1]+e.barSize[1],t.createPolyDataForOneLabel(e.renderable.getAxisLabel(),n,["middle","bottom"],"horizontal",[0,e.axisTitlePixelOffset],c)):(n[0]=e.barPosition[0]+e.barSize[0],n[1]=e.barPosition[1]+.5*e.barSize[1],t.createPolyDataForOneLabel(e.renderable.getAxisLabel(),n,["middle","top"],"vertical",[e.axisTitlePixelOffset,0],c)),l=[-1,0]):(y[1]=e.tickLabelPixelOffset,n[0]=e.barPosition[0]+.5*e.barSize[0],n[1]=e.barPosition[1]+e.barSize[1],t.createPolyDataForOneLabel(e.renderable.getAxisLabel(),n,["middle","bottom"],"horizontal",[0,e.axisTitlePixelOffset],c)),n[g]=e.barPosition[g]+(.5*l[g]+.5)*e.barSize[g],n[v]=e.barPosition[v]+e.barSize[v]*.5;for(var h=null,T=0;T<e.barSegments.length;T++){var x=e.barSegments[T];x.title==="ticks"?h=x:(n[v]=e.barPosition[v]+.5*e.barSize[v]*(x.corners[2][v]+x.corners[0][v]),t.createPolyDataForOneLabel(x.title,n,p,"horizontal",y,c))}for(var S=e.barPosition[v]+e.barSize[v]*h.corners[0][v],O=e.barSize[v]*(h.corners[2][v]-h.corners[0][v]),C=t.getTicks(),w=t.getTickStrings(),E=0;E<C.length;E++){var M=(C[E]-e.lastTickBounds[0])/(e.lastTickBounds[1]-e.lastTickBounds[0]);n[v]=S+O*M,t.createPolyDataForOneLabel(w[E],n,p,"horizontal",y,c)}var L=ve.newInstance({numberOfComponents:2,values:u,name:"TextureCoordinates"});e.tmPolyData.getPointData().setTCoords(L),e.tmPolyData.getPoints().setData(f,3),e.tmPolyData.getPoints().modified(),e.tmPolyData.getPolys().setData(o,1),e.tmPolyData.getPolys().modified(),e.tmPolyData.modified()},t.updatePolyDataForBarSegments=function(){var a,i,s=e.renderable.getScalarsToColors(),f=0;e.renderable.getDrawNanAnnotation()&&s.getNanColor()&&(f+=1),e.renderable.getDrawBelowRangeSwatch()&&(a=s.getUseBelowRangeColor)!==null&&a!==void 0&&a.call(s)&&(f+=1),e.renderable.getDrawAboveRangeSwatch()&&(i=s.getUseAboveRangeColor)!==null&&i!==void 0&&i.call(s)&&(f+=1);var o=4*(1+f),u=o,c=1;s.getVectorMode()===h2.COMPONENT&&(c=s.getVectorComponent()+1);for(var g=new Float64Array(o*3),v=new Uint16Array(u*5),p=new Float32Array(o*c),l=0,y=0,h=0;h<e.barSegments.length;h++){for(var T=e.barSegments[h],x=0;x<4;x++){n[0]=e.barPosition[0]+T.corners[x][0]*e.barSize[0],n[1]=e.barPosition[1]+T.corners[x][1]*e.barSize[1],g[l*3]=(.5*n[0]+.5)*e.lastSize[0],g[l*3+1]=(.5*n[1]+.5)*e.lastSize[1],g[l*3+2]=n[2];for(var S=0;S<c;S++)p[l*c+S]=e.lastTickBounds[0]+T.scalars[x]*(e.lastTickBounds[1]-e.lastTickBounds[0]);l++}v[y*5]=4,v[y*5+1]=l-4,v[y*5+2]=l-3,v[y*5+3]=l-2,v[y*5+4]=l-1,y++}var O=ve.newInstance({numberOfComponents:c,values:p,name:"Scalars"});e.polyData.getPointData().setScalars(O),e.polyData.getPoints().setData(g,3),e.polyData.getPoints().modified(),e.polyData.getPolys().setData(v,1),e.polyData.getPolys().modified(),e.polyData.modified()}}var T2=d.newInstance(function(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{renderable:null};Object.assign(e,{},r),d.obj(t,e),d.setGet(t,e,["axisTitlePixelOffset","tickLabelPixelOffset","renderable","topTitle","ticks","tickStrings"]),d.get(t,e,["lastSize","lastAspectRatio","lastTickBounds","axisTextStyle","tickTextStyle","barActor","tmActor"]),d.getArray(t,e,["boxPosition","boxSize"]),d.setArray(t,e,["boxPosition","boxSize"],2),e.forceUpdate=!1,e.lastRebuildTime={},d.obj(e.lastRebuildTime,{mtime:0}),e.lastSize=[-1,-1],e.tmCanvas=document.createElement("canvas"),e.tmContext=e.tmCanvas.getContext("2d"),e._tmAtlas=new Map,e.barMapper=ar.newInstance(),e.barMapper.setInterpolateScalarsBeforeMapping(!0),e.barMapper.setUseLookupTableScalarRange(!0),e.polyData=Lr.newInstance(),e.barMapper.setInputData(e.polyData),e.barActor=nr.newInstance(),e.barActor.setMapper(e.barMapper),e.tmPolyData=Lr.newInstance(),e.tmMapper=ar.newInstance(),e.tmMapper.setInputData(e.tmPolyData),e.tmTexture=Hn.newInstance({resizable:!0}),e.tmTexture.setInterpolate(!1),e.tmActor=nr.newInstance({parentProp:t}),e.tmActor.setMapper(e.tmMapper),e.tmActor.addTexture(e.tmTexture),e.barPosition=[0,0],e.barSize=[0,0],e.boxPosition=[.88,-.92],e.boxSize=[.1,1.1],e.lastTickBounds=[],y2(t,e)},"vtkScalarBarActorHelper");function x2(t,e){e.classHierarchy.push("vtkScalarBarActor"),t.setTickTextStyle=function(r){e.tickTextStyle=rt(rt({},e.tickTextStyle),r),t.modified()},t.setAxisTextStyle=function(r){e.axisTextStyle=rt(rt({},e.axisTextStyle),r),t.modified()},t.resetAutoLayoutToDefault=function(){t.setAutoLayout(hc(t,e))},t.resetGenerateTicksToDefault=function(){t.setGenerateTicks(yc())}}function d2(t){return rt({automated:!0,autoLayout:null,axisLabel:"Scalar Value",barPosition:[0,0],barSize:[0,0],boxPosition:[.88,-.92],boxSize:[.1,1.1],scalarToColors:null,axisTitlePixelOffset:36,axisTextStyle:{fontColor:"white",fontStyle:"normal",fontSize:18,fontFamily:"serif"},tickLabelPixelOffset:14,tickTextStyle:{fontColor:"white",fontStyle:"normal",fontSize:14,fontFamily:"serif"},generateTicks:null,drawNanAnnotation:!0,drawBelowRangeSwatch:!0,drawAboveRangeSwatch:!0},t)}function Tc(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,d2(r)),e.autoLayout||(e.autoLayout=hc(t,e)),e.generateTicks||(e.generateTicks=yc()),nr.extend(t,e,r),t.getProperty().setDiffuse(0),t.getProperty().setAmbient(1),d.setGet(t,e,["automated","autoLayout","axisTitlePixelOffset","axisLabel","scalarsToColors","tickLabelPixelOffset","generateTicks","drawNanAnnotation","drawBelowRangeSwatch","drawAboveRangeSwatch"]),d.get(t,e,["axisTextStyle","tickTextStyle"]),d.getArray(t,e,["barPosition","barSize","boxPosition","boxSize"]),d.setArray(t,e,["barPosition","barSize","boxPosition","boxSize"],2),x2(t,e)}var O2=d.newInstance(Tc,"vtkScalarBarActor"),xc={newInstance:O2,extend:Tc,newScalarBarActorHelper:T2};function S2(t,e){e.classHierarchy.push("vtkOpenGLScalarBarActor"),t.buildPass=function(r){r&&(e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getParent(),e.scalarBarActorHelper.getRenderable()||e.scalarBarActorHelper.setRenderable(e.renderable),t.prepareNodes(),t.addMissingNode(e.scalarBarActorHelper.getBarActor()),t.addMissingNode(e.scalarBarActorHelper.getTmActor()),t.removeUnusedNodes())},t.opaquePass=function(r,n){if(r){var a=e._openGLRenderer?e._openGLRenderer.getRenderable().getActiveCamera():null,i=e._openGLRenderer.getTiledSizeAndOrigin();e.scalarBarActorHelper.updateAPISpecificData([i.usize,i.vsize],a,e._openGLRenderWindow.getRenderable())}}}var C2={};function w2(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,C2,r),ie.extend(t,e,r),e.scalarBarActorHelper=xc.newScalarBarActorHelper(),S2(t,e)}var E2=ne(w2,"vtkOpenGLScalarBarActor");He("vtkScalarBarActor",E2);var io=Y;function M2(t,e){e.classHierarchy.push("vtkOpenGLSkybox"),t.buildPass=function(r){if(r){e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getParent(),e.context=e._openGLRenderWindow.getContext(),e.tris.setOpenGLRenderWindow(e._openGLRenderWindow),e.openGLTexture.setOpenGLRenderWindow(e._openGLRenderWindow);var n=e._openGLRenderer.getRenderable();e.openGLCamera=e._openGLRenderer.getViewNodeFor(n.getActiveCamera())}},t.queryPass=function(r,n){if(r){if(!e.renderable||!e.renderable.getVisibility())return;n.incrementOpaqueActorCount()}},t.opaquePass=function(r,n){if(r&&!e._openGLRenderer.getSelector()){t.updateBufferObjects(),e.context.depthMask(!0),e._openGLRenderWindow.getShaderCache().readyShaderProgram(e.tris.getProgram()),e.openGLTexture.render(e._openGLRenderWindow);var a=e.openGLTexture.getTextureUnit();e.tris.getProgram().setUniformi("sbtexture",a);var i=e._openGLRenderer.getRenderable(),s=e.openGLCamera.getKeyMatrices(i),f=new Float64Array(16);if(At(f,s.wcpc),e.tris.getProgram().setUniformMatrix("IMCPCMatrix",f),e.lastFormat==="box"){var o=i.getActiveCamera().getPosition();e.tris.getProgram().setUniform3f("camPos",o[0],o[1],o[2])}e.tris.getVAO().bind(),e.context.drawArrays(e.context.TRIANGLES,0,e.tris.getCABO().getElementCount()),e.tris.getVAO().release(),e.openGLTexture.deactivate()}},t.updateBufferObjects=function(){if(!e.tris.getCABO().getElementCount()){for(var r=new Float32Array(12),n=0;n<4;n++)r[n*3]=n%2*2-1,r[n*3+1]=n>1?1:-1,r[n*3+2]=1;var a=ve.newInstance({numberOfComponents:3,values:r});a.setName("points");var i=new Uint16Array(8);i[0]=3,i[1]=0,i[2]=1,i[3]=3,i[4]=3,i[5]=0,i[6]=3,i[7]=2;var s=ve.newInstance({numberOfComponents:1,values:i});e.tris.getCABO().createVBO(s,"polys",Fe.SURFACE,{points:a,cellOffset:0})}e.renderable.getFormat()!==e.lastFormat&&(e.lastFormat=e.renderable.getFormat(),e.lastFormat==="box"&&e.tris.setProgram(e._openGLRenderWindow.getShaderCache().readyShaderProgramArray(`//VTK::System::Dec
             attribute vec3 vertexMC;
             uniform mat4 IMCPCMatrix;
             varying vec3 TexCoords;
             void main () {
              gl_Position = vec4(vertexMC.xyz, 1.0);
              vec4 wpos = IMCPCMatrix * gl_Position;
              TexCoords = wpos.xyz/wpos.w;
             }`,`//VTK::System::Dec
             //VTK::Output::Dec
             varying vec3 TexCoords;
             uniform samplerCube sbtexture;
             uniform vec3 camPos;
             void main () {
               // skybox looks from inside out
               // which means we have to adjust
               // our tcoords. Otherwise text would
               // be flipped
               vec3 tc = normalize(TexCoords - camPos);
               if (abs(tc.z) < max(abs(tc.x),abs(tc.y)))
               {
                 tc = vec3(1.0, 1.0, -1.0) * tc;
               }
               else
               {
                 tc = vec3(-1.0, 1.0, 1.0) * tc;
               }
               gl_FragData[0] = textureCube(sbtexture, tc);
             }`,"")),e.lastFormat==="background"&&e.tris.setProgram(e._openGLRenderWindow.getShaderCache().readyShaderProgramArray(`//VTK::System::Dec
             attribute vec3 vertexMC;
             uniform mat4 IMCPCMatrix;
             varying vec2 TexCoords;
             void main () {
              gl_Position = vec4(vertexMC.xyz, 1.0);
              vec4 wpos = IMCPCMatrix * gl_Position;
              TexCoords = vec2(vertexMC.x, vertexMC.y)*0.5 + 0.5;
             }`,`//VTK::System::Dec
             //VTK::Output::Dec
             varying vec2 TexCoords;
             uniform sampler2D sbtexture;
             void main () {
               gl_FragData[0] = texture2D(sbtexture, TexCoords);
             }`,"")),e.tris.getShaderSourceTime().modified(),e.tris.getVAO().bind(),e.tris.getVAO().addAttributeArray(e.tris.getProgram(),e.tris.getCABO(),"vertexMC",e.tris.getCABO().getVertexOffset(),e.tris.getCABO().getStride(),e.context.FLOAT,3,e.context.FALSE)||io("Error setting vertexMC in shader VAO."));var f=e.renderable.getTextures();f.length||io("vtkSkybox requires a texture map"),e.openGLTexture.getRenderable()!==f[0]&&(e.openGLTexture.releaseGraphicsResources(e._openGLRenderWindow),e.openGLTexture.setRenderable(f[0]))}}var D2={context:null};function b2(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,D2,r),ie.extend(t,e,r),e.openGLTexture=Pn.newInstance(),e.tris=Gr.newInstance(),e.keyMatrixTime={},be(e.keyMatrixTime,{mtime:0}),e.keyMatrices={normalMatrix:$t(new Float64Array(9)),mcwc:ge(new Float64Array(16))},we(t,e,["context"]),je(t,e,["activeTextures"]),M2(t,e)}var L2=ne(b2);He("vtkSkybox",L2);var R2=_t;function V2(t,e){e.classHierarchy.push("vtkOpenGLPixelSpaceCallbackMapper"),t.opaquePass=function(r,n){e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getParent();var a=e._openGLRenderer.getAspectRatio(),i=e._openGLRenderer?e._openGLRenderer.getRenderable().getActiveCamera():null,s=e._openGLRenderer.getTiledSizeAndOrigin(),f=null;if(e.renderable.getUseZValues()){var o=n.getZBufferTexture(),u=Math.floor(o.getWidth()),c=Math.floor(o.getHeight()),g=e._openGLRenderWindow.getContext();o.bind();var v=n.getFramebuffer();v?v.saveCurrentBindingsAndBuffers():R2("No framebuffer to save/restore");var p=g.createFramebuffer();g.bindFramebuffer(g.FRAMEBUFFER,p),g.framebufferTexture2D(g.FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.TEXTURE_2D,o.getHandle(),0),g.checkFramebufferStatus(g.FRAMEBUFFER)===g.FRAMEBUFFER_COMPLETE&&(f=new Uint8Array(u*c*4),g.viewport(0,0,u,c),g.readPixels(0,0,u,c,g.RGBA,g.UNSIGNED_BYTE,f)),v&&v.restorePreviousBindingsAndBuffers(),g.deleteFramebuffer(p)}e.renderable.invokeCallback(e.renderable.getInputData(),i,a,s,f)},t.queryPass=function(r,n){r&&e.renderable.getUseZValues()&&n.requestDepth()}}var k2={};function B2(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,k2,r),ie.extend(t,e,r),V2(t,e)}var U2=ne(B2,"vtkOpenGLPixelSpaceCallbackMapper");He("vtkPixelSpaceCallbackMapper",U2);var dc=Object.create(null);function st(t,e){dc[t]=e}function N2(t,e){e.classHierarchy.push("vtkWebGPUViewNodeFactory")}var F2={};function m2(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,F2,r),e.overrides=dc,Cf.extend(t,e,r),N2(t,e)}d.newInstance(m2,"vtkWebGPUViewNodeFactory");function G2(t,e){e.classHierarchy.push("vtkWebGPUCamera"),t.getProjectionMatrix=function(r,n,a,i){if(ge(r),e.renderable.getParallelProjection()){var s=e.renderable.getParallelScale(),f=s*n,o=s,u=(i[0]-1)*f,c=(i[0]+1)*f,g=(i[1]-1)*o,v=(i[1]+1)*o,p=1/(c-u),l=1/(v-g);r[0]=2*p,r[5]=2*l,r[10]=1/(a[1]-a[0]),r[12]=(c+u)*p,r[13]=(v+g)*l,r[14]=a[1]/(a[1]-a[0])}else{var y=Math.tan(Math.PI*e.renderable.getViewAngle()/360),h,T;e.renderable.getUseHorizontalViewAngle()===!0?(h=a[0]*y,T=a[0]*y/n):(h=a[0]*y*n,T=a[0]*y);var x=(i[0]-1)*h,S=(i[0]+1)*h,O=(i[1]-1)*T,C=(i[1]+1)*T;r[0]=2*a[0]/(S-x),r[5]=2*a[0]/(C-O),r[12]=(x+S)/(S-x),r[13]=(O+C)/(C-O),r[10]=0,r[14]=a[0],r[11]=-1,r[15]=0}},t.convertToOpenGLDepth=function(r){if(e.renderable.getParallelProjection())return 1-r;var n=e.renderable.getClippingRangeByReference(),a=-n[0]/r;return a=(n[0]+n[1])/(n[1]-n[0])+2*n[0]*n[1]/(a*(n[1]-n[0])),.5*a+.5},t.getKeyMatrices=function(r){var n=r.getRenderable(),a=r.getParent();if(Math.max(a.getMTime(),t.getMTime(),n.getMTime(),e.renderable.getMTime(),r.getStabilizedTime())>e.keyMatrixTime.getMTime()){var i=e.renderable.getViewMatrix();Qe(e.keyMatrices.normalMatrix,i),e.keyMatrices.normalMatrix[3]=0,e.keyMatrices.normalMatrix[7]=0,e.keyMatrices.normalMatrix[11]=0,At(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix),Se(e.keyMatrices.wcvc,i);var s=r.getStabilizedCenterByReference();at(e.keyMatrices.scvc,e.keyMatrices.wcvc,s);var f=r.getAspectRatio(),o=e.renderable.getClippingRangeByReference();t.getProjectionMatrix(e.keyMatrices.vcpc,f,o,e.renderable.getWindowCenterByReference()),nt(e.keyMatrices.scpc,e.keyMatrices.vcpc,e.keyMatrices.scvc),At(e.keyMatrices.pcsc,e.keyMatrices.scpc),e.keyMatrixTime.modified()}return e.keyMatrices}}var _2={keyMatrixTime:null,keyMatrices:null};function A2(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,_2,r),ie.extend(t,e,r),e.keyMatrixTime={},d.obj(e.keyMatrixTime),e.keyMatrices={normalMatrix:new Float64Array(16),vcpc:new Float64Array(16),pcsc:new Float64Array(16),wcvc:new Float64Array(16),scpc:new Float64Array(16),scvc:new Float64Array(16)},d.setGet(t,e,["keyMatrixTime"]),G2(t,e)}var $2=d.newInstance(A2);st("vtkCamera",$2);function W2(t,e){e.classHierarchy.push("vtkWebGPUBindGroup"),t.setBindables=function(r){if(e.bindables.length===r.length){for(var n=!0,a=0;a<e.bindables.length;a++)e.bindables[a]!==r[a]&&(n=!1);if(n)return}e.bindables=r,t.modified()},t.getBindGroupLayout=function(r){for(var n=[],a=0;a<e.bindables.length;a++){var i=e.bindables[a].getBindGroupLayoutEntry();i.binding=a,n.push(i)}return r.getBindGroupLayout({entries:n})},t.getBindGroup=function(r){for(var n=t.getMTime(),a=0;a<e.bindables.length;a++){var i=e.bindables[a].getBindGroupTime().getMTime();n=i>n?i:n}if(n<e.bindGroupTime.getMTime())return e.bindGroup;for(var s=[],f=0;f<e.bindables.length;f++){var o=e.bindables[f].getBindGroupEntry();o.binding=f,s.push(o)}return e.bindGroup=r.getHandle().createBindGroup({layout:t.getBindGroupLayout(r),entries:s,label:e.label}),e.bindGroupTime.modified(),e.bindGroup},t.getShaderCode=function(r){for(var n=[],a=r.getBindGroupLayoutCount(e.label),i=0;i<e.bindables.length;i++)n.push(e.bindables[i].getShaderCode(i,a));return n.join(`
`)}}var z2={device:null,handle:null,label:null};function Oc(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,z2,r),d.obj(t,e),e.bindables=[],e.bindGroupTime={},d.obj(e.bindGroupTime,{mtime:0}),d.get(t,e,["bindGroupTime","handle","sizeInBytes","usage"]),d.setGet(t,e,["label","device","arrayInformation"]),W2(t,e)}var j2=d.newInstance(Oc),Sc={newInstance:j2,extend:Oc};function H2(t,e){e.classHierarchy.push("vtkWebGPUShaderModule"),t.initialize=function(r,n){e.device=r,e.handle=e.device.getHandle().createShaderModule({code:n.getCode()})}}var P2={device:null,handle:null};function Cc(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,P2,r),d.obj(t,e),d.get(t,e,["lastCameraMTime"]),d.setGet(t,e,["device","handle"]),H2(t,e)}var K2=d.newInstance(Cc,"vtkWebGPUShaderModule"),X2={newInstance:K2,extend:Cc};function Y2(t,e,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,a=Array.isArray(r)?r.join(`
`):r,i=!1;t.search(e)!==-1&&(i=!0);var s="";n&&(s="g");var f=new RegExp(e,s),o=t.replace(f,a);return{replace:i,result:o}}function I2(t,e){e.classHierarchy.push("vtkWebGPUShaderCache"),t.getShaderModule=function(r){for(var n=r.getType(),a=r.getHash(),i=e._shaderModules.keys(),s=0;s<i.length;s++){var f=i[s];if(f.getHash()===a&&f.getType()===n)return e._shaderModules.get(f)}var o=X2.newInstance();return o.initialize(e.device,r),e._shaderModules.set(r,o),o}}var Q2={shaderModules:null,device:null,window:null};function wc(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Q2,r),e._shaderModules=new Map,d.obj(t,e),d.setGet(t,e,["device","window"]),I2(t,e)}var q2=d.newInstance(wc,"vtkWebGPUShaderCache"),q={newInstance:q2,extend:wc,substitute:Y2};function Z2(t,e){e.classHierarchy.push("vtkWebGPUPipeline"),t.getShaderDescriptions=function(){return e.shaderDescriptions},t.initialize=function(r,n){e.pipelineDescription=e.renderEncoder.getPipelineSettings(),e.pipelineDescription.primitive.topology=e.topology,e.pipelineDescription.vertex=e.vertexState,e.pipelineDescription.label=n;for(var a=[],i=0;i<e.layouts.length;i++)a.push(e.layouts[i].layout);e.pipelineLayout=r.getHandle().createPipelineLayout({bindGroupLayouts:a}),e.pipelineDescription.layout=e.pipelineLayout;for(var s=0;s<e.shaderDescriptions.length;s++){var f=e.shaderDescriptions[s],o=r.getShaderModule(f);f.getType()==="vertex"&&(e.pipelineDescription.vertex.module=o.getHandle(),e.pipelineDescription.vertex.entryPoint="main"),f.getType()==="fragment"&&(e.pipelineDescription.fragment.module=o.getHandle(),e.pipelineDescription.fragment.entryPoint="main")}e.handle=r.getHandle().createRenderPipeline(e.pipelineDescription)},t.getShaderDescription=function(r){for(var n=0;n<e.shaderDescriptions.length;n++)if(e.shaderDescriptions[n].getType()===r)return e.shaderDescriptions[n];return null},t.addBindGroupLayout=function(r){!r||e.layouts.push({layout:r.getBindGroupLayout(e.device),label:r.getLabel()})},t.getBindGroupLayout=function(r){return e.layouts[r].layout},t.getBindGroupLayoutCount=function(r){for(var n=0;n<e.layouts.length;n++)if(e.layouts[n].label===r)return n;return 0},t.bindVertexInput=function(r,n){n.bindBuffers(r)}}var J2={handle:null,layouts:null,renderEncoder:null,shaderDescriptions:null,vertexState:null,topology:null,pipelineDescription:null};function Ec(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,J2,r),be(t,e),e.layouts=[],e.shaderDescriptions=[],je(t,e,["handle","pipelineDescription"]),we(t,e,["device","renderEncoder","topology","vertexState"]),Z2(t,e)}var ex=ne(Ec,"vtkWebGPUPipeline"),tx={newInstance:ex,extend:Ec};function rx(t,e){e.classHierarchy.push("vtkWebGPUShaderDescription"),t.hasOutput=function(r){return e.outputNames.includes(r)},t.addOutput=function(r,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;e.outputTypes.push(r),e.outputNames.push(n),e.outputInterpolations.push(a)},t.addBuiltinOutput=function(r,n){e.builtinOutputTypes.push(r),e.builtinOutputNames.push(n)},t.addBuiltinInput=function(r,n){e.builtinInputTypes.push(r),e.builtinInputNames.push(n)},t.replaceShaderCode=function(r,n){var a=[],i=[];if(n&&a.push(n.getShaderCode()),r||e.builtinInputNames.length){var s=[];if(s.push("struct ".concat(e.type,`Input
{`)),r)for(var f=r.getOutputNamesByReference(),o=r.getOutputTypesByReference(),u=r.getOutputInterpolationsByReference(),c=0;c<f.length;c++)u[c]!==void 0?s.push("  @location(".concat(c,") @interpolate(").concat(u[c],") ").concat(f[c]," : ").concat(o[c],",")):s.push("  @location(".concat(c,") ").concat(f[c]," : ").concat(o[c],","));for(var g=0;g<e.builtinInputNames.length;g++)s.push("  ".concat(e.builtinInputNames[g]," : ").concat(e.builtinInputTypes[g],","));s.length>1&&(s.push("};"),i=s,a[a.length-1]+=",",a.push("input: ".concat(e.type,"Input")))}if(a.length&&(e.code=q.substitute(e.code,"//VTK::IOStructs::Input",a).result),e.outputNames.length+e.builtinOutputNames.length){for(var v=["struct ".concat(e.type,`Output
{`)],p=0;p<e.outputNames.length;p++)e.outputInterpolations[p]!==void 0?v.push("  @location(".concat(p,") @interpolate(").concat(e.outputInterpolations[p],") ").concat(e.outputNames[p]," : ").concat(e.outputTypes[p],",")):v.push("  @location(".concat(p,") ").concat(e.outputNames[p]," : ").concat(e.outputTypes[p],","));for(var l=0;l<e.builtinOutputNames.length;l++)v.push("  ".concat(e.builtinOutputNames[l]," : ").concat(e.builtinOutputTypes[l],","));v.push("};"),i=i.concat(v),e.code=q.substitute(e.code,"//VTK::IOStructs::Output",["-> ".concat(e.type,"Output")]).result}e.code=q.substitute(e.code,"//VTK::IOStructs::Dec",i).result}}var nx={type:null,hash:null,code:null,outputNames:null,outputTypes:null};function Mc(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,nx,r),e.outputNames=[],e.outputTypes=[],e.outputInterpolations=[],e.builtinOutputNames=[],e.builtinOutputTypes=[],e.builtinInputNames=[],e.builtinInputTypes=[],d.obj(t,e),d.setGet(t,e,["type","hash","code"]),d.getArray(t,e,["outputTypes","outputNames","outputInterpolations"]),rx(t,e)}var ax=d.newInstance(Mc,"vtkWebGPUShaderDescription"),so={newInstance:ax,extend:Mc},oo={r8unorm:{numComponents:1,nativeType:Uint8Array,stride:1,elementSize:1,sampleType:"float"},r8snorm:{numComponents:1,nativeType:Int8Array,stride:1,elementSize:1,sampleType:"float"},r8uint:{numComponents:1,nativeType:Uint8Array,stride:1,elementSize:1,sampleType:"uint"},r8sint:{numComponents:1,nativeType:Int8Array,stride:1,elementSize:1,sampleType:"sint"},r16uint:{numComponents:1,nativeType:Uint16Array,stride:2,elementSize:2,sampleType:"uint"},r16sint:{numComponents:1,nativeType:Int16Array,stride:2,elementSize:2,sampleType:"sint"},r16float:{numComponents:1,nativeType:Float32Array,stride:2,elementSize:2,sampleType:"float"},rg8unorm:{numComponents:2,nativeType:Uint8Array,stride:2,elementSize:1,sampleType:"float"},rg8snorm:{numComponents:2,nativeType:Int8Array,stride:2,elementSize:1,sampleType:"float"},rg8uint:{numComponents:2,nativeType:Uint8Array,stride:2,elementSize:1,sampleType:"uint"},rg8sint:{numComponents:2,nativeType:Int8Array,stride:2,elementSize:1,sampleType:"sint"},r32uint:{numComponents:1,nativeType:Uint32Array,stride:4,elementSize:4,sampleType:"uint"},r32sint:{numComponents:1,nativeType:Int32Array,stride:4,elementSize:4,sampleType:"sint"},r32float:{numComponents:1,nativeType:Float32Array,stride:4,elementSize:4,sampleType:"unfilterable-float"},rg16uint:{numComponents:2,nativeType:Uint16Array,stride:4,elementSize:2,sampleType:"uint"},rg16sint:{numComponents:2,nativeType:Int16Array,stride:4,elementSize:2,sampleType:"sint"},rg16float:{numComponents:2,nativeType:Float32Array,stride:4,elementSize:2,sampleType:"float"},rgba8unorm:{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"float"},"rgba8unorm-srgb":{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"float"},rgba8snorm:{numComponents:4,nativeType:Int8Array,stride:4,elementSize:1,sampleType:"float"},rgba8uint:{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"uint"},rgba8sint:{numComponents:4,nativeType:Int8Array,stride:4,elementSize:1,sampleType:"sint"},bgra8unorm:{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"float"},"bgra8unorm-srgb":{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"float"},rgb9e5ufloat:{numComponents:4,nativeType:Uint32Array,stride:4,sampleType:"float"},rgb10a2unorm:{numComponents:4,nativeType:Uint32Array,stride:4,sampleType:"float"},rg11b10ufloat:{numComponents:4,nativeType:Float32Array,stride:4,sampleType:"float"},rg32uint:{numComponents:2,nativeType:Uint32Array,stride:8,elementSize:4,sampleType:"uint"},rg32sint:{numComponents:2,nativeType:Int32Array,stride:8,elementSize:4,sampleType:"sint"},rg32float:{numComponents:2,nativeType:Float32Array,stride:8,elementSize:4,sampleType:"unfilterable-float"},rgba16uint:{numComponents:4,nativeType:Uint16Array,stride:8,elementSize:2,sampleType:"uint"},rgba16sint:{numComponents:4,nativeType:Int16Array,stride:8,elementSize:2,sampleType:"sint"},rgba16float:{numComponents:4,nativeType:Float32Array,stride:8,elementSize:2,sampleType:"float"},rgba32uint:{numComponents:4,nativeType:Uint32Array,stride:16,elementSize:4,sampleType:"uint"},rgba32sint:{numComponents:4,nativeType:Int32Array,stride:16,elementSize:4,sampleType:"sint"},rgba32float:{numComponents:4,nativeType:Float32Array,stride:16,elementSize:4,sampleType:"unfilterable-float"},stencil8:{numComponents:1,nativeType:Uint8Array,stride:1,elementSize:1,sampleType:"uint"},depth16unorm:{numComponents:1,nativeType:Uint16Array,stride:2,elementSize:2,sampleType:"depth"},depth24plus:{numComponents:1,nativeType:Uint32Array,stride:4,elementSize:3,sampleType:"depth"},"depth24plus-stencil8":{numComponents:2,nativeType:Uint32Array,stride:4,sampleType:"mixed"},depth32float:{numComponents:1,nativeType:Float32Array,stride:4,elementSize:4,sampleType:"depth"}};function ix(t){return!t||t.length<6?0:t in oo?oo[t]:(Y("unknown format ".concat(t)),null)}function sx(t){if(!t||t.length<5)return 0;var e=1;t[t.length-2]==="x"&&(e=Number(t[t.length-1]));var r=e===1?t.length-1:t.length-3,n=Number(t[r]);if(Number.isNaN(n))return Y("unknown format ".concat(t)),0;var a=5-n/2;return e*a}function ox(t){if(!t||t.length<5)return 0;var e=1;return t[t.length-2]==="x"&&(e=Number(t[t.length-1])),e}function fx(t){if(!t||t.length<5)return 0;var e;if(t[0]==="f")e="Float";else if(t[0]==="s")e="Int";else if(t[0]==="u")e="Uint";else{Y("unknown format ".concat(t));return}var r=t.split("x")[0],n=Number(r[r.length-1]);if(Number.isNaN(n)){Y("unknown format ".concat(t));return}return e+=8*(5-n/2),e+="Array",e}function ux(t){var e;if(t[0]==="f"||t[1]==="n")e="f32";else if(t[0]==="s"&&t[1]==="i")e="i32";else if(t[0]==="u"&&t[1]==="i")e="u32";else{Y("unknown format ".concat(t));return}var r=1;return t[t.length-2]==="x"&&(r=Number(t[t.length-1])),r===4?"vec4<".concat(e,">"):r===3?"vec3<".concat(e,">"):r===2?"vec2<".concat(e,">"):e}function cx(t){if(!t)return 0;var e=1;t.substring(0,3)==="vec"?e=Number(t[3]):t.substring(0,3)==="mat"&&(e=t[3]*t[5]);var r=4;return e*r}function gx(t){if(!!t){if(t.includes("f32"))return"Float32Array";if(t.includes("i32"))return"Int32Array";if(t.includes("u32"))return"Uint32Array";Y("unknown format ".concat(t))}}var ye={getDetailsFromTextureFormat:ix,getByteStrideFromBufferFormat:sx,getNumberOfComponentsFromBufferFormat:ox,getNativeTypeFromBufferFormat:fx,getShaderTypeFromBufferFormat:ux,getByteStrideFromShaderFormat:cx,getNativeTypeFromShaderFormat:gx};function vx(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(var r=0;r<t.length;++r)if(!e.includes(t[r]))return!1;return!0}function px(t,e){e.classHierarchy.push("vtkWebGPUVertexInput"),t.addBuffer=function(r,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"vertex",i=n;Array.isArray(i)||(i=[i]);for(var s=0;s<e.inputs.length;s++)if(vx(e.inputs[s].names,i)){if(e.inputs[s].buffer===r)return;e.inputs[s].buffer=r;return}e.inputs.push({buffer:r,stepMode:a,names:i}),e.inputs=e.inputs.sort(function(f,o){return f.names[0]<o.names[0]?-1:f.names[0]>o.names[0]?1:0})},t.removeBufferIfPresent=function(r){for(var n=0;n<e.inputs.length;n++)e.inputs[n].names.includes(r)&&e.inputs.splice(n,1)},t.getBuffer=function(r){for(var n=0;n<e.inputs.length;n++)if(e.inputs[n].names.includes(r))return e.inputs[n].buffer;return null},t.hasAttribute=function(r){for(var n=0;n<e.inputs.length;n++)if(e.inputs[n].names.includes(r))return!0;return!1},t.getAttributeTime=function(r){for(var n=0;n<e.inputs.length;n++)if(e.inputs[n].names.includes(r))return e.inputs[n].buffer.getSourceTime();return 0},t.getShaderCode=function(){for(var r="",n=0,a=0;a<e.inputs.length;a++)for(var i=0;i<e.inputs[a].names.length;i++){var s=e.inputs[a].buffer.getArrayInformation()[i],f=ye.getShaderTypeFromBufferFormat(s.format);n>0&&(r+=`,
`),r="".concat(r,"  @location(").concat(n,") ").concat(e.inputs[a].names[i]," : ").concat(f),n++}return r},t.getVertexInputInformation=function(){var r={};if(e.inputs.length){for(var n=[],a=0,i=0;i<e.inputs.length;i++){for(var s=e.inputs[i].buffer,f={arrayStride:s.getStrideInBytes(),stepMode:e.inputs[i].stepMode,attributes:[]},o=s.getArrayInformation(),u=0;u<e.inputs[i].names.length;u++)f.attributes.push({shaderLocation:a,offset:o[u].offset,format:o[u].format}),a++;n.push(f)}r.buffers=n}return r},t.bindBuffers=function(r){for(var n=0;n<e.inputs.length;n++)r.setVertexBuffer(n,e.inputs[n].buffer.getHandle());e.indexBuffer&&r.setIndexBuffer(e.indexBuffer.getHandle(),e.indexBuffer.getArrayInformation()[0].format)},t.getReady=function(){},t.releaseGraphicsResources=function(){e.created&&(e.inputs=[],e.bindingDescriptions=[],e.attributeDescriptions=[])}}var lx={inputs:null,bindingDescriptions:!1,attributeDescriptions:null,indexBuffer:null};function Dc(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,lx,r),be(t,e),e.bindingDescriptions=[],e.attributeDescriptions=[],e.inputs=[],we(t,e,["created","device","handle","indexBuffer"]),px(t,e)}var hx=ne(Dc,"vtkWebGPUVertexInput"),yx={newInstance:hx,extend:Dc},Tx=`
//VTK::Renderer::Dec

//VTK::Color::Dec

//VTK::Normal::Dec

//VTK::TCoord::Dec

//VTK::Select::Dec

//VTK::Mapper::Dec

//VTK::IOStructs::Dec

@vertex
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output : vertexOutput;

  // var vertex: vec4<f32> = vertexBC;

  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Select::Impl

  //VTK::Position::Impl

  return output;
}
`,xx=`
//VTK::Renderer::Dec

//VTK::Color::Dec

//VTK::Normal::Dec

//VTK::TCoord::Dec

//VTK::Select::Dec

//VTK::RenderEncoder::Dec

//VTK::Mapper::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output : fragmentOutput;

  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::Light::Impl

  //VTK::TCoord::Impl

  //VTK::Select::Impl

  // var computedColor:vec4<f32> = vec4<f32>(1.0,0.5,0.5,1.0);

  //VTK::RenderEncoder::Impl
  return output;
}
`;function dx(t,e){e.classHierarchy.push("vtkWebGPUSimpleMapper"),t.generateShaderDescriptions=function(r,n,a){var i=so.newInstance({type:"vertex",hash:r,code:e.vertexShaderTemplate}),s=so.newInstance({type:"fragment",hash:r,code:e.fragmentShaderTemplate}),f=n.getShaderDescriptions();f.push(i),f.push(s);for(var o=e.vertexShaderTemplate+e.fragmentShaderTemplate,u=new RegExp("//VTK::[^:]*::","g"),c=o.match(u).filter(function(l,y,h){return h.indexOf(l)===y}),g=c.map(function(l){return"replaceShader".concat(l.substring(7,l.length-2))}),v=0;v<g.length;v++){var p=g[v];p!=="replaceShaderIOStructs"&&e.shaderReplacements.has(p)&&e.shaderReplacements.get(p)(r,n,a)}t.replaceShaderIOStructs(r,n,a)},t.replaceShaderIOStructs=function(r,n,a){var i=n.getShaderDescription("vertex");i.replaceShaderCode(null,a);var s=n.getShaderDescription("fragment");s.replaceShaderCode(i)},t.replaceShaderRenderEncoder=function(r,n,a){e.renderEncoder.replaceShaderCode(n)},e.shaderReplacements.set("replaceShaderRenderEncoder",t.replaceShaderRenderEncoder),t.replaceShaderRenderer=function(r,n,a){if(!!e.WebGPURenderer){var i=e.WebGPURenderer.getBindGroup().getShaderCode(n),s=n.getShaderDescription("vertex"),f=s.getCode();f=q.substitute(f,"//VTK::Renderer::Dec",[i]).result,s.setCode(f);var o=n.getShaderDescription("fragment");f=o.getCode(),f=q.substitute(f,"//VTK::Renderer::Dec",[i]).result,o.setCode(f)}},e.shaderReplacements.set("replaceShaderRenderer",t.replaceShaderRenderer),t.replaceShaderMapper=function(r,n,a){var i=e.bindGroup.getShaderCode(n),s=n.getShaderDescription("vertex"),f=s.getCode();f=q.substitute(f,"//VTK::Mapper::Dec",[i]).result,s.setCode(f);var o=n.getShaderDescription("fragment");o.addBuiltinInput("bool","@builtin(front_facing) frontFacing"),f=o.getCode(),f=q.substitute(f,"//VTK::Mapper::Dec",[i]).result,o.setCode(f)},e.shaderReplacements.set("replaceShaderMapper",t.replaceShaderMapper),t.replaceShaderPosition=function(r,n,a){var i=n.getShaderDescription("vertex");i.addBuiltinOutput("vec4<f32>","@builtin(position) Position");var s=i.getCode();s=q.substitute(s,"//VTK::Position::Impl",["    output.Position = rendererUBO.SCPCMatrix*vertexBC;"]).result,i.setCode(s)},e.shaderReplacements.set("replaceShaderPosition",t.replaceShaderPosition),t.replaceShaderTCoord=function(r,n,a){var i=n.getShaderDescription("vertex");i.addOutput("vec2<f32>","tcoordVS")},e.shaderReplacements.set("replaceShaderTCoord",t.replaceShaderTCoord),t.addTextureView=function(r){e.textureViews.includes(r)||e.textureViews.push(r)},t.prepareToDraw=function(r){e.renderEncoder=r,t.updateInput(),t.updateBuffers(),t.updateBindings(),t.updatePipeline()},t.updateInput=function(){},t.updateBuffers=function(){},t.updateBindings=function(){e.bindGroup.setBindables(t.getBindables())},t.computePipelineHash=function(){},t.registerDrawCallback=function(r){r.registerDrawCallback(e.pipeline,t.draw)},t.prepareAndDraw=function(r){t.prepareToDraw(r),r.setPipeline(e.pipeline),t.draw(r)},t.draw=function(r){var n=r.getBoundPipeline();r.activateBindGroup(e.bindGroup),e.WebGPURenderer&&e.WebGPURenderer.bindUBO(r),n.bindVertexInput(r,e.vertexInput);var a=e.vertexInput.getIndexBuffer();a?r.drawIndexed(a.getIndexCount(),e.numberOfInstances,0,0,0):r.draw(e.numberOfVertices,e.numberOfInstances,0,0)},t.getBindables=function(){var r=re(e.additionalBindables);e.UBO&&r.push(e.UBO),e.SSBO&&r.push(e.SSBO);for(var n=0;n<e.textureViews.length;n++){r.push(e.textureViews[n]);var a=e.textureViews[n].getSampler();a&&r.push(a)}return r},t.updatePipeline=function(){t.computePipelineHash(),e.pipeline=e.device.getPipeline(e.pipelineHash),e.pipeline||(e.pipeline=tx.newInstance(),e.pipeline.setDevice(e.device),e.WebGPURenderer&&e.pipeline.addBindGroupLayout(e.WebGPURenderer.getBindGroup()),e.pipeline.addBindGroupLayout(e.bindGroup),t.generateShaderDescriptions(e.pipelineHash,e.pipeline,e.vertexInput),e.pipeline.setTopology(e.topology),e.pipeline.setRenderEncoder(e.renderEncoder),e.pipeline.setVertexState(e.vertexInput.getVertexInputInformation()),e.device.createPipeline(e.pipelineHash,e.pipeline))}}var Ox={additionalBindables:void 0,bindGroup:null,device:null,fragmentShaderTemplate:null,numberOfInstances:1,numberOfVertices:0,pipelineHash:null,shaderReplacements:null,SSBO:null,textureViews:null,topology:"triangle-list",UBO:null,vertexShaderTemplate:null,WebGPURenderer:null};function bc(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Ox,r),ie.extend(t,e,r),e.textureViews=[],e.vertexInput=yx.newInstance(),e.bindGroup=Sc.newInstance({label:"mapperBG"}),e.additionalBindables=[],e.fragmentShaderTemplate=e.fragmentShaderTemplate||xx,e.vertexShaderTemplate=e.vertexShaderTemplate||Tx,e.shaderReplacements=new Map,d.get(t,e,["pipeline","vertexInput"]),d.setGet(t,e,["additionalBindables","device","fragmentShaderTemplate","interpolate","numberOfInstances","numberOfVertices","pipelineHash","shaderReplacements","SSBO","textureViews","topology","UBO","vertexShaderTemplate","WebGPURenderer"]),dx(t,e)}var Sx=d.newInstance(bc,"vtkWebGPUSimpleMapper"),Lc={newInstance:Sx,extend:bc};function Cx(t,e){e.classHierarchy.push("vtkWebGPUFullScreenQuad"),t.replaceShaderPosition=function(r,n,a){var i=n.getShaderDescription("vertex");i.addBuiltinOutput("vec4<f32>","@builtin(position) Position"),i.addOutput("vec4<f32>","vertexVC");var s=i.getCode();s=q.substitute(s,"//VTK::Position::Impl",["output.tcoordVS = vec2<f32>(vertexBC.x * 0.5 + 0.5, 1.0 - vertexBC.y * 0.5 - 0.5);","output.Position = vec4<f32>(vertexBC, 1.0);","output.vertexVC = vec4<f32>(vertexBC, 1);"]).result,i.setCode(s)},e.shaderReplacements.set("replaceShaderPosition",t.replaceShaderPosition),t.updateBuffers=function(){var r=e.device.getBufferManager().getFullScreenQuadBuffer();e.vertexInput.addBuffer(r,["vertexBC"]),e.numberOfVertices=6}}var wx={};function Rc(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,wx,r),Lc.extend(t,e,r),Cx(t,e)}var Ex=d.newInstance(Rc,"vtkWebGPUFullScreenQuad"),fo={newInstance:Ex,extend:Rc},Mx={Verts:0,Lines:1,Triangles:2,Strips:3,LinesFromStrips:4,LinesFromTriangles:5,Points:6,UniformArray:7,PointArray:8,NormalsFromPoints:9,Texture:10,RawVertex:11,Storage:12,Index:13},Dx={Start:0,Points:0,Lines:1,Triangles:2,TriangleStrips:3,TriangleEdges:4,TriangleStripEdges:5,End:6},_r={BufferUsage:Mx,PrimitiveTypes:Dx};function uo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function bx(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?uo(Object(r),!0).forEach(function(n){K(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):uo(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var ya=["getMappedRange","mapAsync","unmap"];function Lx(t,e,r,n){var a=n.byteLength,i=t.createBuffer({size:a,usage:GPUBufferUsage.COPY_SRC,mappedAtCreation:!0}),s=i.getMappedRange(0,a);new Uint8Array(s).set(new Uint8Array(n)),i.unmap();var f=t.createCommandEncoder();f.copyBufferToBuffer(i,0,e,r,a);var o=f.finish(),u=t.queue;u.submit([o]),i.destroy()}function Rx(t,e){e.classHierarchy.push("vtkWebGPUBuffer"),t.create=function(a,i){e.handle=e.device.getHandle().createBuffer({size:a,usage:i,label:e.label}),e.sizeInBytes=a,e.usage=i},t.write=function(a){Lx(e.device.getHandle(),e.handle,0,a.buffer)},t.createAndWrite=function(a,i){e.handle=e.device.getHandle().createBuffer({size:a.byteLength,usage:i,mappedAtCreation:!0,label:e.label}),e.sizeInBytes=a.byteLength,e.usage=i,new Uint8Array(e.handle.getMappedRange()).set(new Uint8Array(a.buffer)),e.handle.unmap()};for(var r=function(i){t[ya[i]]=function(){var s;return(s=e.handle)[ya[i]].apply(s,arguments)}},n=0;n<ya.length;n++)r(n)}var Vx={device:null,handle:null,sizeInBytes:0,strideInBytes:0,arrayInformation:null,usage:null,label:null,sourceTime:null};function Vc(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Vx,r),d.obj(t,e),d.get(t,e,["handle","sizeInBytes","usage"]),d.setGet(t,e,["strideInBytes","device","arrayInformation","label","sourceTime"]),Rx(t,e)}var kx=d.newInstance(Vc),za=bx({newInstance:kx,extend:Vc},_r);function co(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Bx(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?co(Object(r),!0).forEach(function(n){K(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):co(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var go=Fr.Representation,ht=_r.PrimitiveTypes,Ux=function(){function t(){Ka(this,t),this.keys=new Uint32Array(10),this.values=new Uint32Array(10),this.count=0}return Xa(t,[{key:"clear",value:function(){this.count=0}},{key:"has",value:function(r){for(var n=0;n<this.count;n++)if(this.keys[n]===r)return!0}},{key:"get",value:function(r){for(var n=0;n<this.count;n++)if(this.keys[n]===r)return this.values[n]}},{key:"set",value:function(r,n){this.count<9&&(this.keys[this.count]=r,this.values[this.count++]=n)}}]),t}();function Nx(t){switch(t){case ht.Points:return"points";case ht.Lines:return"lines";case ht.Triangles:case ht.TriangleEdges:return"polys";case ht.TriangleStripEdges:case ht.TriangleStrips:return"strips";default:return""}}function fn(t,e,r){var n=t.pointIdToFlatId[e];return n<0&&(n=t.flatId,t.pointIdToFlatId[e]=n,t.flatIdToPointId[t.flatId]=e,t.flatIdToCellId[t.flatId]=r,t.flatId++),n}function Fx(t,e,r){for(var n=t.length,a=0;a<n;a++){var i=t[a];if(r.cellProvokedMap.has(i)){r.ibo[r.iboId++]=r.cellProvokedMap.get(i);for(var s=a+1;s<a+n;s++){i=t[s%n];var f=fn(r,i,e);r.ibo[r.iboId++]=f}return}}for(var o=0;o<n;o++){var u=t[o];if(!r.provokedPointIds[u]){var c=fn(r,u,e);r.provokedPointIds[u]=1,r.cellProvokedMap.set(u,c),r.flatIdToCellId[c]=e,r.ibo[r.iboId++]=c;for(var g=o+1;g<o+n;g++)u=t[g%n],c=fn(r,u,e),r.ibo[r.iboId++]=c;return}}var v=t[0],p=r.flatId;r.cellProvokedMap.set(v,p),r.flatIdToPointId[r.flatId]=v,r.flatIdToCellId[r.flatId]=e,r.flatId++,r.ibo[r.iboId++]=p;for(var l=1;l<n;l++)v=t[l],p=fn(r,v,e),r.ibo[r.iboId++]=p}function mx(t,e,r){var n=t.length;r.iboSize+=n;for(var a=0;a<n;a++){var i=t[a];if(r.cellProvokedMap.has(i))return}for(var s=0;s<n;s++){var f=t[s];if(!r.provokedPointIds[f]){r.provokedPointIds[f]=1,r.cellProvokedMap.set(f,1);return}}r.cellProvokedMap.set(t[0],1),r.extraPoints++}var et,vo=new Uint32Array(1),ke=new Uint32Array(2),ct=new Uint32Array(3),Ta={anythingToPoints:function(e,r,n,a,i){for(var s=0;s<e;++s)vo[0]=r[n+s],et(vo,a,i)},linesToWireframe:function(e,r,n,a,i){for(var s=0;s<e-1;++s)ke[0]=r[n+s],ke[1]=r[n+s+1],et(ke,a,i)},polysToWireframe:function(e,r,n,a,i){if(e>2)for(var s=0;s<e;++s)ke[0]=r[n+s],ke[1]=r[n+(s+1)%e],et(ke,a,i)},stripsToWireframe:function(e,r,n,a,i){if(e>2){for(var s=0;s<e-1;++s)ke[0]=r[n+s],ke[1]=r[n+s+1],et(ke,a,i);for(var f=0;f<e-2;f++)ke[0]=r[n+f],ke[1]=r[n+f+2],et(ke,a,i)}},polysToSurface:function(e,r,n,a,i){for(var s=0;s<e-2;s++)ct[0]=r[n],ct[1]=r[n+s+1],ct[2]=r[n+s+2],et(ct,a,i)},stripsToSurface:function(e,r,n,a,i){for(var s=0;s<e-2;s++)ct[0]=r[n+s],ct[1]=r[n+s+1+s%2],ct[2]=r[n+s+1+(s+1)%2],et(ct,a,i)}};function Gx(t,e){e.classHierarchy.push("vtkWebGPUIndexBuffer"),t.buildIndexBuffer=function(r){var n=r.cells,a=r.primitiveType,i=r.representation,s=r.cellOffset,f=n.getData(),o=f.length,u=Nx(a),c=r.numberOfPoints,g={provokedPointIds:new Uint8Array(c),extraPoints:0,iboSize:0,flatId:0,iboId:0,cellProvokedMap:new Ux},v=null;i===go.POINTS||a===ht.Points?v=Ta.anythingToPoints:i===go.WIREFRAME||a===ht.Lines?v=Ta["".concat(u,"ToWireframe")]:v=Ta["".concat(u,"ToSurface")],et=mx;for(var p=s||0,l=0;l<o;)g.cellProvokedMap.clear(),v(f[l],f,l+1,p,g),l+=f[l]+1,p++;c<=65535?g.flatIdToPointId=new Uint16Array(c+g.extraPoints):g.flatIdToPointId=new Uint32Array(c+g.extraPoints),c+g.extraPoints<36863?g.pointIdToFlatId=new Int16Array(c):g.pointIdToFlatId=new Int32Array(c),c+g.extraPoints<=65535?(g.ibo=new Uint16Array(g.iboSize),r.format="uint16"):(g.ibo=new Uint32Array(g.iboSize),r.format="uint32"),p<=65535?g.flatIdToCellId=new Uint16Array(c+g.extraPoints):g.flatIdToCellId=new Uint32Array(c+g.extraPoints),g.pointIdToFlatId.fill(-1),g.provokedPointIds.fill(0),et=Fx,p=s||0;for(var y=0;y<o;)g.cellProvokedMap.clear(),v(f[y],f,y+1,p,g),y+=f[y]+1,p++;delete g.provokedPointIds,delete g.pointIdToFlatId,r.nativeArray=g.ibo,e.flatIdToPointId=g.flatIdToPointId,e.flatIdToCellId=g.flatIdToCellId,e.flatSize=g.flatId,e.indexCount=g.iboId}}var _x={flatIdToPointId:null,flatIdToCellId:null,flatSize:0,indexCount:0};function kc(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,_x,r),za.extend(t,e,r),d.setGet(t,e,["flatIdToPointId","flatIdToCellId","flatSize","indexCount"]),Gx(t,e)}var Ax=d.newInstance(kc),$x=Bx({newInstance:Ax,extend:kc},_r);function po(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function lo(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?po(Object(r),!0).forEach(function(n){K(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):po(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var gt=_r.BufferUsage,Wx=Y,Dt=ve.VtkDataTypes,zx={};function jx(t){var e;switch(t.getDataType()){case Dt.UNSIGNED_CHAR:e="uint8";break;case Dt.FLOAT:e="float32";break;case Dt.UNSIGNED_INT:e="uint32";break;case Dt.INT:e="sint32";break;case Dt.DOUBLE:e="float32";break;case Dt.UNSIGNED_SHORT:e="uint16";break;case Dt.SHORT:e="sin16";break;default:e="float32";break}switch(t.getNumberOfComponents()){case 2:e+="x2";break;case 3:e.includes("32")||Wx("unsupported x3 type for ".concat(e)),e+="x3";break;case 4:e+="x4";break}return e}function ho(t,e,r,n,a){var i={},s=t.getFlatSize();if(!s)return i;var f=[0,0,0,0];a.shift&&(a.shift.length?f=a.shift:f.fill(a.shift));var o=[1,1,1,1];a.scale&&(a.scale.length?o=a.scale:o.fill(a.scale));var u=Object.prototype.hasOwnProperty.call(a,"packExtra")?a.packExtra:!1,c,g=0,v=r+(u?1:0),p=Br(n,s*v),l=t.getFlatIdToPointId();a.cellData&&(l=t.getFlatIdToCellId()),r===1?c=function(x){p[g++]=o[0]*e[x]+f[0]}:r===2?c=function(x){p[g++]=o[0]*e[x]+f[0],p[g++]=o[1]*e[x+1]+f[1]}:r===3&&!u?c=function(x){p[g++]=o[0]*e[x]+f[0],p[g++]=o[1]*e[x+1]+f[1],p[g++]=o[2]*e[x+2]+f[2]}:r===3&&u?c=function(x){p[g++]=o[0]*e[x]+f[0],p[g++]=o[1]*e[x+1]+f[1],p[g++]=o[2]*e[x+2]+f[2],p[g++]=o[3]*1+f[3]}:r===4&&(c=function(x){p[g++]=o[0]*e[x]+f[0],p[g++]=o[1]*e[x+1]+f[1],p[g++]=o[2]*e[x+2]+f[2],p[g++]=o[3]*e[x+3]+f[3]});for(var y=0;y<s;y++){var h=r*l[y];c(h)}return i.nativeArray=p,i}function Hx(t,e,r,n){var a=[t[n*3]-t[r*3],t[n*3+1]-t[r*3+1],t[n*3+2]-t[r*3+2]],i=[t[e*3]-t[r*3],t[e*3+1]-t[r*3+1],t[e*3+2]-t[r*3+2]],s=[];return si(a,i,s),Vn(s),s}function Px(t,e){var r=e.getData(),n=t.getData();if(!n||!r)return null;for(var a=new Int8Array(t.getNumberOfCells()*4),i=n.length,s=0,f=0;f<i;){var o=Hx(r,n[f+1],n[f+2],n[f+3]);a[s++]=127*o[0],a[s++]=127*o[1],a[s++]=127*o[2],a[s++]=127,f+=n[f]+1}return a}function Kx(t,e){e.classHierarchy.push("vtkWebGPUBufferManager");function r(n){n.dataArray&&!n.nativeArray&&(n.nativeArray=n.dataArray.getData());var a,i;if(n.usage===gt.Index&&(a=$x.newInstance({label:n.label}),a.setDevice(e.device),i=GPUBufferUsage.INDEX|GPUBufferUsage.COPY_DST,a.buildIndexBuffer(n),a.createAndWrite(n.nativeArray,i),a.setArrayInformation([{format:n.format}])),a||(a=za.newInstance({label:n.label}),a.setDevice(e.device)),n.usage===gt.UniformArray&&(i=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,a.createAndWrite(n.nativeArray,i)),n.usage===gt.Storage&&(i=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST,a.createAndWrite(n.nativeArray,i)),n.usage===gt.Texture&&(i=GPUBufferUsage.COPY_SRC,a.createAndWrite(n.nativeArray,i)),n.usage===gt.PointArray){i=GPUBufferUsage.VERTEX;var s=ye.getNativeTypeFromBufferFormat(n.format),f=ho(n.indexBuffer,n.dataArray.getData(),n.dataArray.getNumberOfComponents(),s,{packExtra:n.packExtra,shift:n.shift,scale:n.scale,cellData:n.cellData,cellOffset:n.cellOffset});a.createAndWrite(f.nativeArray,i),a.setStrideInBytes(ye.getByteStrideFromBufferFormat(n.format)),a.setArrayInformation([{offset:0,format:n.format,interpolation:n.cellData?"flat":"perspective"}])}if(n.usage===gt.NormalsFromPoints){i=GPUBufferUsage.VERTEX;var o=ye.getNativeTypeFromBufferFormat(n.format),u=Px(n.cells,n.dataArray),c=ho(n.indexBuffer,u,4,o,{cellData:!0});a.createAndWrite(c.nativeArray,i),a.setStrideInBytes(ye.getByteStrideFromBufferFormat(n.format)),a.setArrayInformation([{offset:0,format:n.format,interpolation:"flat"}])}return n.usage===gt.RawVertex&&(i=GPUBufferUsage.VERTEX,a.createAndWrite(n.nativeArray,i),a.setStrideInBytes(ye.getByteStrideFromBufferFormat(n.format)),a.setArrayInformation([{offset:0,format:n.format}])),a.setSourceTime(n.time),a}t.hasBuffer=function(n){return e.device.hasCachedObject(n)},t.getBuffer=function(n){return n.hash?e.device.getCachedObject(n.hash,r,n):r(n)},t.getBufferForPointArray=function(n,a){var i=jx(n),s={hash:"".concat(n.getMTime(),"I").concat(a.getMTime()).concat(i),usage:gt.PointArray,format:i,dataArray:n,indexBuffer:a};return t.getBuffer(s)},t.getFullScreenQuadBuffer=function(){if(e.fullScreenQuadBuffer)return e.fullScreenQuadBuffer;e.fullScreenQuadBuffer=za.newInstance(),e.fullScreenQuadBuffer.setDevice(e.device);var n=new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,-1,0,1,1,0,-1,1,0]);return e.fullScreenQuadBuffer.createAndWrite(n,GPUBufferUsage.VERTEX),e.fullScreenQuadBuffer.setStrideInBytes(12),e.fullScreenQuadBuffer.setArrayInformation([{offset:0,format:"float32x3"}]),e.fullScreenQuadBuffer}}var Xx={device:null,fullScreenQuadBuffer:null};function Bc(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Xx,r),be(t,e),we(t,e,["device"]),Kx(t,e)}var Yx=ne(Bc),Wt=lo(lo({newInstance:Yx,extend:Bc},zx),_r),Ix=Wt.BufferUsage,Kt=d.vtkErrorMacro;function Qx(t,e){e.classHierarchy.push("vtkWebGPUStorageBuffer"),t.addEntry=function(r,n){if(e._bufferEntryNames.has(r)){Kt("entry named ".concat(r," already exists"));return}e._bufferEntryNames.set(r,e.bufferEntries.length);var a=ye.getByteStrideFromShaderFormat(n);e.bufferEntries.push({name:r,type:n,sizeInBytes:a,offset:e.sizeInBytes,nativeType:ye.getNativeTypeFromShaderFormat(n)}),e.sizeInBytes+=a},t.send=function(r){if(!e._buffer){var n={nativeArray:e.Float32Array,usage:Ix.Storage,label:e.label};e._buffer=r.getBufferManager().getBuffer(n),e.bindGroupTime.modified(),e._sendTime.modified();return}r.getHandle().queue.writeBuffer(e._buffer.getHandle(),0,e.arrayBuffer,0,e.sizeInBytes*e.numberOfInstances),e._sendTime.modified()},t.createView=function(r){r in e||(e.arrayBuffer||(e.arrayBuffer=new ArrayBuffer(e.sizeInBytes*e.numberOfInstances)),e[r]=d.newTypedArray(r,e.arrayBuffer))},t.setValue=function(r,n,a){var i=e._bufferEntryNames.get(r);if(i===void 0){Kt("entry named ".concat(r," not found in UBO"));return}var s=e.bufferEntries[i];t.createView(s.nativeType);var f=e[s.nativeType];f[(s.offset+n*e.sizeInBytes)/f.BYTES_PER_ELEMENT]=a},t.setArray=function(r,n,a){var i=e._bufferEntryNames.get(r);if(i===void 0){Kt("entry named ".concat(r," not found in UBO"));return}var s=e.bufferEntries[i];t.createView(s.nativeType);for(var f=e[s.nativeType],o=(s.offset+n*e.sizeInBytes)/f.BYTES_PER_ELEMENT,u=0;u<a.length;u++)f[o+u]=a[u]},t.setAllInstancesFromArray=function(r,n){var a=e._bufferEntryNames.get(r);if(a===void 0){Kt("entry named ".concat(r," not found in UBO"));return}var i=e.bufferEntries[a];t.createView(i.nativeType);for(var s=e[i.nativeType],f=n.length/e.numberOfInstances,o=0;o<e.numberOfInstances;o++)for(var u=(i.offset+o*e.sizeInBytes)/s.BYTES_PER_ELEMENT,c=0;c<f;c++)s[u+c]=n[o*f+c]},t.setAllInstancesFromArrayColorToFloat=function(r,n){var a=e._bufferEntryNames.get(r);if(a===void 0){Kt("entry named ".concat(r," not found in UBO"));return}var i=e.bufferEntries[a];t.createView(i.nativeType);for(var s=e[i.nativeType],f=n.length/e.numberOfInstances,o=0;o<e.numberOfInstances;o++)for(var u=(i.offset+o*e.sizeInBytes)/s.BYTES_PER_ELEMENT,c=0;c<f;c++)s[u+c]=n[o*f+c]/255},t.setAllInstancesFromArray3x3To4x4=function(r,n){var a=e._bufferEntryNames.get(r);if(a===void 0){Kt("entry named ".concat(r," not found in UBO"));return}var i=e.bufferEntries[a];t.createView(i.nativeType);for(var s=e[i.nativeType],f=9,o=0;o<e.numberOfInstances;o++)for(var u=(i.offset+o*e.sizeInBytes)/s.BYTES_PER_ELEMENT,c=0;c<3;c++)for(var g=0;g<3;g++)s[u+c*4+g]=n[o*f+c*3+g]},t.getSendTime=function(){return e._sendTime.getMTime()},t.getShaderCode=function(r,n){for(var a=["struct ".concat(e.label,`StructEntry
{`)],i=0;i<e.bufferEntries.length;i++){var s=e.bufferEntries[i];a.push("  ".concat(s.name,": ").concat(s.type,","))}return a.push(`
};
struct `.concat(e.label,`Struct
{
  values: array<`).concat(e.label,`StructEntry>,
};
@binding(`).concat(r,") @group(").concat(n,") var<storage, read> ").concat(e.label,": ").concat(e.label,`Struct;
`)),a.join(`
`)},t.getBindGroupEntry=function(){var r={resource:{buffer:e._buffer.getHandle()}};return r},t.clearData=function(){e.numberOfInstances=0,e.sizeInBytes=0,e.bufferEntries=[],e._bufferEntryNames=new Map,e._buffer=null,delete e.arrayBuffer,delete e.Float32Array}}var qx={bufferEntries:null,bufferEntryNames:null,sizeInBytes:0,label:null,numberOfInstances:1};function Uc(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,qx,r),d.obj(t,e),e._bufferEntryNames=new Map,e.bufferEntries=[],e._sendTime={},d.obj(e._sendTime,{mtime:0}),e.bindGroupTime={},d.obj(e.bindGroupTime,{mtime:0}),e.bindGroupLayoutEntry=e.bindGroupLayoutEntry||{buffer:{type:"read-only-storage"}},d.get(t,e,["bindGroupTime"]),d.setGet(t,e,["device","bindGroupLayoutEntry","label","numberOfInstances","sizeInBytes"]),Qx(t,e)}var Zx=d.newInstance(Uc,"vtkWebGPUStorageBuffer"),Jx={newInstance:Zx,extend:Uc},ed=Wt.BufferUsage,xa=d.vtkErrorMacro;function td(t,e){e.classHierarchy.push("vtkWebGPUUniformBuffer"),t.addEntry=function(r,n){if(e._bufferEntryNames.has(r)){xa("entry named ".concat(r," already exists"));return}e.sortDirty=!0,e._bufferEntryNames.set(r,e.bufferEntries.length),e.bufferEntries.push({name:r,type:n,sizeInBytes:ye.getByteStrideFromShaderFormat(n),offset:-1,nativeType:ye.getNativeTypeFromShaderFormat(n),packed:!1})},t.sortBufferEntries=function(){if(!!e.sortDirty){for(var r=0,n=[],a=4,i=0;i<e.bufferEntries.length;i++){var s=e.bufferEntries[i];s.sizeInBytes%16===0&&(a=Math.max(16,a)),s.sizeInBytes%8===0&&(a=Math.max(8,a))}for(var f=0;f<e.bufferEntries.length;f++){var o=e.bufferEntries[f];o.packed===!1&&o.sizeInBytes%16===0&&(o.packed=!0,o.offset=r,n.push(o),r+=o.sizeInBytes)}for(var u=0;u<e.bufferEntries.length;u++){var c=e.bufferEntries[u];if(c.packed===!1&&c.sizeInBytes===12)for(var g=0;g<e.bufferEntries.length;g++){var v=e.bufferEntries[g];if(v.packed===!1&&v.sizeInBytes===4){c.packed=!0,c.offset=r,n.push(c),r+=c.sizeInBytes,v.packed=!0,v.offset=r,n.push(v),r+=v.sizeInBytes;break}}}for(var p=0;p<e.bufferEntries.length;p++){var l=e.bufferEntries[p];if(!l.packed&&l.sizeInBytes%8===0)for(var y=p+1;y<e.bufferEntries.length;y++){var h=e.bufferEntries[y];if(!h.packed&&h.sizeInBytes%8===0){l.packed=!0,l.offset=r,n.push(l),r+=l.sizeInBytes,h.packed=!0,h.offset=r,n.push(h),r+=h.sizeInBytes;break}}}for(var T=0;T<e.bufferEntries.length;T++){var x=e.bufferEntries[T];if(!x.packed&&x.sizeInBytes%8===0)for(var S=!1,O=0;!S&&O<e.bufferEntries.length;O++){var C=e.bufferEntries[O];if(!C.packed&&C.sizeInBytes===4)for(var w=O+1;w<e.bufferEntries.length;w++){var E=e.bufferEntries[w];if(!E.packed&&E.sizeInBytes===4){x.packed=!0,x.offset=r,n.push(x),r+=x.sizeInBytes,C.packed=!0,C.offset=r,n.push(C),r+=C.sizeInBytes,E.packed=!0,E.offset=r,n.push(E),r+=E.sizeInBytes,S=!0;break}}}}for(var M=0;M<e.bufferEntries.length;M++){var L=e.bufferEntries[M];!L.packed&&L.sizeInBytes>4&&(L.packed=!0,L.offset=r,n.push(L),r+=L.sizeInBytes)}for(var b=0;b<e.bufferEntries.length;b++){var D=e.bufferEntries[b];D.packed||(D.packed=!0,D.offset=r,n.push(D),r+=D.sizeInBytes)}e.bufferEntries=n,e._bufferEntryNames.clear();for(var V=0;V<e.bufferEntries.length;V++)e._bufferEntryNames.set(e.bufferEntries[V].name,V);e.sizeInBytes=r,e.sizeInBytes=a*Math.ceil(e.sizeInBytes/a),e.sortDirty=!1}},t.sendIfNeeded=function(r){if(!e.UBO){var n={nativeArray:e.Float32Array,usage:ed.UniformArray,label:e.label};e.UBO=r.getBufferManager().getBuffer(n),e.bindGroupTime.modified(),e.sendDirty=!1}e.sendDirty&&(r.getHandle().queue.writeBuffer(e.UBO.getHandle(),0,e.arrayBuffer,0,e.sizeInBytes),e.sendDirty=!1),e.sendTime.modified()},t.createView=function(r){r in e||(e.arrayBuffer||(e.arrayBuffer=new ArrayBuffer(e.sizeInBytes)),e[r]=d.newTypedArray(r,e.arrayBuffer))},t.setValue=function(r,n){t.sortBufferEntries();var a=e._bufferEntryNames.get(r);if(a===void 0){xa("entry named ".concat(r," not found in UBO"));return}var i=e.bufferEntries[a];t.createView(i.nativeType);var s=e[i.nativeType];i.lastValue!==n&&(s[i.offset/s.BYTES_PER_ELEMENT]=n,e.sendDirty=!0),i.lastValue=n},t.setArray=function(r,n){t.sortBufferEntries();var a=e._bufferEntryNames.get(r);if(a===void 0){xa("entry named ".concat(r," not found in UBO"));return}var i=e.bufferEntries[a];t.createView(i.nativeType);for(var s=e[i.nativeType],f=!1,o=0;o<n.length;o++)(!i.lastValue||i.lastValue[o]!==n[o])&&(s[i.offset/s.BYTES_PER_ELEMENT+o]=n[o],f=!0);f&&(e.sendDirty=!0,i.lastValue=re(n))},t.getBindGroupEntry=function(){var r={resource:{buffer:e.UBO.getHandle()}};return r},t.getSendTime=function(){return e.sendTime.getMTime()},t.getShaderCode=function(r,n){t.sortBufferEntries();for(var a=["struct ".concat(e.label,`Struct
{`)],i=0;i<e.bufferEntries.length;i++){var s=e.bufferEntries[i];a.push("  ".concat(s.name,": ").concat(s.type,","))}return a.push(`};
@binding(`.concat(r,") @group(").concat(n,") var<uniform> ").concat(e.label,": ").concat(e.label,"Struct;")),a.join(`
`)}}var rd={bufferEntries:null,bufferEntryNames:null,sizeInBytes:0,label:null,bindGroupLayoutEntry:null,bindGroupEntry:null};function Nc(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,rd,r),d.obj(t,e),e._bufferEntryNames=new Map,e.bufferEntries=[],e.bindGroupLayoutEntry=e.bindGroupLayoutEntry||{buffer:{type:"uniform"}},e.sendTime={},d.obj(e.sendTime,{mtime:0}),e.bindGroupTime={},d.obj(e.bindGroupTime,{mtime:0}),e.sendDirty=!0,e.sortDirty=!0,d.get(t,e,["binding","bindGroupTime"]),d.setGet(t,e,["bindGroupLayoutEntry","device","label","sizeInBytes"]),td(t,e)}var nd=d.newInstance(Nc,"vtkWebGPUUniformBuffer"),Sr={newInstance:nd,extend:Nc},ad=_t,yo=`
//VTK::Renderer::Dec

//VTK::Mapper::Dec

//VTK::TCoord::Dec

//VTK::RenderEncoder::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output: fragmentOutput;

  var computedColor: vec4<f32> = mapperUBO.BackgroundColor;

  //VTK::RenderEncoder::Impl
  return output;
}
`,id=`
fn vecToRectCoord(dir: vec3<f32>) -> vec2<f32> {
  var tau: f32 = 6.28318530718;
  var pi: f32 = 3.14159265359;
  var out: vec2<f32> = vec2<f32>(0.0);

  out.x = atan2(dir.z, dir.x) / tau;
  out.x += 0.5;

  var phix: f32 = length(vec2(dir.x, dir.z));
  out.y = atan2(dir.y, phix) / pi + 0.5;

  return out;
}

//VTK::Renderer::Dec

//VTK::Mapper::Dec

//VTK::TCoord::Dec

//VTK::RenderEncoder::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output: fragmentOutput;

  var tcoord: vec4<f32> = vec4<f32>(input.vertexVC.xy, -1, 1);
  var V: vec4<f32> = normalize(mapperUBO.FSQMatrix * tcoord); // vec2<f32>((input.tcoordVS.x - 0.5) * 2, -(input.tcoordVS.y - 0.5) * 2);
  // textureSampleLevel gets rid of some ugly artifacts
  var background = textureSampleLevel(EnvironmentTexture, EnvironmentTextureSampler, vecToRectCoord(V.xyz), 0);
  var computedColor: vec4<f32> = vec4<f32>(background.rgb, 1);

  //VTK::RenderEncoder::Impl
  return output;
}
`,un=new Float64Array(16),To=new Float64Array(16);function sd(t){return t.getPositional()?t.getConeAngle()>=90?0:2:1}function od(t,e){e.classHierarchy.push("vtkWebGPURenderer"),t.buildPass=function(r){if(r){if(!e.renderable)return;e.camera=e.renderable.getActiveCamera(),t.updateLights(),t.prepareNodes(),t.addMissingNode(e.camera),t.addMissingNodes(e.renderable.getViewPropsWithNestedProps()),t.removeUnusedNodes(),e.webgpuCamera=t.getViewNodeFor(e.camera),t.updateStabilizedMatrix()}},t.updateStabilizedMatrix=function(){var r=e.camera.getClippingRange(),n=e.camera.getPositionByReference(),a=e.camera.getDirectionOfProjectionByReference(),i=[],s=[];pt(s,a,.5*(r[0]+r[1])),vr(i,n,s),ip(s,i,e.stabilizedCenter);var f=Tf(s);f/(r[1]-r[0])>e.recenterThreshold&&(e.stabilizedCenter=i,e.stabilizedTime.modified())},t.updateLights=function(){for(var r=0,n=e.renderable.getLightsByReference(),a=0;a<n.length;++a)n[a].getSwitch()>0&&r++;return r||(ad("No lights are on, creating one."),e.renderable.createLight()),r},t.updateUBO=function(){var r=e.UBO.getSendTime();if(e._parent.getMTime()>r||t.getMTime()>r||e.camera.getMTime()>r||e.renderable.getMTime()>r){var n,a=e.webgpuCamera.getKeyMatrices(t);e.UBO.setArray("WCVCMatrix",a.wcvc),e.UBO.setArray("SCPCMatrix",a.scpc),e.UBO.setArray("PCSCMatrix",a.pcsc),e.UBO.setArray("SCVCMatrix",a.scvc),e.UBO.setArray("VCPCMatrix",a.vcpc),e.UBO.setArray("WCVCNormals",a.normalMatrix),e.UBO.setValue("LightCount",e.renderable.getLights().length),e.UBO.setValue("MaxEnvironmentMipLevel",(n=e.renderable.getEnvironmentTexture())===null||n===void 0?void 0:n.getMipLevel()),e.UBO.setValue("BackgroundDiffuseStrength",e.renderable.getEnvironmentTextureDiffuseStrength()),e.UBO.setValue("BackgroundSpecularStrength",e.renderable.getEnvironmentTextureSpecularStrength());var i=t.getYInvertedTiledSizeAndOrigin();e.UBO.setArray("viewportSize",[i.usize,i.vsize]),e.UBO.setValue("cameraParallel",e.camera.getParallelProjection());var s=e._parent.getDevice();e.UBO.sendIfNeeded(s)}},t.updateSSBO=function(){for(var r=e.renderable.getLights(),n=e.webgpuCamera.getKeyMatrices(t),a="".concat(e.renderable.getMTime()),i=0;i<r.length;i++)a+=r[i].getMTime();if(a!==e.lightTimeString){for(var s=new Float32Array(r.length*4),f=new Float32Array(r.length*4),o=new Float32Array(r.length*4),u=new Float32Array(r.length*4),c=0;c<r.length;c++){var g=c*4,v=r[c].getPosition();Le(v,v,n.wcvc),s[g]=v[0],s[g+1]=v[1],s[g+2]=v[2],s[g+3]=0,f[g]=-r[c].getDirection()[0],f[g+1]=-r[c].getDirection()[1],f[g+2]=-r[c].getDirection()[2],f[g+3]=0,o[g]=r[c].getColor()[0],o[g+1]=r[c].getColor()[1],o[g+2]=r[c].getColor()[2],o[g+3]=r[c].getIntensity()*5,u[g]=sd(r[c]),u[g+1]=Math.cos(Qt(r[c].getConeAngle())),u[g+2]=Math.cos(Qt(r[c].getConeAngle()+r[c].getConeFalloff())),u[g+3]=0}e.SSBO.clearData(),e.SSBO.setNumberOfInstances(r.length),e.SSBO.addEntry("LightPos","vec4<f32>"),e.SSBO.addEntry("LightDir","vec4<f32>"),e.SSBO.addEntry("LightColor","vec4<f32>"),e.SSBO.addEntry("LightData","vec4<f32>"),e.SSBO.setAllInstancesFromArray("LightPos",s),e.SSBO.setAllInstancesFromArray("LightDir",f),e.SSBO.setAllInstancesFromArray("LightColor",o),e.SSBO.setAllInstancesFromArray("LightData",u);var p=e._parent.getDevice();e.SSBO.send(p)}e.lightTimeString=a},t.scissorAndViewport=function(r){var n=t.getYInvertedTiledSizeAndOrigin();r.getHandle().setViewport(n.lowerLeftU,n.lowerLeftV,n.usize,n.vsize,0,1),r.getHandle().setScissorRect(n.lowerLeftU,n.lowerLeftV,n.usize,n.vsize)},t.bindUBO=function(r){r.activateBindGroup(e.bindGroup)},t.opaquePass=function(r){r?(e.renderEncoder.begin(e._parent.getCommandEncoder()),t.updateUBO(),t.updateSSBO()):(t.scissorAndViewport(e.renderEncoder),t.clear(),e.renderEncoder.end())},t.clear=function(){var r;if(!(e.renderable.getTransparent()||e.suppressClear)){var n=e._parent.getDevice();if(!e.clearFSQ){e.clearFSQ=fo.newInstance(),e.clearFSQ.setDevice(n),e.clearFSQ.setPipelineHash("clearfsq"),e.clearFSQ.setFragmentShaderTemplate(yo);var a=Sr.newInstance({label:"mapperUBO"});a.addEntry("FSQMatrix","mat4x4<f32>"),a.addEntry("BackgroundColor","vec4<f32>"),e.clearFSQ.setUBO(a),e.backgroundTex=e.renderable.getEnvironmentTexture()}if(e.clearFSQ.getPipelineHash()!=="clearfsqwithtexture"&&e.renderable.getUseEnvironmentTextureAsBackground()&&(r=e.backgroundTex)!==null&&r!==void 0&&r.getImageLoaded()){e.clearFSQ.setFragmentShaderTemplate(id);var i=Sr.newInstance({label:"mapperUBO"});i.addEntry("FSQMatrix","mat4x4<f32>"),i.addEntry("BackgroundColor","vec4<f32>"),e.clearFSQ.setUBO(i);var s=n.getTextureManager().getTextureForVTKTexture(e.backgroundTex);if(s.getReady()){var f=s.createView("EnvironmentTexture");e.clearFSQ.setTextureViews([f]),e.backgroundTexLoaded=!0;var o=e.backgroundTex.getInterpolate()?"linear":"nearest";f.addSampler(n,{addressModeU:"repeat",addressModeV:"clamp-to-edge",addressModeW:"repeat",minFilter:o,magFilter:o,mipmapFilter:"linear"})}e.clearFSQ.setPipelineHash("clearfsqwithtexture")}else if(e.clearFSQ.getPipelineHash()==="clearfsqwithtexture"&&!e.renderable.getUseEnvironmentTextureAsBackground()){e.clearFSQ=fo.newInstance(),e.clearFSQ.setDevice(n),e.clearFSQ.setPipelineHash("clearfsq"),e.clearFSQ.setFragmentShaderTemplate(yo);var u=Sr.newInstance({label:"mapperUBO"});u.addEntry("FSQMatrix","mat4x4<f32>"),u.addEntry("BackgroundColor","vec4<f32>"),e.clearFSQ.setUBO(u)}var c=e.webgpuCamera.getKeyMatrices(t),g=e.renderable.getBackgroundByReference();e.clearFSQ.getUBO().setArray("BackgroundColor",g),Se(To,c.normalMatrix),ba(un,c.scvc,c.pcsc),ba(un,To,un),e.clearFSQ.getUBO().setArray("FSQMatrix",un),e.clearFSQ.getUBO().sendIfNeeded(n),e.clearFSQ.prepareAndDraw(e.renderEncoder)}},t.translucentPass=function(r){r?e.renderEncoder.begin(e._parent.getCommandEncoder()):(t.scissorAndViewport(e.renderEncoder),e.renderEncoder.end())},t.volumeDepthRangePass=function(r){r?e.renderEncoder.begin(e._parent.getCommandEncoder()):(t.scissorAndViewport(e.renderEncoder),e.renderEncoder.end())},t.getAspectRatio=function(){var r=e._parent.getSizeByReference(),n=e.renderable.getViewportByReference();return r[0]*(n[2]-n[0])/((n[3]-n[1])*r[1])},t.convertToOpenGLDepth=function(r){return e.webgpuCamera.convertToOpenGLDepth(r)},t.getYInvertedTiledSizeAndOrigin=function(){var r=t.getTiledSizeAndOrigin(),n=e._parent.getSizeByReference();return r.lowerLeftV=n[1]-r.vsize-r.lowerLeftV,r},t.getTiledSizeAndOrigin=function(){var r=e.renderable.getViewportByReference(),n=[0,0,1,1],a=r[0]-n[0],i=r[1]-n[1],s=e._parent.normalizedDisplayToDisplay(a,i),f=Math.round(s[0]),o=Math.round(s[1]),u=r[2]-n[0],c=r[3]-n[1],g=e._parent.normalizedDisplayToDisplay(u,c),v=Math.round(g[0])-f,p=Math.round(g[1])-o;return v<0&&(v=0),p<0&&(p=0),{usize:v,vsize:p,lowerLeftU:f,lowerLeftV:o}},t.getPropFromID=function(r){for(var n=0;n<e.children.length;n++){var a=e.children[n].getPropID?e.children[n].getPropID():-1;if(a===r)return e.children[n]}return null},t.getStabilizedTime=function(){return e.stabilizedTime.getMTime()},t.releaseGraphicsResources=function(){e.selector!==null&&e.selector.releaseGraphicsResources()}}var fd={bindGroup:null,selector:null,renderEncoder:null,recenterThreshold:20,suppressClear:!1,stabilizedCenter:[0,0,0]};function ud(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,fd,r),ie.extend(t,e,r),e.UBO=Sr.newInstance({label:"rendererUBO"}),e.UBO.addEntry("WCVCMatrix","mat4x4<f32>"),e.UBO.addEntry("SCPCMatrix","mat4x4<f32>"),e.UBO.addEntry("PCSCMatrix","mat4x4<f32>"),e.UBO.addEntry("SCVCMatrix","mat4x4<f32>"),e.UBO.addEntry("VCPCMatrix","mat4x4<f32>"),e.UBO.addEntry("WCVCNormals","mat4x4<f32>"),e.UBO.addEntry("viewportSize","vec2<f32>"),e.UBO.addEntry("LightCount","i32"),e.UBO.addEntry("MaxEnvironmentMipLevel","f32"),e.UBO.addEntry("BackgroundDiffuseStrength","f32"),e.UBO.addEntry("BackgroundSpecularStrength","f32"),e.UBO.addEntry("cameraParallel","u32"),e.SSBO=Jx.newInstance({label:"rendererLightSSBO"}),e.lightTimeString="",e.bindGroup=Sc.newInstance({label:"rendererBG"}),e.bindGroup.setBindables([e.UBO,e.SSBO]),e.tmpMat4=ge(new Float64Array(16)),e.stabilizedTime={},be(e.stabilizedTime,{mtime:0}),je(t,e,["bindGroup","stabilizedTime"]),Qa(t,e,["stabilizedCenter"]),we(t,e,["renderEncoder","selector","suppressClear","UBO"]),od(t,e)}var cd=ne(ud,"vtkWebGPURenderer");st("vtkRenderer",cd);var xo=Nr.CoordinateSystem;function gd(t,e){e.classHierarchy.push("vtkWebGPUActor"),t.buildPass=function(r){r&&(e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getFirstAncestorOfType("vtkWebGPURenderWindow"),e.propID===void 0&&(e.propID=e.WebGPURenderWindow.getUniquePropID()),t.prepareNodes(),t.addMissingNode(e.renderable.getMapper()),t.removeUnusedNodes())},t.traverseOpaquePass=function(r){!e.renderable||!e.renderable.getNestedVisibility()||!e.renderable.getIsOpaque()||e.WebGPURenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(r,!0),e.children[0]&&e.children[0].traverse(r),t.apply(r,!1))},t.traverseTranslucentPass=function(r){!e.renderable||!e.renderable.getNestedVisibility()||e.renderable.getIsOpaque()||e.WebGPURenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(r,!0),e.children[0]&&e.children[0].traverse(r),t.apply(r,!1))},t.queryPass=function(r,n){if(r){if(!e.renderable||!e.renderable.getVisibility())return;e.renderable.getIsOpaque()?n.incrementOpaqueActorCount():n.incrementTranslucentActorCount()}},t.getBufferShift=function(r){return t.getKeyMatrices(r),e.bufferShift},t.getKeyMatrices=function(r){if(Math.max(e.renderable.getMTime(),r.getStabilizedTime())>e.keyMatricesTime.getMTime()){e.renderable.computeMatrix();var n=e.renderable.getMatrix();e.bufferShift[0]=n[3],e.bufferShift[1]=n[7],e.bufferShift[2]=n[11];var a=r.getStabilizedCenterByReference();e.renderable.getCoordinateSystem()===xo.WORLD&&(e.bufferShift[0]-=a[0],e.bufferShift[1]-=a[1],e.bufferShift[2]-=a[2]),Se(e.keyMatrices.bcwc,n),e.renderable.getIsIdentity()?ge(e.keyMatrices.normalMatrix):(Qe(e.keyMatrices.normalMatrix,e.keyMatrices.bcwc),e.keyMatrices.normalMatrix[3]=0,e.keyMatrices.normalMatrix[7]=0,e.keyMatrices.normalMatrix[11]=0,At(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix),Se(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix)),at(e.keyMatrices.bcwc,e.keyMatrices.bcwc,[-e.bufferShift[0],-e.bufferShift[1],-e.bufferShift[2]]),e.renderable.getCoordinateSystem()===xo.WORLD?at(e.keyMatrices.bcsc,e.keyMatrices.bcwc,[-a[0],-a[1],-a[2]]):Qe(e.keyMatrices.bcsc,e.keyMatrices.bcwc),e.keyMatricesTime.modified()}return e.keyMatrices}}var vd={keyMatricesTime:null,keyMatrices:null,propID:void 0,bufferShift:void 0};function pd(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,vd,r),ie.extend(t,e,r),e.keyMatricesTime={},d.obj(e.keyMatricesTime,{mtime:0}),e.keyMatrices={normalMatrix:new Float64Array(16),bcwc:new Float64Array(16),bcsc:new Float64Array(16)},d.get(t,e,["propID","keyMatricesTime"]),e.bufferShift=[0,0,0,0],gd(t,e)}var ld=d.newInstance(pd);st("vtkActor",ld);var Oo=Nr.CoordinateSystem;function hd(t,e){e.classHierarchy.push("vtkWebGPUActor2D"),t.buildPass=function(r){r&&(e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getFirstAncestorOfType("vtkWebGPURenderWindow"),e.propID===void 0&&(e.propID=e.WebGPURenderWindow.getUniquePropID()),t.prepareNodes(),t.addMissingNode(e.renderable.getMapper()),t.removeUnusedNodes())},t.traverseOpaquePass=function(r){!e.renderable||!e.renderable.getNestedVisibility()||!e.renderable.getIsOpaque()||e.WebGPURenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(r,!0),e.children[0]&&e.children[0].traverse(r),t.apply(r,!1))},t.traverseTranslucentPass=function(r){!e.renderable||!e.renderable.getNestedVisibility()||e.renderable.getIsOpaque()||e.WebGPURenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(r,!0),e.children[0]&&e.children[0].traverse(r),t.apply(r,!1))},t.queryPass=function(r,n){if(r){if(!e.renderable||!e.renderable.getVisibility())return;e.renderable.getIsOpaque()?n.incrementOpaqueActorCount():n.incrementTranslucentActorCount()}},t.getBufferShift=function(r){return t.getKeyMatrices(r),e.bufferShift},t.getKeyMatrices=function(r){if(Math.max(e.renderable.getMTime(),r.getStabilizedTime())>e.keyMatricesTime.getMTime()){e.bufferShift[0]=0,e.bufferShift[1]=0,e.bufferShift[2]=0;var n=r.getStabilizedCenterByReference();e.renderable.getCoordinateSystem()===Oo.WORLD&&(e.bufferShift[0]-=n[0],e.bufferShift[1]-=n[1],e.bufferShift[2]-=n[2]),ge(e.keyMatrices.bcwc),ge(e.keyMatrices.normalMatrix),at(e.keyMatrices.bcwc,e.keyMatrices.bcwc,[-e.bufferShift[0],-e.bufferShift[1],-e.bufferShift[2]]),e.renderable.getCoordinateSystem()===Oo.WORLD?at(e.keyMatrices.bcsc,e.keyMatrices.bcwc,[-n[0],-n[1],-n[2]]):Qe(e.keyMatrices.bcsc,e.keyMatrices.bcwc),e.keyMatricesTime.modified()}return e.keyMatrices}}var yd={keyMatricesTime:null,keyMatrices:null,propID:void 0,bufferShift:void 0};function Td(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,yd,r),ie.extend(t,e,r),e.keyMatricesTime={},d.obj(e.keyMatricesTime,{mtime:0}),e.keyMatrices={normalMatrix:new Float64Array(16),bcwc:new Float64Array(16),bcsc:new Float64Array(16)},d.get(t,e,["propID","keyMatricesTime"]),e.bufferShift=[0,0,0,0],hd(t,e)}var xd=d.newInstance(Td);st("vtkActor2D",xd);function dd(t,e){e.classHierarchy.push("vtkWebGPUCubeAxesActor"),t.buildPass=function(r){r&&(e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getParent(),e.CubeAxesActorHelper.getRenderable()||e.CubeAxesActorHelper.setRenderable(e.renderable),t.prepareNodes(),t.addMissingNode(e.CubeAxesActorHelper.getTmActor()),t.addMissingNode(e.renderable.getGridActor()),t.removeUnusedNodes())},t.opaquePass=function(r,n){if(r){var a=e.WebGPURenderer?e.WebGPURenderer.getRenderable().getActiveCamera():null,i=e.WebGPURenderer.getTiledSizeAndOrigin();e.CubeAxesActorHelper.updateAPISpecificData([i.usize,i.vsize],a,e.WebGPURenderWindow.getRenderable())}}}var Od={};function Sd(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Od,r),ie.extend(t,e,r),e.CubeAxesActorHelper=Ju.newCubeAxesActorHelper(),dd(t,e)}var Cd=ne(Sd,"vtkWebGPUCubeAxesActor");st("vtkCubeAxesActor",Cd);function So(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function wd(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?So(Object(r),!0).forEach(function(n){K(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):So(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var ja=lc.DisplayLocation;function Ed(t,e){e.classHierarchy.push("vtkProperty2D"),t.setDisplayLocationToBackground=function(){return t.setDisplayLocation(ja.BACKGROUND)},t.setDisplayLocationToForeground=function(){return t.setDisplayLocation(ja.FOREGROUND)},t.setRepresentationToWireframe=function(){return t.setRepresentation(Fe.WIREFRAME)},t.setRepresentationToSurface=function(){return t.setRepresentation(Fe.SURFACE)},t.setRepresentationToPoints=function(){return t.setRepresentation(Fe.POINTS)},t.getRepresentationAsString=function(){return d.enumToString(Fe,e.representation)}}var Md={color:[1,1,1],opacity:1,pointSize:1,lineWidth:1,representation:Fe.SURFACE,displayLocation:ja.FOREGROUND};function Fc(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Md,r),d.obj(t,e),d.setGet(t,e,["opacity","lineWidth","pointSize","displayLocation","representation"]),d.setGetArray(t,e,["color"],3),Ed(t,e)}var Dd=d.newInstance(Fc,"vtkProperty2D"),bd=wd({newInstance:Dd,extend:Fc},lc),pe=Wt.BufferUsage,Ce=Wt.PrimitiveTypes,cn=Fr.Representation,gn=ar.ScalarMode,Ld=Nr.CoordinateSystem,Rd=bd.DisplayLocation,Vd=`
//VTK::Renderer::Dec

//VTK::Color::Dec

//VTK::Normal::Dec

//VTK::TCoord::Dec

//VTK::Select::Dec

//VTK::Mapper::Dec

//VTK::IOStructs::Dec

@vertex
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output : vertexOutput;

  var vertex: vec4<f32> = vertexBC;

  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Select::Impl

  //VTK::Position::Impl

  return output;
}
`,kd=`
struct PBRData {
  diffuse: vec3<f32>,
  specular: vec3<f32>,
}

// Dot product with the max already in it
fn mdot(a: vec3<f32>, b: vec3<f32>) -> f32 {
  return max(0.0, dot(a, b));
}
// Dot product with a max in it that does not allow for negative values
// Physically based rendering is accurate as long as normals are accurate,
// however this is pretty often not the case. In order to prevent negative
// values from ruining light calculations and creating zones of zero light,
// this remapping is used, which smoothly clamps the dot product between
// zero and one while still maintaining a good amount of accuracy.
fn cdot(a: vec3<f32>, b: vec3<f32>) -> f32 {
  var d: f32 = max(0.0, dot(a, b));
  d = pow((d + 1) / 2.0, 2.6);
  return d;
}

// Lambertian diffuse model
fn lambertDiffuse(base: vec3<f32>, N: vec3<f32>, L: vec3<f32>) -> vec3<f32> {
  var pi: f32 = 3.14159265359; 
  var NdotL: f32 = mdot(N, L);
  NdotL = pow(NdotL, 1.5);
  return (base/pi)*NdotL;
}

// Yasuhiro Fujii improvement on the Oren-Nayar model
// https://mimosa-pudica.net/improved-oren-nayar.html
// p is surface color, o is roughness
fn fujiiOrenNayar(p: vec3<f32>, o: f32, N: vec3<f32>, L: vec3<f32>, V: vec3<f32>) -> vec3<f32> {
  var invpi: f32 = 0.31830988618; // 1/pi

  var o2 = o*o;
  var NdotL: f32 = mdot(N, L);
  NdotL = pow(NdotL, 1.5); // Less physically accurate, but hides the "seams" between lights better

  var NdotV: f32 = mdot(N, V);
  var LdotV: f32 = mdot(L, V);

  var s: f32 = LdotV - NdotL*NdotV;
  var t: f32 = mix(1, max(NdotL, NdotV), step(0, s)); // Mix with step is the equivalent of an if statement
  var A: vec3<f32> = 0.5*(o2 / (o2 + 0.33)) + 0.17*p*(o2 / (o2 + 0.13));
  A = invpi*(1 - A);
  var B: f32 = 0.45*(o2 / (o2 + 0.09));
  B = invpi*B;

  return p*NdotL*(A + B*(s/t));
}

// Fresnel portion of BRDF (IOR only, simplified)
fn schlickFresnelIOR(V: vec3<f32>, N: vec3<f32>, ior: f32, k: f32) -> f32 {
  var NdotV: f32 = mdot(V, N);
  var F0: f32 = (pow((ior - 1.0), 2) + k*k) / (pow((ior + 1.0), 2) + k*k); // This takes into account the roughness, which the other one does not
  return F0 + (1 - F0) * pow((1-NdotV), 5); 
}

// Fresnel portion of BRDF (Color ior, better)
fn schlickFresnelRGB(V: vec3<f32>, N: vec3<f32>, F0: vec3<f32>) -> vec3<f32> {
  var NdotV: f32 = mdot(V, N);
  return F0 + (1 - F0) * pow((1-NdotV), 5); 
}

// Normal portion of BRDF
// https://learnopengl.com/PBR/Theory
// Trowbridge-Reitz GGX functions: normal, halfway, roughness^2
fn trGGX(N: vec3<f32>, H: vec3<f32>, a: f32) -> f32 {
  var pi: f32 = 3.14159265359; 

  var a2: f32 = a*a;
  var NdotH = mdot(N, H);
  var NdotH2 = NdotH*NdotH;
  
  var denom: f32 = NdotH2 * (a2 - 1.0) + 1.0;

  return a2 / max((pi*denom*denom), 0.000001);
}

// A VERY bad approximation of anisotropy. Real anisotropic calculations require tangent and bitangent
fn anisotrophicTrGGX(N: vec3<f32>, H: vec3<f32>, O: vec3<f32>, s: f32, a: f32) -> f32 {
  var Op: vec3<f32> = (rendererUBO.WCVCNormals * vec4<f32>(normalize(O) * s, 0.)).xyz;

  var ggx1: f32 = trGGX(N + Op*s, H, a);
  var ggx2: f32 = trGGX(N - Op*s, H, a);
  return (0.5 * ggx1 + 0.5 * ggx2);
}

// Geometry portion of BRDF
fn schlickGGX(N: vec3<f32>, X: vec3<f32>, k: f32) -> f32 {
  var NdotX = cdot(N, X);
  return NdotX / max(0.000001, (NdotX*(1-k) + k));
}

fn smithSurfaceRoughness(N: vec3<f32>, V: vec3<f32>, L: vec3<f32>, k: f32) -> f32 {
  var ggx1: f32 = min(1, schlickGGX(N, V, k));
  var ggx2: f32 = min(1, schlickGGX(N, L, k));
  return ggx1*ggx2;
}

// BRDF Combination
fn cookTorrance(D: f32, F: f32, G: f32, N: vec3<f32>, V: vec3<f32>, L: vec3<f32>) -> f32 {
  var num: f32 = D*F*G;
  var denom: f32 = 4*cdot(V, N)*cdot(L, N);

  return num / max(denom, 0.000001);
}

// Different lighting calculations for different light sources
fn calcDirectionalLight(N: vec3<f32>, V: vec3<f32>, ior: f32, roughness: f32, metallic: f32, direction: vec3<f32>, color: vec3<f32>, base: vec3<f32>) -> PBRData {  
  var L: vec3<f32> = normalize(direction); // Light Vector
  var H: vec3<f32> = normalize(L + V); // Halfway Vector

  var alpha = roughness*roughness;
  var k: f32 = alpha*alpha / 2;

  var D: f32 = trGGX(N, H, alpha); // Distribution
  // var F: f32 = schlickFresnelIOR(V, N, ior, k); // Fresnel
  var G: f32 = smithSurfaceRoughness(N, V, L, k); // Geometry

  var brdf: f32 = cookTorrance(D, 1, G, N, V, L); // Fresnel term is replaced with 1 because it is added later
  var incoming: vec3<f32> = color;
  var angle: f32 = mdot(L, N);
  angle = pow(angle, 1.5);

  var specular: vec3<f32> = brdf*incoming*angle;
  // Oren-Nayar gives a clay-like effect when fully rough which some people may not want, so it might be better to give a separate
  // control property for the diffuse vs specular roughness
  var diffuse: vec3<f32> = incoming*fujiiOrenNayar(base, roughness, N, L, V); 
  // Stores the specular and diffuse separately to allow for finer post processing
  var out = PBRData(diffuse, specular);
  
  return out; // Returns angle along with color of light so the final color can be multiplied by angle as well (creates black areas)
}

// TODO: find some way to reduce the number of arguments going in here
fn calcPointLight(N: vec3<f32>, V: vec3<f32>, fragPos: vec3<f32>, ior: f32, roughness: f32, metallic: f32, position: vec3<f32>, color: vec3<f32>, base: vec3<f32>) -> PBRData {
  var L: vec3<f32> = normalize(position - fragPos); // Light Vector
  var H: vec3<f32> = normalize(L + V); // Halfway Vector
  var dist = distance(position, fragPos);

  var alpha = roughness*roughness;
  var k: f32 = alpha*alpha / 2; // could also be pow(alpha + 1.0, 2) / 8

  var D: f32 = trGGX(N, H, alpha); // Distribution
  // var F: f32 = schlickFresnelIOR(V, N, ior, k); // Fresnel
  var G: f32 = smithSurfaceRoughness(N, V, L, k); // Geometry

  var brdf: f32 = cookTorrance(D, 1, G, N, V, L);  
  var incoming: vec3<f32> = color * (1. / (dist*dist));
  var angle: f32 = mdot(L, N);
  angle = pow(angle, 1.5); // Smoothing factor makes it less accurate, but reduces ugly "seams" bewteen light sources

  var specular: vec3<f32> = brdf*incoming*angle;
  var diffuse: vec3<f32> = incoming*fujiiOrenNayar(base, roughness, N, L, V);

  // Stores the specular and diffuse separately to allow for finer post processing
  // Could also be done (propably more properly) with a struct
  var out = PBRData(diffuse, specular);
  
  return out; // Returns angle along with color of light so the final color can be multiplied by angle as well (creates black areas)
}

// For a reason unknown to me, spheres dont seem to behave propperly with head-on spot lights
fn calcSpotLight(N: vec3<f32>, V: vec3<f32>, fragPos: vec3<f32>, ior: f32, roughness: f32, metallic: f32, position: vec3<f32>, direction: vec3<f32>, cones: vec2<f32>, color: vec3<f32>, base: vec3<f32>) -> PBRData {
  var L: vec3<f32> = normalize(position - fragPos);
  var H: vec3<f32> = normalize(L + V); // Halfway Vector
  var dist = distance(position, fragPos);

  var alpha = roughness*roughness;
  var k: f32 = alpha*alpha / 2; // could also be pow(alpha + 1.0, 2) / 8

  var D: f32 = trGGX(N, H, alpha); // Distribution
  // var F: f32 = schlickFresnelIOR(V, N, ior, k); // Fresnel
  var G: f32 = smithSurfaceRoughness(N, V, L, k); // Geometry

  var brdf: f32 = cookTorrance(D, 1, G, N, V, L);  
  
  // Cones.x is the inner phi and cones.y is the outer phi
  var theta: f32 = mdot(normalize(direction), L);
  var epsilon: f32 = cones.x - cones.y;
  var intensity: f32 = (theta - cones.y) / epsilon;
  intensity = clamp(intensity, 0.0, 1.0);
  intensity /= dist*dist;

  var incoming: vec3<f32> = color * intensity;

  var angle: f32 = mdot(L, N);
  angle = pow(angle, 1.5); // Smoothing factor makes it less accurate, but reduces ugly "seams" bewteen light sources

  var specular: vec3<f32> = brdf*incoming*angle;
  var diffuse: vec3<f32> = incoming*fujiiOrenNayar(base, roughness, N, L, V);

  // Stores the specular and diffuse separately to allow for finer post processing
  // Could also be done (propably more properly) with a struct
  var out = PBRData(diffuse, specular);
  
  return out; // Returns angle along with color of light so the final color can be multiplied by angle as well (creates black areas)
}

// Environment mapping stuff
// Takes in a vector and converts it to an equivalent coordinate in a rectilinear texture. Should be replaced with cubemaps at some point
fn vecToRectCoord(dir: vec3<f32>) -> vec2<f32> {
  var tau: f32 = 6.28318530718;
  var pi: f32 = 3.14159265359;
  var out: vec2<f32> = vec2<f32>(0.0);

  out.x = atan2(dir.z, dir.x) / tau;
  out.x += 0.5;

  var phix: f32 = length(vec2(dir.x, dir.z));
  out.y = atan2(dir.y, phix) / pi + 0.5;

  return out;
}

//VTK::Renderer::Dec

//VTK::Color::Dec

//VTK::TCoord::Dec

// optional surface normal declaration
//VTK::Normal::Dec

//VTK::Select::Dec

//VTK::RenderEncoder::Dec

//VTK::Mapper::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output : fragmentOutput;

  // Temporary ambient, diffuse, and opacity
  var ambientColor: vec4<f32> = mapperUBO.AmbientColor;
  var diffuseColor: vec4<f32> = mapperUBO.DiffuseColor;
  var opacity: f32 = mapperUBO.Opacity;

  // This should be declared somewhere else
  var _diffuseMap: vec4<f32> = vec4<f32>(1);
  var _roughnessMap: vec4<f32> = vec4<f32>(1);
  var _metallicMap: vec4<f32> = vec4<f32>(1);
  var _normalMap: vec4<f32> = vec4<f32>(0, 0, 1, 0); // normal map was setting off the normal vector detection in fragment
  var _ambientOcclusionMap: vec4<f32> = vec4<f32>(1);
  var _emissionMap: vec4<f32> = vec4<f32>(0);

  //VTK::Color::Impl

  //VTK::TCoord::Impl

  //VTK::Normal::Impl

  var computedColor: vec4<f32> = vec4<f32>(diffuseColor.rgb, 1.0);

  //VTK::Light::Impl

  //VTK::Select::Impl

  if (computedColor.a == 0.0) { discard; };

  //VTK::Position::Impl

  //VTK::RenderEncoder::Impl

  return output;
}
`;function Co(t){return t.indexOf("edge")>=0}function Bd(t,e){e.classHierarchy.push("vtkWebGPUCellArrayMapper"),t.buildPass=function(r){r&&(e.is2D?(e.WebGPUActor=t.getFirstAncestorOfType("vtkWebGPUActor2D"),e.forceZValue=!0):(e.WebGPUActor=t.getFirstAncestorOfType("vtkWebGPUActor"),e.forceZValue=!1),e.coordinateSystem=e.WebGPUActor.getRenderable().getCoordinateSystem(),e.useRendererMatrix=e.coordinateSystem!==Ld.DISPLAY,e.WebGPURenderer=e.WebGPUActor.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getParent(),e.device=e.WebGPURenderWindow.getDevice())},t.translucentPass=function(r){r&&(t.prepareToDraw(e.WebGPURenderer.getRenderEncoder()),e.renderEncoder.registerDrawCallback(e.pipeline,t.draw))},t.opaquePass=function(r){r&&(t.prepareToDraw(e.WebGPURenderer.getRenderEncoder()),e.renderEncoder.registerDrawCallback(e.pipeline,t.draw))},t.updateUBO=function(){var r=e.WebGPUActor.getRenderable(),n=r.getProperty(),a=e.UBO.getSendTime();if(t.getMTime()>a||n.getMTime()>a||e.renderable.getMTime()>a){var i,s=e.WebGPUActor.getKeyMatrices(e.WebGPURenderer);if(e.UBO.setArray("BCWCMatrix",s.bcwc),e.UBO.setArray("BCSCMatrix",s.bcsc),e.UBO.setArray("MCWCNormals",s.normalMatrix),e.is2D){e.UBO.setValue("ZValue",e.WebGPUActor.getRenderable().getProperty().getDisplayLocation()===Rd.FOREGROUND?1:0);var f=n.getColorByReference();e.UBO.setValue("AmbientIntensity",1),e.UBO.setArray("DiffuseColor",[f[0],f[1],f[2],1]),e.UBO.setValue("DiffuseIntensity",0),e.UBO.setValue("SpecularIntensity",0)}else{var o=n.getAmbientColorByReference();e.UBO.setValue("AmbientIntensity",n.getAmbient()),e.UBO.setArray("AmbientColor",[o[0],o[1],o[2],1]),e.UBO.setValue("DiffuseIntensity",n.getDiffuse()),o=n.getDiffuseColorByReference(),e.UBO.setArray("DiffuseColor",[o[0],o[1],o[2],1]),e.UBO.setValue("Roughness",n.getRoughness()),e.UBO.setValue("BaseIOR",n.getBaseIOR()),e.UBO.setValue("Metallic",n.getMetallic()),e.UBO.setValue("NormalStrength",n.getNormalStrength()),e.UBO.setValue("Emission",n.getEmission()),e.UBO.setValue("SpecularIntensity",n.getSpecular()),o=n.getSpecularColorByReference(),e.UBO.setArray("SpecularColor",[o[0],o[1],o[2],1])}var u=(i=n.getEdgeColorByReference)===null||i===void 0?void 0:i.call(n);u&&e.UBO.setArray("EdgeColor",[u[0],u[1],u[2],1]),e.UBO.setValue("LineWidth",n.getLineWidth()),e.UBO.setValue("Opacity",n.getOpacity()),e.UBO.setValue("PropID",e.WebGPUActor.getPropID());var c=e.WebGPURenderWindow.getDevice();e.UBO.sendIfNeeded(c)}},t.haveWideLines=function(){var r=e.WebGPUActor.getRenderable(),n=r.getProperty().getRepresentation();return r.getProperty().getLineWidth()<=1||e.primitiveType===Ce.Verts?!1:e.primitiveType===Ce.Triangles||e.primitiveType===Ce.TriangleStrips?n===cn.WIREFRAME:!0},t.replaceShaderPosition=function(r,n,a){var i=n.getShaderDescription("vertex");i.addBuiltinOutput("vec4<f32>","@builtin(position) Position"),i.hasOutput("vertexVC")||i.addOutput("vec4<f32>","vertexVC");var s=i.getCode();e.useRendererMatrix?(s=q.substitute(s,"//VTK::Position::Impl",["    var pCoord: vec4<f32> = rendererUBO.SCPCMatrix*mapperUBO.BCSCMatrix*vertexBC;","    output.vertexVC = rendererUBO.SCVCMatrix * mapperUBO.BCSCMatrix * vec4<f32>(vertexBC.xyz, 1.0);","//VTK::Position::Impl"]).result,e.forceZValue&&(s=q.substitute(s,"//VTK::Position::Impl",["pCoord = vec4<f32>(pCoord.xyz/pCoord.w, 1.0);","pCoord.z = mapperUBO.ZValue;","//VTK::Position::Impl"]).result)):(s=q.substitute(s,"//VTK::Position::Impl",["    var pCoord: vec4<f32> = mapperUBO.BCSCMatrix*vertexBC;","    pCoord.x = 2.0* pCoord.x / rendererUBO.viewportSize.x - 1.0;","    pCoord.y = 2.0* pCoord.y / rendererUBO.viewportSize.y - 1.0;","    pCoord.z = 0.5 - 0.5 * pCoord.z;","//VTK::Position::Impl"]).result,e.forceZValue&&(s=q.substitute(s,"//VTK::Position::Impl",["    pCoord.z = mapperUBO.ZValue;","//VTK::Position::Impl"]).result)),t.haveWideLines()&&(i.addBuiltinInput("u32","@builtin(instance_index) instanceIndex"),s=q.substitute(s,"//VTK::Position::Impl",["    var tmpPos: vec4<f32> = pCoord;","    var numSteps: f32 = ceil(mapperUBO.LineWidth - 1.0);","    var offset: f32 = (mapperUBO.LineWidth - 1.0) * (f32(input.instanceIndex / 2u) - numSteps/2.0) / numSteps;","    var tmpPos2: vec3<f32> = tmpPos.xyz / tmpPos.w;","    tmpPos2.x = tmpPos2.x + 2.0 * (f32(input.instanceIndex) % 2.0) * offset / rendererUBO.viewportSize.x;","    tmpPos2.y = tmpPos2.y + 2.0 * (f32(input.instanceIndex + 1u) % 2.0) * offset / rendererUBO.viewportSize.y;","    tmpPos2.z = min(1.0, tmpPos2.z + 0.00001);","    pCoord = vec4<f32>(tmpPos2.xyz * tmpPos.w, tmpPos.w);","//VTK::Position::Impl"]).result),s=q.substitute(s,"//VTK::Position::Impl",["    output.Position = pCoord;"]).result,i.setCode(s)},e.shaderReplacements.set("replaceShaderPosition",t.replaceShaderPosition),t.replaceShaderNormal=function(r,n,a){var i=a.getBuffer("normalMC"),s=e.WebGPUActor.getRenderable();if(i){var f=n.getShaderDescription("vertex");f.hasOutput("normalVC")||f.addOutput("vec3<f32>","normalVC",i.getArrayInformation()[0].interpolation),f.hasOutput("tangentVC")||f.addOutput("vec3<f32>","tangentVC",i.getArrayInformation()[0].interpolation),f.hasOutput("bitangentVC")||f.addOutput("vec3<f32>","bitangentVC",i.getArrayInformation()[0].interpolation);var o=f.getCode();o=q.substitute(o,"//VTK::Normal::Impl",["  output.normalVC = normalize((rendererUBO.WCVCNormals * mapperUBO.MCWCNormals * normalMC).xyz);","  var c1: vec3<f32> = cross(output.normalVC, vec3<f32>(0, 0, 1));","  var c2: vec3<f32> = cross(output.normalVC, vec3<f32>(0, 1, 0));","  var tangent: vec3<f32> = mix(c1, c2, distance(c1, c2));","  output.tangentVC = normalize(tangent);","  output.bitangentVC = normalize(cross(output.normalVC, tangent));"]).result,f.setCode(o);var u=n.getShaderDescription("fragment");o=u.getCode(),s.getProperty().getNormalTexture()?o=q.substitute(o,"//VTK::Normal::Impl",["  var normal: vec3<f32> = input.normalVC;","  if (!input.frontFacing) { normal = -normal; }","  var tangent: vec3<f32> = input.tangentVC;","  var bitangent: vec3<f32> = input.bitangentVC;","  var TCVCMatrix: mat3x3<f32> = mat3x3<f32>(","    tangent.x, bitangent.x, normal.x,","    tangent.y, bitangent.y, normal.y,","    tangent.z, bitangent.z, normal.z,","  );","  var mappedNormal: vec3<f32> = TCVCMatrix * (_normalMap.xyz * 2 - 1);","  normal = mix(normal, mappedNormal, mapperUBO.NormalStrength);","  normal = normalize(normal);"]).result:o=q.substitute(o,"//VTK::Normal::Impl",["  var normal: vec3<f32> = input.normalVC;","  if (!input.frontFacing) { normal = -normal; }","  normal = normalize(normal);"]).result,u.setCode(o)}},e.shaderReplacements.set("replaceShaderNormal",t.replaceShaderNormal),t.replaceShaderLight=function(r,n,a){if(!r.includes("sel")){var i=n.getShaderDescription("vertex");i.hasOutput("vertexVC")||i.addOutput("vec4<f32>","vertexVC");var s=e.WebGPURenderer.getRenderable(),f=n.getShaderDescription("fragment"),o=f.getCode();if(o.includes("var normal:")&&e.useRendererMatrix&&!Co(r)&&!e.is2D&&!r.includes("sel")){var u,c=["  var pi: f32 = 3.14159265359;","  var fragPos: vec3<f32> = vec3<f32>(input.vertexVC.xyz);","  var V: vec3<f32> = mix(normalize(-fragPos), vec3<f32>(0, 0, 1), f32(rendererUBO.cameraParallel)); // View Vector","  var baseColor: vec3<f32> = _diffuseMap.rgb * diffuseColor.rgb;","  var roughness: f32 = max(0.000001, mapperUBO.Roughness * _roughnessMap.r);","  var metallic: f32 = mapperUBO.Metallic * _metallicMap.r;","  var alpha: f32 = roughness*roughness;","  var ior: f32 = mapperUBO.BaseIOR;","  var k: f32 = alpha*alpha / 2;","  var diffuse: vec3<f32> = vec3<f32>(0.);","  var specular: vec3<f32> = vec3<f32>(0.);","  var emission: vec3<f32> = _emissionMap.rgb * mapperUBO.Emission;","  {","    var i: i32 = 0;","    loop {","      if !(i < rendererUBO.LightCount) { break; }","      switch (i32(rendererLightSSBO.values[i].LightData.x)) {","         // Point Light","         case 0 {","           var color: vec3<f32> = rendererLightSSBO.values[i].LightColor.rgb * rendererLightSSBO.values[i].LightColor.w;","           var pos: vec3<f32> = (rendererLightSSBO.values[i].LightPos).xyz;","           var calculated: PBRData = calcPointLight(normal, V, fragPos, ior, roughness, metallic, pos, color, baseColor);","           diffuse += max(vec3<f32>(0), calculated.diffuse);","           specular += max(vec3<f32>(0), calculated.specular);","          }","         // Directional light","         case 1 {","           var dir: vec3<f32> = (rendererUBO.WCVCNormals * vec4<f32>(normalize(rendererLightSSBO.values[i].LightDir.xyz), 0.)).xyz;","           dir = normalize(dir);","           var color: vec3<f32> = rendererLightSSBO.values[i].LightColor.rgb * rendererLightSSBO.values[i].LightColor.w;","           var calculated: PBRData = calcDirectionalLight(normal, V, ior, roughness, metallic, dir, color, baseColor); // diffuseColor.rgb needs to be fixed with a more dynamic diffuse color","           diffuse += max(vec3<f32>(0), calculated.diffuse);","           specular += max(vec3<f32>(0), calculated.specular);","         }","         // Spot Light","         case 2 {","           var color: vec3<f32> = rendererLightSSBO.values[i].LightColor.rgb * rendererLightSSBO.values[i].LightColor.w;","           var pos: vec3<f32> = (rendererLightSSBO.values[i].LightPos).xyz;","           var dir: vec3<f32> = (rendererUBO.WCVCNormals * vec4<f32>(normalize(rendererLightSSBO.values[i].LightDir.xyz), 0.)).xyz;","           dir = normalize(dir);","           var cones: vec2<f32> = vec2<f32>(rendererLightSSBO.values[i].LightData.y, rendererLightSSBO.values[i].LightData.z);","           var calculated: PBRData = calcSpotLight(normal, V, fragPos, ior, roughness, metallic, pos, dir, cones, color, baseColor);","           diffuse += max(vec3<f32>(0), calculated.diffuse);","           specular += max(vec3<f32>(0), calculated.specular);","         }","         default { continue; }","       }","      continuing { i++; }","    }","  }","  var fresnel: f32 = schlickFresnelIOR(V, normal, ior, k); // Fresnel","  fresnel = min(1, fresnel);","  // This could be controlled with its own variable (that isnt base color) for better artistic control","  var fresnelMetallic: vec3<f32> = schlickFresnelRGB(V, normal, baseColor); // Fresnel for metal, takes color into account","  var kS: vec3<f32> = mix(vec3<f32>(fresnel), fresnelMetallic, metallic);","  kS = min(vec3<f32>(1), kS);","  var kD: vec3<f32> = (1.0 - kS) * (1.0 - metallic);","  var PBR: vec3<f32> = mapperUBO.DiffuseIntensity*kD*diffuse + kS*specular;","  PBR += emission;","  computedColor = vec4<f32>(PBR, mapperUBO.Opacity);"];(u=s.getEnvironmentTexture())!==null&&u!==void 0&&u.getImageLoaded()&&c.push("  // To get diffuse IBL, the texture is sampled with normals in worldspace","  var diffuseIBLCoords: vec3<f32> = (transpose(rendererUBO.WCVCNormals) * vec4<f32>(normal, 1.)).xyz;","  var diffuseCoords: vec2<f32> = vecToRectCoord(diffuseIBLCoords);","  // To get specular IBL, the texture is sampled as the worldspace reflection between the normal and view vectors","  // Reflections are first calculated in viewspace, then converted to worldspace to sample the environment","  var VreflN: vec3<f32> = normalize(reflect(-V, normal));","  var reflectionIBLCoords = (transpose(rendererUBO.WCVCNormals) * vec4<f32>(VreflN, 1.)).xyz;","  var specularCoords: vec2<f32> = vecToRectCoord(reflectionIBLCoords);","  var diffuseIBL = textureSampleLevel(EnvironmentTexture, EnvironmentTextureSampler, diffuseCoords, rendererUBO.MaxEnvironmentMipLevel);","  var level = roughness * rendererUBO.MaxEnvironmentMipLevel;","  var specularIBL = textureSampleLevel(EnvironmentTexture, EnvironmentTextureSampler, specularCoords, level);","  var specularIBLContribution: vec3<f32> = specularIBL.rgb*rendererUBO.BackgroundSpecularStrength;","  computedColor += vec4<f32>(specularIBLContribution*kS, 0);","  var diffuseIBLContribution: vec3<f32> = diffuseIBL.rgb*rendererUBO.BackgroundDiffuseStrength;","  diffuseIBLContribution *= baseColor * _ambientOcclusionMap.rgb;","  computedColor += vec4<f32>(diffuseIBLContribution*kD, 0);"),o=q.substitute(o,"//VTK::Light::Impl",c).result,f.setCode(o)}else o=q.substitute(o,"//VTK::Light::Impl",["  var diffuse: vec3<f32> = diffuseColor.rgb;","  var specular: vec3<f32> = mapperUBO.SpecularColor.rgb * mapperUBO.SpecularColor.a;","  computedColor = vec4<f32>(diffuse * _diffuseMap.rgb, mapperUBO.Opacity);"]).result,f.setCode(o)}},e.shaderReplacements.set("replaceShaderLight",t.replaceShaderLight),t.replaceShaderColor=function(r,n,a){if(Co(r)){var i=n.getShaderDescription("fragment"),s=i.getCode();s=q.substitute(s,"//VTK::Color::Impl",["ambientColor = mapperUBO.EdgeColor;","diffuseColor = mapperUBO.EdgeColor;"]).result,i.setCode(s);return}var f=a.getBuffer("colorVI");if(!!f){var o=n.getShaderDescription("vertex");o.addOutput("vec4<f32>","color",f.getArrayInformation()[0].interpolation);var u=o.getCode();u=q.substitute(u,"//VTK::Color::Impl",["  output.color = colorVI;"]).result,o.setCode(u);var c=n.getShaderDescription("fragment");u=c.getCode(),u=q.substitute(u,"//VTK::Color::Impl",["ambientColor = input.color;","diffuseColor = input.color;","opacity = mapperUBO.Opacity * input.color.a;"]).result,c.setCode(u)}},e.shaderReplacements.set("replaceShaderColor",t.replaceShaderColor),t.replaceShaderTCoord=function(r,n,a){var i,s,f,o,u,c,g,v,p,l,y,h,T,x,S,O,C,w;if(!!a.hasAttribute("tcoord")){var E=n.getShaderDescription("vertex"),M=a.getBuffer("tcoord"),L=ye.getNumberOfComponentsFromBufferFormat(M.getArrayInformation()[0].format),b=E.getCode();E.addOutput("vec".concat(L,"<f32>"),"tcoordVS"),b=q.substitute(b,"//VTK::TCoord::Impl",["  output.tcoordVS = tcoord;"]).result,E.setCode(b);var D=n.getShaderDescription("fragment");b=D.getCode();var V=e.WebGPUActor.getRenderable(),B=function(m){if(!m)return!1;var F=m.getDimensionality();return F===L},R=[];if((i=(s=V.getProperty()).getDiffuseTexture)!==null&&i!==void 0&&(f=i.call(s))!==null&&f!==void 0&&f.getImageLoaded()||V.getTextures()[0]||e.colorTexture){var N,U;(B((N=(U=V.getProperty()).getDiffuseTexture)===null||N===void 0?void 0:N.call(U))||B(V.getTextures()[0])||B(e.colorTexture))&&R.push("_diffuseMap = textureSample(DiffuseTexture, DiffuseTextureSampler, input.tcoordVS);")}(o=(u=V.getProperty()).getRoughnessTexture)!==null&&o!==void 0&&(c=o.call(u))!==null&&c!==void 0&&c.getImageLoaded()&&B(V.getProperty().getRoughnessTexture())&&R.push("_roughnessMap = textureSample(RoughnessTexture, RoughnessTextureSampler, input.tcoordVS);"),(g=(v=V.getProperty()).getMetallicTexture)!==null&&g!==void 0&&(p=g.call(v))!==null&&p!==void 0&&p.getImageLoaded()&&B(V.getProperty().getMetallicTexture())&&R.push("_metallicMap = textureSample(MetallicTexture, MetallicTextureSampler, input.tcoordVS);"),(l=(y=V.getProperty()).getNormalTexture)!==null&&l!==void 0&&(h=l.call(y))!==null&&h!==void 0&&h.getImageLoaded()&&B(V.getProperty().getNormalTexture())&&R.push("_normalMap = textureSample(NormalTexture, NormalTextureSampler, input.tcoordVS);"),(T=(x=V.getProperty()).getAmbientOcclusionTexture)!==null&&T!==void 0&&(S=T.call(x))!==null&&S!==void 0&&S.getImageLoaded()&&B(V.getProperty().getAmbientOcclusionTexture())&&R.push("_ambientOcclusionMap = textureSample(AmbientOcclusionTexture, AmbientOcclusionTextureSampler, input.tcoordVS);"),(O=(C=V.getProperty()).getEmissionTexture)!==null&&O!==void 0&&(w=O.call(C))!==null&&w!==void 0&&w.getImageLoaded()&&B(V.getProperty().getEmissionTexture())&&R.push("_emissionMap = textureSample(EmissionTexture, EmissionTextureSampler, input.tcoordVS);"),b=q.substitute(b,"//VTK::TCoord::Impl",R).result,D.setCode(b)}},e.shaderReplacements.set("replaceShaderTCoord",t.replaceShaderTCoord),t.replaceShaderSelect=function(r,n,a){if(r.includes("sel")){var i=n.getShaderDescription("fragment"),s=i.getCode();s=q.substitute(s,"//VTK::Select::Impl",["  var compositeID: u32 = 0u;"]).result,i.setCode(s)}},e.shaderReplacements.set("replaceShaderSelect",t.replaceShaderSelect),t.getUsage=function(r,n){return r===cn.POINTS||n===Ce.Points?pe.Verts:n===Ce.Lines?pe.Lines:r===cn.WIREFRAME?n===Ce.Triangles?pe.LinesFromTriangles:pe.LinesFromStrips:n===Ce.Triangles?pe.Triangles:n===Ce.TriangleStrips?pe.Strips:n===Ce.TriangleEdges?pe.LinesFromTriangles:pe.LinesFromStrips},t.getHashFromUsage=function(r){return"pt".concat(r)},t.getTopologyFromUsage=function(r){switch(r){case pe.Triangles:return"triangle-list";case pe.Verts:return"point-list";case pe.Lines:default:return"line-list"}},t.buildVertexInput=function(){var r,n,a=e.currentInput,i=e.cellArray,s=e.primitiveType,f=e.WebGPUActor.getRenderable(),o=f.getProperty().getRepresentation(),u=e.WebGPURenderWindow.getDevice(),c=!1;s===Ce.TriangleEdges&&(c=!0,o=cn.WIREFRAME);var g=e.vertexInput,v=a.getPoints(),p;if(i){var l={hash:"R".concat(o,"P").concat(s).concat(i.getMTime()),usage:pe.Index,cells:i,numberOfPoints:v.getNumberOfPoints(),primitiveType:s,representation:o};p=u.getBufferManager().getBuffer(l),g.setIndexBuffer(p)}else g.setIndexBuffer(null);if(v){var y=e.WebGPUActor.getBufferShift(e.WebGPURenderer),h={hash:"".concat(v.getMTime(),"I").concat(p.getMTime()).concat(y.join(),"float32x4"),usage:pe.PointArray,format:"float32x4",dataArray:v,indexBuffer:p,shift:y,packExtra:!0},T=u.getBufferManager().getBuffer(h);g.addBuffer(T,["vertexBC"])}else g.removeBufferIfPresent("vertexBC");var x=t.getUsage(o,s);if(e._usesCellNormals=!1,!e.is2D&&(x===pe.Triangles||x===pe.Strips)){var S=a.getPointData().getNormals(),O={format:"snorm8x4",indexBuffer:p,packExtra:!0,shift:0,scale:127};if(S){O.hash="".concat(S.getMTime(),"I").concat(p.getMTime(),"snorm8x4"),O.dataArray=S,O.usage=pe.PointArray;var C=u.getBufferManager().getBuffer(O);g.addBuffer(C,["normalMC"])}else if(s===Ce.Triangles){e._usesCellNormals=!0,O.hash="PFN".concat(v.getMTime(),"I").concat(p.getMTime(),"snorm8x4"),O.dataArray=v,O.cells=i,O.usage=pe.NormalsFromPoints;var w=u.getBufferManager().getBuffer(O);g.addBuffer(w,["normalMC"])}else g.removeBufferIfPresent("normalMC")}else g.removeBufferIfPresent("normalMC");var E=!1;if(e.renderable.getScalarVisibility()){var M=e.renderable.getColorMapColors();if(M&&!c){var L=e.renderable.getScalarMode(),b=!1;(L===gn.USE_CELL_DATA||L===gn.USE_CELL_FIELD_DATA||L===gn.USE_FIELD_DATA||!a.getPointData().getScalars())&&L!==gn.USE_POINT_FIELD_DATA&&M&&(b=!0);var D={usage:pe.PointArray,format:"unorm8x4",hash:"".concat(b).concat(M.getMTime(),"I").concat(p.getMTime(),"unorm8x4"),dataArray:M,indexBuffer:p,cellData:b,cellOffset:0},V=u.getBufferManager().getBuffer(D);g.addBuffer(V,["colorVI"]),E=!0}}E||g.removeBufferIfPresent("colorVI");var B=null;if((r=(n=e.renderable).getInterpolateScalarsBeforeMapping)!==null&&r!==void 0&&r.call(n)&&e.renderable.getColorCoordinates()?B=e.renderable.getColorCoordinates():B=a.getPointData().getTCoords(),B&&!c){var R=u.getBufferManager().getBufferForPointArray(B,g.getIndexBuffer());g.addBuffer(R,["tcoord"])}else g.removeBufferIfPresent("tcoord")},t.updateTextures=function(){var r,n,a,i,s,f,o,u,c,g,v,p,l,y,h,T=[],x=[],S=(r=(n=e.renderable).getColorTextureMap)===null||r===void 0?void 0:r.call(n);S&&(e.colorTexture||(e.colorTexture=Hn.newInstance({label:"polyDataColor"})),e.colorTexture.setInputData(S),x.push(["Diffuse",e.colorTexture]));var O=e.WebGPUActor.getRenderable(),C=e.WebGPURenderer.getRenderable(),w=[];if((a=(i=O.getProperty()).getDiffuseTexture)!==null&&a!==void 0&&a.call(i)){var E=["Diffuse",O.getProperty().getDiffuseTexture()];w.push(E)}if(O.getTextures()[0]){var M=["Diffuse",O.getTextures()[0]];w.push(M)}if(e.colorTexture){var L=["Diffuse",e.colorTexture];w.push(L)}if((s=(f=O.getProperty()).getRoughnessTexture)!==null&&s!==void 0&&s.call(f)){var b=["Roughness",O.getProperty().getRoughnessTexture()];w.push(b)}if((o=(u=O.getProperty()).getMetallicTexture)!==null&&o!==void 0&&o.call(u)){var D=["Metallic",O.getProperty().getMetallicTexture()];w.push(D)}if((c=(g=O.getProperty()).getNormalTexture)!==null&&c!==void 0&&c.call(g)){var V=["Normal",O.getProperty().getNormalTexture()];w.push(V)}if((v=(p=O.getProperty()).getAmbientOcclusionTexture)!==null&&v!==void 0&&v.call(p)){var B=["AmbientOcclusion",O.getProperty().getAmbientOcclusionTexture()];w.push(B)}if((l=(y=O.getProperty()).getEmissionTexture)!==null&&l!==void 0&&l.call(y)){var R=["Emission",O.getProperty().getEmissionTexture()];w.push(R)}if((h=C.getEnvironmentTexture)!==null&&h!==void 0&&h.call(C)){var N=["Environment",C.getEnvironmentTexture()];w.push(N)}for(var U=0;U<w.length;U++)(w[U][1].getInputData()||w[U][1].getJsImageData()||w[U][1].getCanvas())&&x.push(w[U]),w[U][1].getImage()&&w[U][1].getImageLoaded()&&x.push(w[U]);for(var G=0;G<x.length;G++){var m=x[G][1],F=x[G][0],I=e.device.getTextureManager().getTextureForVTKTexture(m);if(I.getReady()){for(var xe=!1,se=0;se<e.textures.length;se++)e.textures[se]===I&&(xe=!0,T[se]=!0);if(!xe){T[e.textures.length]=!0;var oe=I.createView("".concat(F,"Texture"));e.textures.push(I),e.textureViews.push(oe);var fe=m.getInterpolate()?"linear":"nearest",J=null;!J&&m.getEdgeClamp()&&m.getRepeat()&&(J="mirror-repeat"),!J&&m.getEdgeClamp()&&(J="clamp-to-edge"),!J&&m.getRepeat()&&(J="repeat"),F!=="Environment"?oe.addSampler(e.device,{addressModeU:J,addressModeV:J,addressModeW:J,minFilter:fe,magFilter:fe}):oe.addSampler(e.device,{addressModeU:"repeat",addressModeV:"clamp-to-edge",addressModeW:"repeat",minFilter:fe,magFilter:fe,mipmapFilter:"linear"})}}}for(var de=e.textures.length-1;de>=0;de--)T[de]||(e.textures.splice(de,1),e.textureViews.splice(de,1))},t.computePipelineHash=function(){var r="pd".concat(e.useRendererMatrix?"r":"").concat(e.forceZValue?"z":"");if(e.primitiveType===Ce.TriangleEdges||e.primitiveType===Ce.TriangleStripEdges)r+="edge";else{if(e.vertexInput.hasAttribute("normalMC")&&(r+="n"),e.vertexInput.hasAttribute("colorVI")&&(r+="c"),e.vertexInput.hasAttribute("tcoord")){var n=e.vertexInput.getBuffer("tcoord"),a=ye.getNumberOfComponentsFromBufferFormat(n.getArrayInformation()[0].format);r+="t".concat(a)}e.textures.length&&(r+="tx".concat(e.textures.length))}e._usesCellNormals&&(r+="cn"),e.SSBO&&(r+="ssbo");var i=t.getHashFromUsage(e.usage);r+=i,r+=e.renderEncoder.getPipelineHash(),e.pipelineHash=r},t.updateBuffers=function(){e.primitiveType!==Ce.TriangleEdges&&e.primitiveType!==Ce.TriangleStripEdges&&t.updateTextures();var r=e.WebGPUActor.getRenderable(),n=r.getProperty().getRepresentation();e.usage=t.getUsage(n,e.primitiveType),t.buildVertexInput();var a=e.vertexInput.getBuffer("vertexBC");if(t.setNumberOfVertices(a.getSizeInBytes()/a.getStrideInBytes()),t.setTopology(t.getTopologyFromUsage(e.usage)),t.updateUBO(),t.haveWideLines()){var i=r.getProperty();t.setNumberOfInstances(Math.ceil(i.getLineWidth()*2))}else t.setNumberOfInstances(1)}}var Ud={is2D:!1,cellArray:null,currentInput:null,cellOffset:0,primitiveType:0,colorTexture:null,renderEncoder:null,textures:null};function mc(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Ud,r),Lc.extend(t,e,r),e.fragmentShaderTemplate=kd,e.vertexShaderTemplate=Vd,e._tmpMat3=$t(new Float64Array(9)),e._tmpMat4=ge(new Float64Array(16)),e.UBO=Sr.newInstance({label:"mapperUBO"}),e.UBO.addEntry("BCWCMatrix","mat4x4<f32>"),e.UBO.addEntry("BCSCMatrix","mat4x4<f32>"),e.UBO.addEntry("MCWCNormals","mat4x4<f32>"),e.UBO.addEntry("AmbientColor","vec4<f32>"),e.UBO.addEntry("DiffuseColor","vec4<f32>"),e.UBO.addEntry("EdgeColor","vec4<f32>"),e.UBO.addEntry("SpecularColor","vec4<f32>"),e.UBO.addEntry("AmbientIntensity","f32"),e.UBO.addEntry("DiffuseIntensity","f32"),e.UBO.addEntry("Roughness","f32"),e.UBO.addEntry("Metallic","f32"),e.UBO.addEntry("Ambient","f32"),e.UBO.addEntry("Normal","f32"),e.UBO.addEntry("Emission","f32"),e.UBO.addEntry("NormalStrength","f32"),e.UBO.addEntry("BaseIOR","f32"),e.UBO.addEntry("SpecularIntensity","f32"),e.UBO.addEntry("LineWidth","f32"),e.UBO.addEntry("Opacity","f32"),e.UBO.addEntry("ZValue","f32"),e.UBO.addEntry("PropID","u32"),e.UBO.addEntry("ClipNear","f32"),e.UBO.addEntry("ClipFar","f32"),e.UBO.addEntry("Time","u32"),we(t,e,["cellArray","currentInput","cellOffset","is2D","primitiveType","renderEncoder"]),e.textures=[],Bd(t,e)}var Nd=ne(mc,"vtkWebGPUCellArrayMapper"),Gc={newInstance:Nd,extend:mc},vn=Wt.PrimitiveTypes;function Fd(t,e){e.classHierarchy.push("vtkWebGPUPolyDataMapper"),t.createCellArrayMapper=function(){return Gc.newInstance()},t.buildPass=function(r){if(r){e.WebGPUActor=t.getFirstAncestorOfType("vtkWebGPUActor"),e.renderable.getStatic()||e.renderable.update();var n=e.renderable.getInputData();e.renderable.mapScalars(n,1),t.updateCellArrayMappers(n)}},t.updateCellArrayMappers=function(r){for(var n=[r.getVerts(),r.getLines(),r.getPolys(),r.getStrips()],a=[],i=0,s=vn.Points;s<=vn.Triangles;s++)if(n[s].getNumberOfValues()>0){e.primitives[s]||(e.primitives[s]=t.createCellArrayMapper());var f=e.primitives[s];f.setCellArray(n[s]),f.setCurrentInput(r),f.setCellOffset(i),f.setPrimitiveType(s),f.setRenderable(e.renderable),i+=n[s].getNumberOfCells(),a.push(f)}else e.primitives[s]=null;if(e.WebGPUActor.getRenderable().getProperty().getEdgeVisibility())for(var o=vn.TriangleEdges;o<=vn.TriangleStripEdges;o++)if(n[o-2].getNumberOfValues()>0){e.primitives[o]||(e.primitives[o]=t.createCellArrayMapper());var u=e.primitives[o];u.setCellArray(n[o-2]),u.setCurrentInput(r),u.setCellOffset(e.primitives[o-2].getCellOffset()),u.setPrimitiveType(o),u.setRenderable(e.renderable),a.push(u)}else e.primitives[o]=null;t.prepareNodes(),t.addMissingChildren(a),t.removeUnusedNodes()}}var md={primitives:null};function Gd(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,md,r),ie.extend(t,e,r),e.primitives=[],Fd(t,e)}var _d=ne(Gd,"vtkWebGPUPolyDataMapper");st("vtkMapper",_d);function wo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Ad(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?wo(Object(r),!0).forEach(function(n){K(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):wo(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var Eo=Wt.PrimitiveTypes;function $d(t,e){e.classHierarchy.push("vtkWebGPUPolyDataMapper2D"),t.createCellArrayMapper=function(){return Gc.newInstance()},t.buildPass=function(r){if(r){e.WebGPUActor=t.getFirstAncestorOfType("vtkWebGPUActor2D"),e.renderable.getStatic()||e.renderable.update();var n=e.renderable.getInputData();e.renderable.mapScalars(n,1),t.updateCellArrayMappers(n)}},t.updateCellArrayMappers=function(r){for(var n=[r.getVerts(),r.getLines(),r.getPolys(),r.getStrips()],a=[],i=0,s=Eo.Points;s<=Eo.Triangles;s++)if(n[s].getNumberOfValues()>0){e.primitives[s]||(e.primitives[s]=t.createCellArrayMapper());var f=e.primitives[s];f.setCellArray(n[s]),f.setCurrentInput(r),f.setCellOffset(i),f.setPrimitiveType(s),f.setRenderable(e.renderable),f.setIs2D(!0),i+=n[s].getNumberOfCells(),a.push(f)}else e.primitives[s]=null;t.prepareNodes(),t.addMissingChildren(a),t.removeUnusedNodes()}}function Wd(t){return Ad({primitives:[]},t)}function zd(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Wd(r)),ie.extend(t,e,r),e.primitives=[],$d(t,e)}var jd=ne(zd,"vtkWebGPUPolyDataMapper2D");st("vtkMapper2D",jd);function Hd(t,e){e.classHierarchy.push("vtkWebGPUScalarBarActor"),t.buildPass=function(r){r&&(e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getParent(),e.scalarBarActorHelper.getRenderable()||e.scalarBarActorHelper.setRenderable(e.renderable),t.prepareNodes(),t.addMissingNode(e.scalarBarActorHelper.getBarActor()),t.addMissingNode(e.scalarBarActorHelper.getTmActor()),t.removeUnusedNodes())},t.opaquePass=function(r,n){if(r){var a=e.WebGPURenderer?e.WebGPURenderer.getRenderable().getActiveCamera():null,i=e.WebGPURenderer.getTiledSizeAndOrigin();e.scalarBarActorHelper.updateAPISpecificData([i.usize,i.vsize],a,e.WebGPURenderWindow.getRenderable())}}}var Pd={};function Kd(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Pd,r),ie.extend(t,e,r),e.scalarBarActorHelper=xc.newScalarBarActorHelper(),Hd(t,e)}var Xd=ne(Kd,"vtkWebGPUScalarBarActor");st("vtkScalarBarActor",Xd);function Yd(t,e){e.classHierarchy.push("vtkWebGPUSampler"),t.create=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e.device=r,e.options.addressModeU=n.addressModeU?n.addressModeU:"clamp-to-edge",e.options.addressModeV=n.addressModeV?n.addressModeV:"clamp-to-edge",e.options.addressModeW=n.addressModeW?n.addressModeW:"clamp-to-edge",e.options.magFilter=n.magFilter?n.magFilter:"nearest",e.options.minFilter=n.minFilter?n.minFilter:"nearest",e.options.mipmapFilter=n.mipmapFilter?n.mipmapFilter:"nearest",e.options.label=e.label,e.handle=e.device.getHandle().createSampler(e.options),e.bindGroupTime.modified()},t.getShaderCode=function(r,n){var a="@binding(".concat(r,") @group(").concat(n,") var ").concat(e.label,": sampler;");return a},t.getBindGroupEntry=function(){var r={resource:e.handle};return r}}var Id={device:null,handle:null,label:null,options:null};function _c(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Id,r),d.obj(t,e),e.options={},e.bindGroupLayoutEntry={visibility:GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT,sampler:{}},e.bindGroupTime={},d.obj(e.bindGroupTime,{mtime:0}),d.get(t,e,["bindGroupTime","handle","options"]),d.setGet(t,e,["bindGroupLayoutEntry","device","label"]),Yd(t,e)}var Qd=d.newInstance(_c),qd={newInstance:Qd,extend:_c};function Zd(t,e){e.classHierarchy.push("vtkWebGPUTextureView"),t.create=function(r,n){e.texture=r,e.options=n,e.options.dimension=e.options.dimension||"2d",e.options.label=e.label,e.textureHandle=r.getHandle(),e.handle=e.textureHandle.createView(e.options),e.bindGroupLayoutEntry.texture.viewDimension=e.options.dimension;var a=ye.getDetailsFromTextureFormat(e.texture.getFormat());e.bindGroupLayoutEntry.texture.sampleType=a.sampleType},t.createFromTextureHandle=function(r,n){e.texture=null,e.options=n,e.options.dimension=e.options.dimension||"2d",e.options.label=e.label,e.textureHandle=r,e.handle=e.textureHandle.createView(e.options),e.bindGroupLayoutEntry.texture.viewDimension=e.options.dimension;var a=ye.getDetailsFromTextureFormat(n.format);e.bindGroupLayoutEntry.texture.sampleType=a.sampleType,e.bindGroupTime.modified()},t.getBindGroupEntry=function(){var r={resource:t.getHandle()};return r},t.getShaderCode=function(r,n){var a="f32";e.bindGroupLayoutEntry.texture.sampleType==="sint"?a="i32":e.bindGroupLayoutEntry.texture.sampleType==="uint"&&(a="u32");var i="@binding(".concat(r,") @group(").concat(n,") var ").concat(e.label,": texture_").concat(e.options.dimension,"<").concat(a,">;");return e.bindGroupLayoutEntry.texture.sampleType==="depth"&&(i="@binding(".concat(r,") @group(").concat(n,") var ").concat(e.label,": texture_depth_").concat(e.options.dimension,";")),i},t.addSampler=function(r,n){var a=qd.newInstance({label:"".concat(e.label,"Sampler")});a.create(r,n),t.setSampler(a)},t.getBindGroupTime=function(){return e.texture&&e.texture.getHandle()!==e.textureHandle&&(e.textureHandle=e.texture.getHandle(),e.handle=e.textureHandle.createView(e.options),e.bindGroupTime.modified()),e.bindGroupTime},t.getHandle=function(){return e.texture&&e.texture.getHandle()!==e.textureHandle&&(e.textureHandle=e.texture.getHandle(),e.handle=e.textureHandle.createView(e.options),e.bindGroupTime.modified()),e.handle}}var Jd={texture:null,handle:null,sampler:null,label:null};function Ac(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Jd,r),d.obj(t,e),e.bindGroupLayoutEntry={visibility:GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d"}},e.bindGroupTime={},d.obj(e.bindGroupTime,{mtime:0}),d.get(t,e,["bindGroupTime","texture"]),d.setGet(t,e,["bindGroupLayoutEntry","label","sampler"]),Zd(t,e)}var eO=d.newInstance(Ac),tO={newInstance:eO,extend:Ac},Mo=Wt.BufferUsage;function rO(t,e){e.classHierarchy.push("vtkWebGPUTexture"),t.create=function(r,n){e.device=r,e.width=n.width,e.height=n.height,e.depth=n.depth?n.depth:1;var a=e.depth===1?"2d":"3d";e.format=n.format?n.format:"rgba8unorm",e.mipLevel=n.mipLevel?n.mipLevel:0,e.usage=n.usage?n.usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST,e.handle=e.device.getHandle().createTexture({size:[e.width,e.height,e.depth],format:e.format,usage:e.usage,label:e.label,dimension:a,mipLevelCount:e.mipLevel+1})},t.assignFromHandle=function(r,n,a){e.device=r,e.handle=n,e.width=a.width,e.height=a.height,e.depth=a.depth?a.depth:1,e.format=a.format?a.format:"rgba8unorm",e.usage=a.usage?a.usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST},t.writeImageData=function(r){var n=[];if(r.canvas){e.device.getHandle().queue.copyExternalImageToTexture({source:r.canvas,flipY:r.flip},{texture:e.handle,premultipliedAlpha:!0},[e.width,e.height,e.depth]),e.ready=!0;return}r.jsImageData&&!r.nativeArray&&(r.width=r.jsImageData.width,r.height=r.jsImageData.height,r.depth=1,r.format="rgba8unorm",r.flip=!0,r.nativeArray=r.jsImageData.data);var a=ye.getDetailsFromTextureFormat(e.format),i=e.width*a.stride,s=function(w,E,M){var L=w.length/(E*M)*w.BYTES_PER_ELEMENT,b=a.elementSize===2&&a.sampleType==="float";if(b||L%256){for(var D=w,V=L/D.BYTES_PER_ELEMENT,B=a.elementSize,R=256*Math.floor((V*B+255)/256),N=R/B,U=d.newTypedArray(b?"Uint16Array":D.constructor.name,N*E*M),G=0;G<E*M;G++)if(b)for(var m=0;m<V;m++)U[G*N+m]=bt.toHalf(D[G*V+m]);else U.set(D.subarray(G*V,(G+1)*V),G*N);return[U,R]}return[w,L]};if(r.nativeArray&&(n=r.nativeArray),r.image){var f=document.createElement("canvas");f.width=r.image.width,f.height=r.image.height;var o=f.getContext("2d");o.translate(0,f.height),o.scale(1,-1),o.drawImage(r.image,0,0,r.image.width,r.image.height,0,0,f.width,f.height);var u=o.getImageData(0,0,r.image.width,r.image.height);n=u.data}var c=e.device.createCommandEncoder();if(t.getDimensionality()!==3){for(var g=Hn.generateMipmaps(n,e.width,e.height,e.mipLevel),v=e.width,p=e.height,l=0;l<=e.mipLevel;l++){var y=s(g[l],p,1);i=y[1];var h={dataArray:r.dataArray?r.dataArray:null,nativeArray:y[0],usage:Mo.Texture},T=e.device.getBufferManager().getBuffer(h);c.copyBufferToTexture({buffer:T.getHandle(),offset:0,bytesPerRow:i,rowsPerImage:p},{texture:e.handle,mipLevel:l},[v,p,1]),v/=2,p/=2}e.device.submitCommandEncoder(c),e.ready=!0}else{var x=s(n,e.height,e.depth);i=x[1];var S={dataArray:r.dataArray?r.dataArray:null,usage:Mo.Texture};S.nativeArray=x[0];var O=e.device.getBufferManager().getBuffer(S);c.copyBufferToTexture({buffer:O.getHandle(),offset:0,bytesPerRow:i,rowsPerImage:e.height},{texture:e.handle},[e.width,e.height,e.depth]),e.device.submitCommandEncoder(c),e.ready=!0}},t.getScale=function(){var r=ye.getDetailsFromTextureFormat(e.format),n=r.elementSize===2&&r.sampleType==="float";return n?1:255},t.getNumberOfComponents=function(){var r=ye.getDetailsFromTextureFormat(e.format);return r.numComponents},t.getDimensionality=function(){var r=0;return e.width>1&&r++,e.height>1&&r++,e.depth>1&&r++,r},t.resizeToMatch=function(r){(r.getWidth()!==e.width||r.getHeight()!==e.height||r.getDepth()!==e.depth)&&(e.width=r.getWidth(),e.height=r.getHeight(),e.depth=r.getDepth(),e.handle=e.device.getHandle().createTexture({size:[e.width,e.height,e.depth],format:e.format,usage:e.usage,label:e.label}))},t.resize=function(r,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;(r!==e.width||n!==e.height||a!==e.depth)&&(e.width=r,e.height=n,e.depth=a,e.handle=e.device.getHandle().createTexture({size:[e.width,e.height,e.depth],format:e.format,usage:e.usage,label:e.label}))},t.createView=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};n.dimension||(n.dimension=e.depth===1?"2d":"3d");var a=tO.newInstance({label:r});return a.create(t,n),a}}var nO={device:null,handle:null,buffer:null,ready:!1,label:null};function aO(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,nO,r),d.obj(t,e),d.get(t,e,["handle","ready","width","height","depth","format","usage"]),d.setGet(t,e,["device","label"]),rO(t,e)}d.newInstance(aO);function iO(t,e){e.classHierarchy.push("vtkWebGPUPixelSpaceCallbackMapper"),t.opaquePass=function(r,n){e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getParent();var a=e.WebGPURenderer.getAspectRatio(),i=e.WebGPURenderer?e.WebGPURenderer.getRenderable().getActiveCamera():null,s=e.WebGPURenderer.getTiledSizeAndOrigin(),f=null;e.renderable.getUseZValues(),e.renderable.invokeCallback(e.renderable.getInputData(),i,a,s,f)}}var sO={};function oO(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,sO,r),ie.extend(t,e,r),iO(t,e)}var fO=d.newInstance(oO,"vtkWebGPUPixelSpaceCallbackMapper");st("vtkPixelSpaceCallbackMapper",fO);var Re=Uint8Array,Bt=Uint16Array,$c=Uint32Array,Wc=new Re([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),zc=new Re([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),uO=new Re([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),jc=function(t,e){for(var r=new Bt(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var a=new $c(r[30]),n=1;n<30;++n)for(var i=r[n];i<r[n+1];++i)a[i]=i-r[n]<<5|n;return[r,a]},Hc=jc(Wc,2),Pc=Hc[0],cO=Hc[1];Pc[28]=258,cO[258]=28;var gO=jc(zc,0),vO=gO[0],Ha=new Bt(32768);for(var ee=0;ee<32768;++ee){var vt=(ee&43690)>>>1|(ee&21845)<<1;vt=(vt&52428)>>>2|(vt&13107)<<2,vt=(vt&61680)>>>4|(vt&3855)<<4,Ha[ee]=((vt&65280)>>>8|(vt&255)<<8)>>>1}var Cr=function(t,e,r){for(var n=t.length,a=0,i=new Bt(e);a<n;++a)t[a]&&++i[t[a]-1];var s=new Bt(e);for(a=0;a<e;++a)s[a]=s[a-1]+i[a-1]<<1;var f;if(r){f=new Bt(1<<e);var o=15-e;for(a=0;a<n;++a)if(t[a])for(var u=a<<4|t[a],c=e-t[a],g=s[t[a]-1]++<<c,v=g|(1<<c)-1;g<=v;++g)f[Ha[g]>>>o]=u}else for(f=new Bt(n),a=0;a<n;++a)t[a]&&(f[a]=Ha[s[t[a]-1]++]>>>15-t[a]);return f},Ar=new Re(288);for(var ee=0;ee<144;++ee)Ar[ee]=8;for(var ee=144;ee<256;++ee)Ar[ee]=9;for(var ee=256;ee<280;++ee)Ar[ee]=7;for(var ee=280;ee<288;++ee)Ar[ee]=8;var Kc=new Re(32);for(var ee=0;ee<32;++ee)Kc[ee]=5;var pO=Cr(Ar,9,1),lO=Cr(Kc,5,1),da=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},me=function(t,e,r){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(e&7)&r},Oa=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},hO=function(t){return(t+7)/8|0},Xc=function(t,e,r){(e==null||e<0)&&(e=0),(r==null||r>t.length)&&(r=t.length);var n=new(t.BYTES_PER_ELEMENT==2?Bt:t.BYTES_PER_ELEMENT==4?$c:Re)(r-e);return n.set(t.subarray(e,r)),n},yO=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Ue=function(t,e,r){var n=new Error(e||yO[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,Ue),!r)throw n;return n},Mi=function(t,e,r){var n=t.length;if(!n||r&&r.f&&!r.l)return e||new Re(0);var a=!e||r,i=!r||r.i;r||(r={}),e||(e=new Re(n*3));var s=function(de){var qe=e.length;if(de>qe){var xt=new Re(Math.max(qe*2,de));xt.set(e),e=xt}},f=r.f||0,o=r.p||0,u=r.b||0,c=r.l,g=r.d,v=r.m,p=r.n,l=n*8;do{if(!c){f=me(t,o,1);var y=me(t,o+1,3);if(o+=3,y)if(y==1)c=pO,g=lO,v=9,p=5;else if(y==2){var S=me(t,o,31)+257,O=me(t,o+10,15)+4,C=S+me(t,o+5,31)+1;o+=14;for(var w=new Re(C),E=new Re(19),M=0;M<O;++M)E[uO[M]]=me(t,o+M*3,7);o+=O*3;for(var L=da(E),b=(1<<L)-1,D=Cr(E,L,1),M=0;M<C;){var V=D[me(t,o,b)];o+=V&15;var h=V>>>4;if(h<16)w[M++]=h;else{var B=0,R=0;for(h==16?(R=3+me(t,o,3),o+=2,B=w[M-1]):h==17?(R=3+me(t,o,7),o+=3):h==18&&(R=11+me(t,o,127),o+=7);R--;)w[M++]=B}}var N=w.subarray(0,S),U=w.subarray(S);v=da(N),p=da(U),c=Cr(N,v,1),g=Cr(U,p,1)}else Ue(1);else{var h=hO(o)+4,T=t[h-4]|t[h-3]<<8,x=h+T;if(x>n){i&&Ue(0);break}a&&s(u+T),e.set(t.subarray(h,x),u),r.b=u+=T,r.p=o=x*8,r.f=f;continue}if(o>l){i&&Ue(0);break}}a&&s(u+131072);for(var G=(1<<v)-1,m=(1<<p)-1,F=o;;F=o){var B=c[Oa(t,o)&G],I=B>>>4;if(o+=B&15,o>l){i&&Ue(0);break}if(B||Ue(2),I<256)e[u++]=I;else if(I==256){F=o,c=null;break}else{var xe=I-254;if(I>264){var M=I-257,se=Wc[M];xe=me(t,o,(1<<se)-1)+Pc[M],o+=se}var oe=g[Oa(t,o)&m],fe=oe>>>4;oe||Ue(3),o+=oe&15;var U=vO[fe];if(fe>3){var se=zc[fe];U+=Oa(t,o)&(1<<se)-1,o+=se}if(o>l){i&&Ue(0);break}a&&s(u+131072);for(var J=u+xe;u<J;u+=4)e[u]=e[u-U],e[u+1]=e[u+1-U],e[u+2]=e[u+2-U],e[u+3]=e[u+3-U];u=J}}r.l=c,r.p=F,r.b=u,r.f=f,c&&(f=1,r.m=v,r.d=g,r.n=p)}while(!f);return u==e.length?e:Xc(e,0,u)},TO=new Re(0),xO=function(t){(t[0]!=31||t[1]!=139||t[2]!=8)&&Ue(6,"invalid gzip data");var e=t[3],r=10;e&4&&(r+=t[10]|(t[11]<<8)+2);for(var n=(e>>3&1)+(e>>4&1);n>0;n-=!t[r++]);return r+(e&2)},dO=function(t){var e=t.length;return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0},OO=function(t){((t[0]&15)!=8||t[0]>>>4>7||(t[0]<<8|t[1])%31)&&Ue(6,"invalid zlib data"),t[1]&32&&Ue(6,"invalid zlib data: preset dictionaries not supported")};function SO(t,e){return Mi(t,e)}function CO(t,e){return Mi(t.subarray(xO(t),-8),e||new Re(dO(t)))}function wO(t,e){return Mi((OO(t),t.subarray(2,-4)),e)}function Rr(t,e){return t[0]==31&&t[1]==139&&t[2]==8?CO(t,e):(t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31?SO(t,e):wO(t,e)}var Pa=typeof TextDecoder!="undefined"&&new TextDecoder,EO=0;try{Pa.decode(TO,{stream:!0}),EO=1}catch{}var MO=function(t){for(var e="",r=0;;){var n=t[r++],a=(n>127)+(n>223)+(n>239);if(r+a>t.length)return[e,Xc(t,r-1)];a?a==3?(n=((n&15)<<18|(t[r++]&63)<<12|(t[r++]&63)<<6|t[r++]&63)-65536,e+=String.fromCharCode(55296|n>>10,56320|n&1023)):a&1?e+=String.fromCharCode((n&31)<<6|t[r++]&63):e+=String.fromCharCode((n&15)<<12|(t[r++]&63)<<6|t[r++]&63):e+=String.fromCharCode(n)}};function Di(t,e){if(e){for(var r="",n=0;n<t.length;n+=16384)r+=String.fromCharCode.apply(null,t.subarray(n,n+16384));return r}else{if(Pa)return Pa.decode(t);var a=MO(t),i=a[0],s=a[1];return s.length&&Ue(8),i}}function Yc(){var t=new ArrayBuffer(4),e=new Uint8Array(t),r=new Uint32Array(t);return e[0]=161,e[1]=178,e[2]=195,e[3]=212,r[0]===3569595041?"LittleEndian":r[0]===2712847316?"BigEndian":null}var DO=Yc();function bO(t,e){if(!(e<2))for(var r=new Int8Array(t),n=r.length,a=[],i=0;i<n;i+=e){for(var s=0;s<e;s++)a.push(r[i+s]);for(var f=0;f<e;f++)r[i+f]=a.pop()}}var Sa={ENDIANNESS:DO,getEndianness:Yc,swapBytes:bO},Vr=d.vtkErrorMacro,LO=d.vtkDebugMacro,ir=0;function Kn(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=new XMLHttpRequest;return n.open(t,e,!0),r.headers&&Object.entries(r.headers).forEach(function(a){var i=Ye(a,2),s=i[0],f=i[1];return n.setRequestHeader(s,f)}),r.progressCallback&&n.addEventListener("progress",r.progressCallback),n}function RO(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return e&&e.compression&&e.compression!=="gz"&&(Vr("Supported algorithms are: [gz]"),Vr("Unkown compression algorithm: ".concat(e.compression))),new Promise(function(r,n){var a=Kn("GET",t,e);a.onreadystatechange=function(i){a.readyState===4&&(a.status===200||a.status===0?e.compression?r(Rr(new Uint8Array(a.response)).buffer):r(a.response):n({xhr:a,e:i}))},a.responseType="arraybuffer",a.send()})}function VO(t,e,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return r.ref&&!r.ref.pending?new Promise(function(a,i){var s=null;r.ref.url?s=r.ref.url:s=[e,r.ref.basepath,n.compression?"".concat(r.ref.id,".gz"):r.ref.id].join("/");var f=Kn("GET",s,n);f.onreadystatechange=function(o){f.readyState===1&&(r.ref.pending=!0,++ir===1&&t!==null&&t!==void 0&&t.invokeBusy&&t.invokeBusy(!0)),f.readyState===4&&(r.ref.pending=!1,f.status===200||f.status===0?(r.buffer=f.response,n.compression&&(r.dataType==="string"||r.dataType==="JSON"?r.buffer=Di(Rr(new Uint8Array(r.buffer))):r.buffer=Rr(new Uint8Array(r.buffer)).buffer),r.ref.encode==="JSON"?r.values=JSON.parse(r.buffer):(Sa.ENDIANNESS!==r.ref.encode&&Sa.ENDIANNESS&&(LO("Swap bytes of ".concat(r.name)),Sa.swapBytes(r.buffer,du[r.dataType])),r.values=d.newTypedArray(r.dataType,r.buffer)),r.values.length!==r.size&&Vr("Error in FetchArray: ".concat(r.name,", does not have the proper array size. Got ").concat(r.values.length,", instead of ").concat(r.size)),delete r.ref,--ir===0&&t!==null&&t!==void 0&&t.invokeBusy&&t.invokeBusy(!1),t!=null&&t.modified&&t.modified(),a(r)):i({xhr:f,e:o}))},f.responseType=n.compression||r.dataType!=="string"?"arraybuffer":"text",f.send()}):Promise.resolve(r)}function kO(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return new Promise(function(n,a){var i=Kn("GET",e,r);i.onreadystatechange=function(s){i.readyState===1&&++ir===1&&t!==null&&t!==void 0&&t.invokeBusy&&t.invokeBusy(!0),i.readyState===4&&(--ir===0&&t!==null&&t!==void 0&&t.invokeBusy&&t.invokeBusy(!1),i.status===200||i.status===0?r.compression?n(JSON.parse(Di(Rr(new Uint8Array(i.response))))):n(JSON.parse(i.responseText)):a({xhr:i,e:s}))},i.responseType=r.compression?"arraybuffer":"text",i.send()})}function BO(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return r&&r.compression&&r.compression!=="gz"&&(Vr("Supported algorithms are: [gz]"),Vr("Unkown compression algorithm: ".concat(r.compression))),new Promise(function(n,a){var i=Kn("GET",e,r);i.onreadystatechange=function(s){i.readyState===1&&++ir===1&&t!==null&&t!==void 0&&t.invokeBusy&&t.invokeBusy(!0),i.readyState===4&&(--ir===0&&t!==null&&t!==void 0&&t.invokeBusy&&t.invokeBusy(!1),i.status===200||i.status===0?r.compression?n(Di(Rr(new Uint8Array(i.response)))):n(i.responseText):a({xhr:i,e:s}))},i.responseType=r.compression?"arraybuffer":"text",i.send()})}function UO(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return new Promise(function(n,a){var i=new Image;r.crossOrigin&&(i.crossOrigin=r.crossOrigin),i.onload=function(){return n(i)},i.onerror=a,i.src=e})}var KO={fetchArray:VO,fetchJSON:kO,fetchText:BO,fetchBinary:RO,fetchImage:UO};const NO="_button_1f1mz_1",FO="_rootController_1f1mz_10",mO="_control_1f1mz_20",GO="_fullScreen_1f1mz_27",_O="_fullParentSize_1f1mz_42",AO="_bigFileDrop_1f1mz_51",$O="_selector_1f1mz_67",WO="_progress_1f1mz_87",zO="_dark_1f1mz_98 _selector_1f1mz_67",jO="_light_1f1mz_107 _selector_1f1mz_67",HO="_fpsMonitor_1f1mz_116";var XO={button:NO,rootController:FO,control:mO,fullScreen:GO,fullParentSize:_O,bigFileDrop:AO,selector:$O,progress:WO,dark:zO,light:jO,fpsMonitor:HO};export{KO as H,Xv as d,mv as f,XO as s};
//# sourceMappingURL=geometryViewer.module.a6d7605a.js.map
