import{V as C,C as k,i as J,F as Y,G as X,j as B,k as M,l as A,m as G,n as V,o as U,p as R,q as I,M as O,r as ee,s as te,R as z,t as T,u as se,T as Z,v as S,W as ne,e as ie,O as re,d as oe,N as ae,P as le,D as ce,H as he,w as ue}from"./OrbitControls.4135e4a5.js";import{d as de,r as D,n as pe,o as $,c as K,e as fe,_ as Q,b as me,a as E,w as ge}from"./app.28a7effe.js";const be=/^[og]\s*(.+)?/,ve=/^mtllib /,we=/^usemtl /,ye=/^usemap /,H=/\s+/,W=new C,P=new C,q=new C,N=new C,y=new C,F=new k;function _e(){const j={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(e,s){if(this.object&&this.object.fromDeclaration===!1){this.object.name=e,this.object.fromDeclaration=s!==!1;return}const i=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:s!==!1,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(t,n){const c=this._finalize(!1);c&&(c.inherited||c.groupCount<=0)&&this.materials.splice(c.index,1);const a={index:this.materials.length,name:t||"",mtllib:Array.isArray(n)&&n.length>0?n[n.length-1]:"",smooth:c!==void 0?c.smooth:this.smooth,groupStart:c!==void 0?c.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(o){const r={index:typeof o=="number"?o:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return r.clone=this.clone.bind(r),r}};return this.materials.push(a),a},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(t){const n=this.currentMaterial();if(n&&n.groupEnd===-1&&(n.groupEnd=this.geometry.vertices.length/3,n.groupCount=n.groupEnd-n.groupStart,n.inherited=!1),t&&this.materials.length>1)for(let c=this.materials.length-1;c>=0;c--)this.materials[c].groupCount<=0&&this.materials.splice(c,1);return t&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),n}},i&&i.name&&typeof i.clone=="function"){const t=i.clone(0);t.inherited=!0,this.object.materials.push(t)}this.objects.push(this.object)},finalize:function(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)},parseVertexIndex:function(e,s){const i=parseInt(e,10);return(i>=0?i-1:i+s/3)*3},parseNormalIndex:function(e,s){const i=parseInt(e,10);return(i>=0?i-1:i+s/3)*3},parseUVIndex:function(e,s){const i=parseInt(e,10);return(i>=0?i-1:i+s/2)*2},addVertex:function(e,s,i){const t=this.vertices,n=this.object.geometry.vertices;n.push(t[e+0],t[e+1],t[e+2]),n.push(t[s+0],t[s+1],t[s+2]),n.push(t[i+0],t[i+1],t[i+2])},addVertexPoint:function(e){const s=this.vertices;this.object.geometry.vertices.push(s[e+0],s[e+1],s[e+2])},addVertexLine:function(e){const s=this.vertices;this.object.geometry.vertices.push(s[e+0],s[e+1],s[e+2])},addNormal:function(e,s,i){const t=this.normals,n=this.object.geometry.normals;n.push(t[e+0],t[e+1],t[e+2]),n.push(t[s+0],t[s+1],t[s+2]),n.push(t[i+0],t[i+1],t[i+2])},addFaceNormal:function(e,s,i){const t=this.vertices,n=this.object.geometry.normals;W.fromArray(t,e),P.fromArray(t,s),q.fromArray(t,i),y.subVectors(q,P),N.subVectors(W,P),y.cross(N),y.normalize(),n.push(y.x,y.y,y.z),n.push(y.x,y.y,y.z),n.push(y.x,y.y,y.z)},addColor:function(e,s,i){const t=this.colors,n=this.object.geometry.colors;t[e]!==void 0&&n.push(t[e+0],t[e+1],t[e+2]),t[s]!==void 0&&n.push(t[s+0],t[s+1],t[s+2]),t[i]!==void 0&&n.push(t[i+0],t[i+1],t[i+2])},addUV:function(e,s,i){const t=this.uvs,n=this.object.geometry.uvs;n.push(t[e+0],t[e+1]),n.push(t[s+0],t[s+1]),n.push(t[i+0],t[i+1])},addDefaultUV:function(){const e=this.object.geometry.uvs;e.push(0,0),e.push(0,0),e.push(0,0)},addUVLine:function(e){const s=this.uvs;this.object.geometry.uvs.push(s[e+0],s[e+1])},addFace:function(e,s,i,t,n,c,a,o,r){const h=this.vertices.length;let l=this.parseVertexIndex(e,h),u=this.parseVertexIndex(s,h),m=this.parseVertexIndex(i,h);if(this.addVertex(l,u,m),this.addColor(l,u,m),a!==void 0&&a!==""){const b=this.normals.length;l=this.parseNormalIndex(a,b),u=this.parseNormalIndex(o,b),m=this.parseNormalIndex(r,b),this.addNormal(l,u,m)}else this.addFaceNormal(l,u,m);if(t!==void 0&&t!==""){const b=this.uvs.length;l=this.parseUVIndex(t,b),u=this.parseUVIndex(n,b),m=this.parseUVIndex(c,b),this.addUV(l,u,m),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(e){this.object.geometry.type="Points";const s=this.vertices.length;for(let i=0,t=e.length;i<t;i++){const n=this.parseVertexIndex(e[i],s);this.addVertexPoint(n),this.addColor(n)}},addLineGeometry:function(e,s){this.object.geometry.type="Line";const i=this.vertices.length,t=this.uvs.length;for(let n=0,c=e.length;n<c;n++)this.addVertexLine(this.parseVertexIndex(e[n],i));for(let n=0,c=s.length;n<c;n++)this.addUVLine(this.parseUVIndex(s[n],t))}};return j.startObject("",!1),j}class xe extends J{constructor(e){super(e),this.materials=null}load(e,s,i,t){const n=this,c=new Y(this.manager);c.setPath(this.path),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials),c.load(e,function(a){try{s(n.parse(a))}catch(o){t?t(o):console.error(o),n.manager.itemError(e)}},i,t)}setMaterials(e){return this.materials=e,this}parse(e){const s=new _e;e.indexOf(`\r
`)!==-1&&(e=e.replace(/\r\n/g,`
`)),e.indexOf(`\\
`)!==-1&&(e=e.replace(/\\\n/g,""));const i=e.split(`
`);let t=[];for(let a=0,o=i.length;a<o;a++){const r=i[a].trimStart();if(r.length===0)continue;const h=r.charAt(0);if(h!=="#")if(h==="v"){const l=r.split(H);switch(l[0]){case"v":s.vertices.push(parseFloat(l[1]),parseFloat(l[2]),parseFloat(l[3])),l.length>=7?(F.setRGB(parseFloat(l[4]),parseFloat(l[5]),parseFloat(l[6])).convertSRGBToLinear(),s.colors.push(F.r,F.g,F.b)):s.colors.push(void 0,void 0,void 0);break;case"vn":s.normals.push(parseFloat(l[1]),parseFloat(l[2]),parseFloat(l[3]));break;case"vt":s.uvs.push(parseFloat(l[1]),parseFloat(l[2]));break}}else if(h==="f"){const u=r.slice(1).trim().split(H),m=[];for(let p=0,f=u.length;p<f;p++){const d=u[p];if(d.length>0){const g=d.split("/");m.push(g)}}const b=m[0];for(let p=1,f=m.length-1;p<f;p++){const d=m[p],g=m[p+1];s.addFace(b[0],d[0],g[0],b[1],d[1],g[1],b[2],d[2],g[2])}}else if(h==="l"){const l=r.substring(1).trim().split(" ");let u=[];const m=[];if(r.indexOf("/")===-1)u=l;else for(let b=0,p=l.length;b<p;b++){const f=l[b].split("/");f[0]!==""&&u.push(f[0]),f[1]!==""&&m.push(f[1])}s.addLineGeometry(u,m)}else if(h==="p"){const u=r.slice(1).trim().split(" ");s.addPointGeometry(u)}else if((t=be.exec(r))!==null){const l=(" "+t[0].slice(1).trim()).slice(1);s.startObject(l)}else if(we.test(r))s.object.startMaterial(r.substring(7).trim(),s.materialLibraries);else if(ve.test(r))s.materialLibraries.push(r.substring(7).trim());else if(ye.test(r))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if(h==="s"){if(t=r.split(" "),t.length>1){const u=t[1].trim().toLowerCase();s.object.smooth=u!=="0"&&u!=="off"}else s.object.smooth=!0;const l=s.object.currentMaterial();l&&(l.smooth=s.object.smooth)}else{if(r==="\0")continue;console.warn('THREE.OBJLoader: Unexpected line: "'+r+'"')}}s.finalize();const n=new X;if(n.materialLibraries=[].concat(s.materialLibraries),!(s.objects.length===1&&s.objects[0].geometry.vertices.length===0)===!0)for(let a=0,o=s.objects.length;a<o;a++){const r=s.objects[a],h=r.geometry,l=r.materials,u=h.type==="Line",m=h.type==="Points";let b=!1;if(h.vertices.length===0)continue;const p=new B;p.setAttribute("position",new M(h.vertices,3)),h.normals.length>0&&p.setAttribute("normal",new M(h.normals,3)),h.colors.length>0&&(b=!0,p.setAttribute("color",new M(h.colors,3))),h.hasUVIndices===!0&&p.setAttribute("uv",new M(h.uvs,2));const f=[];for(let g=0,_=l.length;g<_;g++){const w=l[g],x=w.name+"_"+w.smooth+"_"+b;let v=s.materials[x];if(this.materials!==null){if(v=this.materials.create(w.name),u&&v&&!(v instanceof A)){const L=new A;G.prototype.copy.call(L,v),L.color.copy(v.color),v=L}else if(m&&v&&!(v instanceof V)){const L=new V({size:10,sizeAttenuation:!1});G.prototype.copy.call(L,v),L.color.copy(v.color),L.map=v.map,v=L}}v===void 0&&(u?v=new A:m?v=new V({size:1,sizeAttenuation:!1}):v=new U,v.name=w.name,v.flatShading=!w.smooth,v.vertexColors=b,s.materials[x]=v),f.push(v)}let d;if(f.length>1){for(let g=0,_=l.length;g<_;g++){const w=l[g];p.addGroup(w.groupStart,w.groupCount,g)}u?d=new R(p,f):m?d=new I(p,f):d=new O(p,f)}else u?d=new R(p,f[0]):m?d=new I(p,f[0]):d=new O(p,f[0]);d.name=r.name,n.add(d)}else if(s.vertices.length>0){const a=new V({size:1,sizeAttenuation:!1}),o=new B;o.setAttribute("position",new M(s.vertices,3)),s.colors.length>0&&s.colors[0]!==void 0&&(o.setAttribute("color",new M(s.colors,3)),a.vertexColors=!0);const r=new I(o,a);n.add(r)}return n}}class Le extends J{constructor(e){super(e)}load(e,s,i,t){const n=this,c=this.path===""?ee.extractUrlBase(e):this.path,a=new Y(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(o){try{s(n.parse(o,c))}catch(r){t?t(r):console.error(r),n.manager.itemError(e)}},i,t)}setMaterialOptions(e){return this.materialOptions=e,this}parse(e,s){const i=e.split(`
`);let t={};const n=/\s+/,c={};for(let o=0;o<i.length;o++){let r=i[o];if(r=r.trim(),r.length===0||r.charAt(0)==="#")continue;const h=r.indexOf(" ");let l=h>=0?r.substring(0,h):r;l=l.toLowerCase();let u=h>=0?r.substring(h+1):"";if(u=u.trim(),l==="newmtl")t={name:u},c[u]=t;else if(l==="ka"||l==="kd"||l==="ks"||l==="ke"){const m=u.split(n,3);t[l]=[parseFloat(m[0]),parseFloat(m[1]),parseFloat(m[2])]}else t[l]=u}const a=new je(this.resourcePath||s,this.materialOptions);return a.setCrossOrigin(this.crossOrigin),a.setManager(this.manager),a.setMaterials(c),a}}class je{constructor(e="",s={}){this.baseUrl=e,this.options=s,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.crossOrigin="anonymous",this.side=this.options.side!==void 0?this.options.side:te,this.wrap=this.options.wrap!==void 0?this.options.wrap:z}setCrossOrigin(e){return this.crossOrigin=e,this}setManager(e){this.manager=e}setMaterials(e){this.materialsInfo=this.convert(e),this.materials={},this.materialsArray=[],this.nameLookup={}}convert(e){if(!this.options)return e;const s={};for(const i in e){const t=e[i],n={};s[i]=n;for(const c in t){let a=!0,o=t[c];const r=c.toLowerCase();switch(r){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(o=[o[0]/255,o[1]/255,o[2]/255]),this.options&&this.options.ignoreZeroRGBs&&o[0]===0&&o[1]===0&&o[2]===0&&(a=!1);break}a&&(n[r]=o)}}return s}preload(){for(const e in this.materialsInfo)this.create(e)}getIndex(e){return this.nameLookup[e]}getAsArray(){let e=0;for(const s in this.materialsInfo)this.materialsArray[e]=this.create(s),this.nameLookup[s]=e,e++;return this.materialsArray}create(e){return this.materials[e]===void 0&&this.createMaterial_(e),this.materials[e]}createMaterial_(e){const s=this,i=this.materialsInfo[e],t={name:e,side:this.side};function n(a,o){return typeof o!="string"||o===""?"":/^https?:\/\//i.test(o)?o:a+o}function c(a,o){if(t[a])return;const r=s.getTextureParams(o,t),h=s.loadTexture(n(s.baseUrl,r.url));h.repeat.copy(r.scale),h.offset.copy(r.offset),h.wrapS=s.wrap,h.wrapT=s.wrap,(a==="map"||a==="emissiveMap")&&(h.encoding=S),t[a]=h}for(const a in i){const o=i[a];let r;if(o!=="")switch(a.toLowerCase()){case"kd":t.color=new k().fromArray(o).convertSRGBToLinear();break;case"ks":t.specular=new k().fromArray(o).convertSRGBToLinear();break;case"ke":t.emissive=new k().fromArray(o).convertSRGBToLinear();break;case"map_kd":c("map",o);break;case"map_ks":c("specularMap",o);break;case"map_ke":c("emissiveMap",o);break;case"norm":c("normalMap",o);break;case"map_bump":case"bump":c("bumpMap",o);break;case"map_d":c("alphaMap",o),t.transparent=!0;break;case"ns":t.shininess=parseFloat(o);break;case"d":r=parseFloat(o),r<1&&(t.opacity=r,t.transparent=!0);break;case"tr":r=parseFloat(o),this.options&&this.options.invertTrProperty&&(r=1-r),r>0&&(t.opacity=1-r,t.transparent=!0);break}}return this.materials[e]=new U(t),this.materials[e]}getTextureParams(e,s){const i={scale:new T(1,1),offset:new T(0,0)},t=e.split(/\s+/);let n;return n=t.indexOf("-bm"),n>=0&&(s.bumpScale=parseFloat(t[n+1]),t.splice(n,2)),n=t.indexOf("-s"),n>=0&&(i.scale.set(parseFloat(t[n+1]),parseFloat(t[n+2])),t.splice(n,4)),n=t.indexOf("-o"),n>=0&&(i.offset.set(parseFloat(t[n+1]),parseFloat(t[n+2])),t.splice(n,4)),i.url=t.join(" ").trim(),i}loadTexture(e,s,i,t,n){const c=this.manager!==void 0?this.manager:se;let a=c.getHandler(e);a===null&&(a=new Z(c)),a.setCrossOrigin&&a.setCrossOrigin(this.crossOrigin);const o=a.load(e,i,t,n);return s!==void 0&&(o.mapping=s),o}}const Me=de({__name:"threeLoadModel",setup(j){const e=D(null),s=D(null);function i(){const t=s.value,n=new ne({canvas:t});n.outputEncoding=S;const c=45,a=2,o=.1,r=100,h=new ie(c,a,o,r);h.position.set(10,10,20);const l=new re(h,t);l.target.set(0,5,0),l.update();const u=new oe;u.background=new k("pink");{const d=new Z().load("/note/images/logo.jpg");d.encoding=S,d.wrapS=z,d.wrapT=z,d.magFilter=ae;const g=50/2;d.repeat.set(g,g);const _=new le(50,50),w=new U({map:d,side:ce}),x=new O(_,w);x.rotation.x=Math.PI*-.5,u.add(x)}{const g=new he(11657727,12155424,1);u.add(g)}{const d=new ue(16777215,1);d.position.set(5,10,2),u.add(d),u.add(d.target)}new Le().load("/note/model/diaona.mtl",f=>{f.preload();const d=new xe;d.setMaterials(f),d.load("/note/model/diaona.obj",g=>{g.scale.set(.1,.1,.1),console.log(g),g.rotateY(3),u.add(g)})});function m(p){var w,x;const f=p.domElement,d=((w=e==null?void 0:e.value)==null?void 0:w.clientWidth)||f.clientWidth,g=((x=e==null?void 0:e.value)==null?void 0:x.clientHeight)||f.clientHeight,_=f.width!==d||f.height!==g;return _&&p.setSize(d,g,!1),_}function b(){if(m(n)){const p=n.domElement;h.aspect=p.clientWidth/p.clientHeight,h.updateProjectionMatrix()}n.render(u,h),requestAnimationFrame(b)}requestAnimationFrame(b)}return pe(()=>{i()}),(t,n)=>($(),K("div",{class:"fullscreen",ref_key:"container",ref:e},[fe("canvas",{ref_key:"canvasItem",ref:s},null,512)],512))}});var ke=Q(Me,[["__file","threeLoadModel.vue"]]);const Ce={};function Ve(j,e){const s=ke,i=me("ClientOnly");return $(),K("div",null,[E(i,null,{default:ge(()=>[E(s)]),_:1})])}var Ie=Q(Ce,[["render",Ve],["__file","threeLoadModel.html.vue"]]);export{Ie as default};
//# sourceMappingURL=threeLoadModel.html.6f758dcc.js.map
