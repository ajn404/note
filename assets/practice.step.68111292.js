import{S as v}from"./practice.setup.3d60fd6f.js";import{C as p,a as u,P as m,S as f,D as d,M as h}from"./OrbitControls.4135e4a5.js";import{d as _,r as x,P as b,n as g,h as y,o as z,c as q,_ as C}from"./app.28a7effe.js";var S="uniform vec2 u_resolution;uniform vec2 u_mouse;uniform float u_time;uniform sampler2D iChannel0;uniform sampler2D iChannel1;uniform int u_frame;varying vec3 v_position;void main(){float inCircle=1.0-step(1.0,length(v_position.xy));vec3 color=vec3(0.4157,0.2941,0.2941)*inCircle;gl_FragColor=vec4(color,1.0);}",w="varying vec3 v_position;void main(){v_position=position;gl_Position=projectionMatrix*modelViewMatrix*vec4(position*0.4,1.0);}",k="uniform vec2 u_resolution;uniform vec2 u_mouse;uniform float u_time;uniform sampler2D iChannel0;uniform sampler2D iChannel1;uniform int u_frame;varying vec3 v_position;float rect(vec2 pt,vec2 size,vec2 center){vec2 p=pt-center;vec2 halfSize=size*0.5;float horz=step(-halfSize.x,p.x)-step(halfSize.x,p.x);float vert=step(-halfSize.y,p.y)-step(halfSize.y,p.y);return horz*vert;}void main(){float inRect1=rect(v_position.xy,vec2(0.3,0.3),vec2(0.5,0.5));float inRect2=rect(v_position.xy,vec2(1.1,0.5),vec2(0.5,-0.5));vec3 color=vec3(0.4157,0.2941,0.2941)*inRect1+vec3(1.0,1.0,1.0)*inRect2;gl_FragColor=vec4(color,1.0);}",F="varying vec3 v_position;void main(){v_position=position;gl_Position=projectionMatrix*modelViewMatrix*vec4(position*0.4,1.0);}",M="uniform float u_time;varying vec3 v_position;float rect(vec2 pt,vec2 size,vec2 center){vec2 p=pt-center;vec2 halfSize=size*0.5;float horz=step(-halfSize.y,p.x)-step(halfSize.y,p.x);float vert=step(-halfSize.y,p.y)-step(halfSize.y,p.y);return horz*vert;}void main(){float radius=0.5;vec2 center=vec2(cos(u_time)*radius,sin(u_time)*radius);float inRect=rect(v_position.xy,vec2(0.5,0.5),center);vec3 color=vec3(0.2,0.3,0.5)*inRect;gl_FragColor=vec4(color,1.0);}",R=`
#define bridgeCol vec3(.1,1,.8)
#define bridgePillars vec3(1,.7,.4)
#define pillarsCol vec3(1,.1,.1)
#define patternsCol vec3(.8,.6,.3)
uniform vec2 u_resolution;varying vec2 vUv;uniform float u_time;float box(vec3 p,vec3 b){vec3 q=abs(p)-b;return length(max(q,0.))+min(max(q.x,max(q.y,q.z)),0.);}float rect(vec2 p,vec2 b){vec2 d=abs(p)-b;return length(max(d,0.))+min(max(d.x,d.y),0.);}
#define rot(a) mat2(cos(a), -sin(a), sin(a), cos(a))
#define rep(p,r) (mod(p+r/2.,r)-r/2.)
#define lrep(p,c,l) (p-c*clamp(round(p/c),-l,l))
#define rid(p,r) floor((p+r/2.)/r)
float light(float d,float att,float n){return 1./(1.+pow(abs(d*att),n));}float map(vec3 p,float t,inout vec3 lgt){float d,b1,b2,lb2,b3,b4,r;vec2 id0,id1;vec3 id3,q,c=cos(p)*.25+.75;d=rect(p.xy+vec2(0,2),vec2(1.4,1));d=min(d,abs(abs(p.y)-4.));if(abs(p.x)<1.5){q=p;q.z=lrep(q.z,.7,floor(u_time*8.-14.));b1=box(q-vec3(0,-1.1,0),vec3(1.,.1,.08));d=min(d,b1);lgt+=c*bridgeCol*light(b1,60.,2.);q=p;q.x=abs(q.x);q.z=rep(q.z,1.5);id3=rid(p,1.5);b2=rect(q.xz-vec2(1.2,0),vec2(.1));q.z=lrep(p.z,1.5,floor(u_time*8.));lb2=box(q-vec3(1.2,2.+sin(u_time+id3.z)*.5,0),vec3(.1,.3,.1));d=min(d,b2);lgt+=c*bridgePillars*light(lb2,80.,2.)*t*.5;}if(abs(p.y)>3.){const float br=1.5;q=p;id1=rid(p.xz,br);r=fract(dot(sin(id1),(id1+41.21)*24.77));q.xz=rep(p.xz,br);q.y=abs(q.y)-4.;q.xz*=rot(1.570796*(.5+floor(r*2.)));q.x=abs(q.x)-br*.35;b3=box(q,vec3(.01,.2,br*.4));d=min(d,b3);lgt+=c*patternsCol*light(b3,20.,2.)*exp(-t*.1-(cos(max(0.,u_time-9.)*.5)*.5+.5)*10.);}q=p;id0=rid(p.xz,7.);q.xz=rep(p.xz,7.);b3=rect(q.xz,vec2(.5));b3=max(b3,-abs(p.x)+2.);q.y=rep(q.y,.5);b4=box(q,vec3(.5,.04,.5));b4=max(b4,-abs(p.x)+2.);d=min(d,b3);if(fract((id0.x+41.11)*sin(id0.y*44.7))<smoothstep(5.,8.,u_time))lgt+=c*pillarsCol*light(b4,40.,2.)*(sin(u_time+p.y*(2.*fract(id0.x*id0.y*47.44))+id0.x*id0.y)*.5+.5);return d;}void mainImage(out vec4 O,vec2 F){vec2 uv=(2.*F-u_resolution.xy)/u_resolution.y;vec3 lgt=vec3(0);vec3 ro=vec3(0,0,u_time);vec3 rd=normalize(vec3(uv,1.));float t=0.;for(int i=0;i<40;i++){vec3 p=ro+t*rd;float d=map(p,t,lgt);t+=d;}O=vec4(pow(lgt,vec3(.45)),1.0);}void main(){mainImage(gl_FragColor,vUv*u_resolution.xy);}`,P="varying vec2 vUv;uniform vec2 u_resolution;uniform float u_time;varying vec3 v_position;mat2 getRotationMatrix(float theta){float s=sin(theta);float c=cos(theta);return mat2(c,-s,s,c);}float rect(vec2 pt,vec2 size,vec2 center){vec2 p=pt-center;vec2 halfsize=size*0.5;float horz=step(-halfsize.x,p.x)-step(halfsize.x,p.x);float vert=step(-halfsize.y,p.y)-step(halfsize.y,p.y);return horz*vert;}void main(void){vec2 tileCount=vec2(8.0,8.0);vec2 center=vec2(0.5);mat2 mat=getRotationMatrix(u_time);vec2 p=fract(vUv*tileCount);vec2 pt=(mat*(p-center))+center;float inRect=rect(pt,vec2(0.5),center);vec3 color=vec3(1.0,0.0,1.0)*inRect;gl_FragColor=vec4(color,1.0);}",a="varying vec2 vUv;varying vec3 v_position;void main(){v_position=position;vUv=uv;gl_Position=projectionMatrix*modelViewMatrix*vec4(position*0.4,1.0);}";const D=_({__name:"practice.step",props:{type:String},setup(c){const s=c;let o=S,r=w;switch(s.type){case"Square":{o=k,r=F;break}case"utime":{o=M;break}case"tiling":{o=P,r=a;break}case"neob":{o=R,r=a;break}}const n=x(null),e=b({u_time:{value:0},u_mouse:{value:{x:0,y:0}},u_resolution:{value:{x:0,y:0}},u_color:{value:new p(65520)},u_frame:{type:"i",value:-1},iChannel0:{type:"t",value:""},iChannel1:{type:"t",value:""}}),l=new u;let t=new v;return t.animate=function(){if(this.render(),e.u_time.value=l.getElapsedTime(),e.u_frame.value++,this.container.getBoundingClientRect().width>0)requestAnimationFrame(this.animate.bind(this));else return},t.move=function(i){e.u_mouse.value.x=i.touches?i.touches[0].clientX:i.clientX,e.u_mouse.value.y=i.touches?i.touches[0].clientY:i.clientY},"ontouchstart"in window?document.addEventListener("touchmove",t.move):document.addEventListener("mousemove",t.move),t.resize=function(){e.u_resolution!==void 0&&(e.u_resolution.value.x=this.width,e.u_resolution.value.y=this.height),e.u_frame.value=0,this.camera.aspect=this.container.clientWidth/this.container.clientHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.container.clientWidth,this.container.clientHeight),this.render()},g(()=>{console.log(o,typeof o);const i={container:n.value||document.body};t.addObject=function(){this.geometry=new m(2,2),this.material=new f({uniforms:e,side:d,fragmentShader:o,vertexShader:r}),this.mesh=new h(this.geometry,this.material),this.scene.add(this.mesh)},t.init(i),t.camera.position.z=.52}),y(()=>{t.beforeDestroy()}),(i,U)=>(z(),q("div",{class:"practice fullscreen",ref_key:"container",ref:n},null,512))}});var E=C(D,[["__file","practice.step.vue"]]);export{E as _};
//# sourceMappingURL=practice.step.68111292.js.map
